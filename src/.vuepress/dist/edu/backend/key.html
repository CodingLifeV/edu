<!DOCTYPE html>
<html lang="en-US" data-theme="light">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-beta.53" />
    <meta name="theme" content="VuePress Theme Hope" />
    <meta property="og:url" content="https://www.bmrs.top/edu/backend/key.html"><meta property="og:site_name" content="ç¼–ç äººç”Ÿ"><meta property="og:title" content="æŠ€æœ¯è¦ç‚¹"><meta property="og:type" content="article"><meta property="og:updated_time" content="2022-11-03T03:01:23.000Z"><meta property="og:locale" content="en-US"><meta property="article:author" content="Ms.Wyj"><meta property="article:tag" content="Page config"><meta property="article:tag" content="Guide"><meta property="article:published_time" content="2022-11-01T00:00:00.000Z"><meta property="article:modified_time" content="2022-11-03T03:01:23.000Z"><link rel="icon" href="/favicon.ico"><link rel="icon" href="/assets/icon/chrome-mask-512.png" type="image/png" sizes="512x512"><link rel="icon" href="/assets/icon/chrome-mask-192.png" type="image/png" sizes="192x192"><link rel="icon" href="/assets/icon/chrome-512.png" type="image/png" sizes="512x512"><link rel="icon" href="/assets/icon/chrome-192.png" type="image/png" sizes="192x192"><link rel="manifest" href="/manifest.webmanifest" crossorigin="use-credentials"><meta name="theme-color" content="#46bd87"><link rel="apple-touch-icon" href="/assets/icon/apple-icon-152.png"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black"><meta name="msapplication-TileImage" content="/assets/icon/ms-icon-144.png"><meta name="msapplication-TileColor" content="#ffffff"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover"><title>æŠ€æœ¯è¦ç‚¹ | ç¼–ç äººç”Ÿ</title><meta name="description" content="ä»¥ Java é¡¹ç›®ä¸ºä¸»çº¿, è®°å½•å­¦ä¹ è¿‡ç¨‹ä¸­çš„çŸ¥è¯†ç‚¹">
    <style>
      :root {
        --bg-color: #fff;
      }

      html[data-theme="dark"] {
        --bg-color: #1d2025;
      }

      html,
      body {
        background: var(--bg-color);
      }
    </style>
    <script>
      const userMode = localStorage.getItem("vuepress-theme-hope-scheme");
      const systemDarkMode =
        window.matchMedia &&
        window.matchMedia("(prefers-color-scheme: dark)").matches;

      if (userMode === "dark" || (userMode !== "light" && systemDarkMode)) {
        document.querySelector("html").setAttribute("data-theme", "dark");
      }
    </script>
    <link rel="preload" href="/assets/style.5766e538.css" as="style" /><link rel="stylesheet" href="/assets/style.5766e538.css" />
    <link rel="modulepreload" href="/assets/app.72bdf948.js"><link rel="modulepreload" href="/assets/key.html.e9de9c60.js"><link rel="modulepreload" href="/assets/_plugin-vue_export-helper.cdc0426e.js"><link rel="modulepreload" href="/assets/key.html.1e5ab633.js">
  </head>
  <body>
    <div id="app"><!--[--><!--[--><!--[--><span tabindex="-1"></span><a href="#main-content" class="skip-link sr-only">Skip to content</a><!--]--><div class="theme-container has-toc"><!--[--><!--[--><header class="navbar"><div class="navbar-left"><button class="toggle-sidebar-button" title="Toggle Sidebar"><span class="icon"></span></button><!--[--><!----><!--]--><a href="/" class="brand"><img class="logo" src="/logo.svg" alt="ç¼–ç äººç”Ÿ"><!----><span class="site-name hide-in-pad">ç¼–ç äººç”Ÿ</span></a><!--[--><!----><!--]--></div><div class="navbar-center"><!--[--><!----><!--]--><nav class="nav-links"><div class="nav-item hide-in-mobile"><a href="/" class="nav-link" aria-label="é¡¹ç›®ä¸»é¡µ"><span class="icon iconfont icon-home"></span>é¡¹ç›®ä¸»é¡µ<!----></a></div><div class="nav-item hide-in-mobile"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="é¡¹ç›®å­¦ä¹ "><span class="title"><span class="icon iconfont icon-creative"></span>é¡¹ç›®å­¦ä¹ </span><span class="arrow"></span><ul class="nav-dropdown"><li class="dropdown-item"><h4 class="dropdown-subtitle"><span>åºç« </span></h4><ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/edu/guide/func.html" class="nav-link" aria-label="é¡¹ç›®æ¶æ„åŠåŠŸèƒ½æ¦‚è¿°"><!---->é¡¹ç›®æ¶æ„åŠåŠŸèƒ½æ¦‚è¿°<!----></a></li><li class="dropdown-subitem"><a href="/edu/guide/knowledge.html" class="nav-link" aria-label="å­¦ä¹ è·¯çº¿"><!---->å­¦ä¹ è·¯çº¿<!----></a></li></ul></li><li class="dropdown-item"><h4 class="dropdown-subtitle"><span>åç«¯</span></h4><ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a aria-current="page" href="/edu/backend/key.html" class="router-link-active router-link-exact-active nav-link active" aria-label="æŠ€æœ¯è¦ç‚¹ç¯‡"><!---->æŠ€æœ¯è¦ç‚¹ç¯‡<!----></a></li><li class="dropdown-subitem"><a href="/edu/backend/sql.html" class="nav-link" aria-label="æ•°æ®åº“æ¦‚è¿°"><!---->æ•°æ®åº“æ¦‚è¿°<!----></a></li></ul></li><li class="dropdown-item"><h4 class="dropdown-subtitle"><span>é¡¹ç›®è¿›é˜¶</span></h4><ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/edu/springcloud/springcloud-1.html" class="nav-link" aria-label="SpringCloudåŸºç¡€çŸ¥è¯†"><!---->SpringCloudåŸºç¡€çŸ¥è¯†<!----></a></li><li class="dropdown-subitem"><a href="/edu/springcloud/springcloud-2.html" class="nav-link" aria-label="SpringCloudé¡¹ç›®ç›¸å…³"><!---->SpringCloudé¡¹ç›®ç›¸å…³<!----></a></li></ul></li><li class="dropdown-item"><h4 class="dropdown-subtitle"><span>å‰ç«¯</span></h4><ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/edu/front/front-01.html" class="nav-link" aria-label="ç®€å•ä»‹ç»"><!---->ç®€å•ä»‹ç»<!----></a></li><li class="dropdown-subitem"><a href="/edu/front/front-02.html" class="nav-link" aria-label="åŠŸèƒ½å®ç°"><!---->åŠŸèƒ½å®ç°<!----></a></li></ul></li></ul></button></div></div><div class="nav-item hide-in-mobile"><a href="/base/" class="nav-link" aria-label="å·¥å…·ç¯‡"><span class="icon iconfont icon-tool"></span>å·¥å…·ç¯‡<!----></a></div><div class="nav-item hide-in-mobile"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="SpringBootç³»åˆ—"><span class="title"><span class="icon iconfont icon-launch"></span>SpringBootç³»åˆ—</span><span class="arrow"></span><ul class="nav-dropdown"><li class="dropdown-item"><a href="/springboot/springboot1.html" class="nav-link" aria-label="SpringBootåŸºç¡€"><!---->SpringBootåŸºç¡€<!----></a></li><li class="dropdown-item"><a href="/springboot/springboot2.html" class="nav-link" aria-label="SpringBoot Webå¼€å‘"><!---->SpringBoot Webå¼€å‘<!----></a></li><li class="dropdown-item"><a href="/springboot/springboot3.html" class="nav-link" aria-label="SpringBootå‘˜å·¥ç®¡ç†ç³»ç»Ÿ"><!---->SpringBootå‘˜å·¥ç®¡ç†ç³»ç»Ÿ<!----></a></li><li class="dropdown-item"><a href="/springboot/springboot4.html" class="nav-link" aria-label="SpringBootæ•´åˆæ•°æ®åº“"><!---->SpringBootæ•´åˆæ•°æ®åº“<!----></a></li><li class="dropdown-item"><a href="/springboot/springboot5.html" class="nav-link" aria-label="SpringBootæ•´åˆSpringSecurity"><!---->SpringBootæ•´åˆSpringSecurity<!----></a></li><li class="dropdown-item"><a href="/springboot/springboot6.html" class="nav-link" aria-label="SpringBootæ•´åˆShiro"><!---->SpringBootæ•´åˆShiro<!----></a></li><li class="dropdown-item"><a href="/springboot/springboot7.html" class="nav-link" aria-label="SpringBootæ•´åˆSwagger"><!---->SpringBootæ•´åˆSwagger<!----></a></li><li class="dropdown-item"><a href="/springboot/springboot8.html" class="nav-link" aria-label="SpringBootç®€å•ä»»åŠ¡å®ç°"><!---->SpringBootç®€å•ä»»åŠ¡å®ç°<!----></a></li><li class="dropdown-item"><a href="/springboot/springboot9.html" class="nav-link" aria-label="SpringBootä¸åˆ†å¸ƒå¼å…¥é—¨"><!---->SpringBootä¸åˆ†å¸ƒå¼å…¥é—¨<!----></a></li></ul></button></div></div><div class="nav-item hide-in-mobile"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="é¡¹ç›®åœ°å€"><span class="title"><span class="icon iconfont icon-github"></span>é¡¹ç›®åœ°å€</span><span class="arrow"></span><ul class="nav-dropdown"><li class="dropdown-item"><a href="https://github.com/CodingLifeVV/edu" rel="noopener noreferrer" target="_blank" aria-label="åç«¯é¡¹ç›®" class="nav-link"><!---->åç«¯é¡¹ç›®<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!----></a></li><li class="dropdown-item"><a href="https://github.com/CodingLifeVV/edu-admin" rel="noopener noreferrer" target="_blank" aria-label="åç«¯å‰å°é¡¹ç›®" class="nav-link"><!---->åç«¯å‰å°é¡¹ç›®<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!----></a></li><li class="dropdown-item"><a href="https://github.com/CodingLifeVV/edu-front" rel="noopener noreferrer" target="_blank" aria-label="å‰ç«¯é¡¹ç›®" class="nav-link"><!---->å‰ç«¯é¡¹ç›®<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!----></a></li></ul></button></div></div><div class="nav-item hide-in-mobile"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="å­¦ä¹ èµ„æº"><span class="title"><span class="icon iconfont icon-list"></span>å­¦ä¹ èµ„æº</span><span class="arrow"></span><ul class="nav-dropdown"><li class="dropdown-item"><a href="https://www.macrozheng.com/" rel="noopener noreferrer" target="_blank" aria-label="mallå­¦ä¹ æ•™ç¨‹" class="nav-link"><!---->mallå­¦ä¹ æ•™ç¨‹<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!----></a></li><li class="dropdown-item"><a href="https://www.r2coding.com/#/README" rel="noopener noreferrer" target="_blank" aria-label="Road To Coding" class="nav-link"><!---->Road To Coding<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!----></a></li><li class="dropdown-item"><a href="https://javaguide.cn/" rel="noopener noreferrer" target="_blank" aria-label="JavaGuide" class="nav-link"><!---->JavaGuide<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!----></a></li><li class="dropdown-item"><a href="http://www.cyc2018.xyz/" rel="noopener noreferrer" target="_blank" aria-label="CS-Notes" class="nav-link"><!---->CS-Notes<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!----></a></li><li class="dropdown-item"><a href="https://bugstack.cn/" rel="noopener noreferrer" target="_blank" aria-label="bugstack è™«æ´æ ˆ" class="nav-link"><!---->bugstack è™«æ´æ ˆ<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!----></a></li><li class="dropdown-item"><a href="https://javaguide.cn/" rel="noopener noreferrer" target="_blank" aria-label="JavaGuide" class="nav-link"><!---->JavaGuide<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!----></a></li></ul></button></div></div><div class="nav-item hide-in-mobile"><div class="dropdown-wrapper"><button class="dropdown-title" type="button" aria-label="æ•¬è¯·æœŸå¾…"><span class="title"><span class="icon iconfont icon-hot"></span>æ•¬è¯·æœŸå¾…</span><span class="arrow"></span><ul class="nav-dropdown"><li class="dropdown-item"><a aria-current="page" href="/edu/backend/key.html#" class="router-link-active router-link-exact-active nav-link" aria-label="MySQLä¸Redis"><!---->MySQLä¸Redis<!----></a></li><li class="dropdown-item"><a aria-current="page" href="/edu/backend/key.html#" class="router-link-active router-link-exact-active nav-link" aria-label="SSMç³»åˆ—"><!---->SSMç³»åˆ—<!----></a></li><li class="dropdown-item"><a aria-current="page" href="/edu/backend/key.html#" class="router-link-active router-link-exact-active nav-link" aria-label="Javaå¹¶å‘"><!---->Javaå¹¶å‘<!----></a></li><li class="dropdown-item"><a aria-current="page" href="/edu/backend/key.html#" class="router-link-active router-link-exact-active nav-link" aria-label="JVMè™šæ‹Ÿæœº"><!---->JVMè™šæ‹Ÿæœº<!----></a></li><li class="dropdown-item"><a aria-current="page" href="/edu/backend/key.html#" class="router-link-active router-link-exact-active nav-link" aria-label="Springæºç è§£æ"><!---->Springæºç è§£æ<!----></a></li><li class="dropdown-item"><a aria-current="page" href="/edu/backend/key.html#" class="router-link-active router-link-exact-active nav-link" aria-label="åˆ†å¸ƒå¼/å¾®æœåŠ¡"><!---->åˆ†å¸ƒå¼/å¾®æœåŠ¡<!----></a></li><li class="dropdown-item"><a aria-current="page" href="/edu/backend/key.html#" class="router-link-active router-link-exact-active nav-link" aria-label="é¢è¯•æŒ‡å—"><!---->é¢è¯•æŒ‡å—<!----></a></li></ul></button></div></div></nav><!--[--><!----><!--]--></div><div class="navbar-right"><!--[--><!----><!--]--><!----><div class="nav-item"><a class="repo-link" href="https://github.com/CodingLifeVV/edu" target="_blank" rel="noopener noreferrer" aria-label="GitHub"><svg xmlns="http://www.w3.org/2000/svg" class="icon github-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="github icon" style="width:1.25rem;height:1.25rem;vertical-align:middle;"><path d="M511.957 21.333C241.024 21.333 21.333 240.981 21.333 512c0 216.832 140.544 400.725 335.574 465.664 24.49 4.395 32.256-10.07 32.256-23.083 0-11.69.256-44.245 0-85.205-136.448 29.61-164.736-64.64-164.736-64.64-22.315-56.704-54.4-71.765-54.4-71.765-44.587-30.464 3.285-29.824 3.285-29.824 49.195 3.413 75.179 50.517 75.179 50.517 43.776 75.008 114.816 53.333 142.762 40.79 4.523-31.66 17.152-53.377 31.19-65.537-108.971-12.458-223.488-54.485-223.488-242.602 0-53.547 19.114-97.323 50.517-131.67-5.035-12.33-21.93-62.293 4.779-129.834 0 0 41.258-13.184 134.912 50.346a469.803 469.803 0 0 1 122.88-16.554c41.642.213 83.626 5.632 122.88 16.554 93.653-63.488 134.784-50.346 134.784-50.346 26.752 67.541 9.898 117.504 4.864 129.834 31.402 34.347 50.474 78.123 50.474 131.67 0 188.586-114.73 230.016-224.042 242.09 17.578 15.232 33.578 44.672 33.578 90.454v135.85c0 13.142 7.936 27.606 32.854 22.87C862.25 912.597 1002.667 728.747 1002.667 512c0-271.019-219.648-490.667-490.71-490.667z"></path></svg></a></div><div class="nav-item hide-in-mobile"><button id="appearance-switch"><svg xmlns="http://www.w3.org/2000/svg" class="icon auto-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="auto icon" style="display:block;"><path d="M512 992C246.92 992 32 777.08 32 512S246.92 32 512 32s480 214.92 480 480-214.92 480-480 480zm0-840c-198.78 0-360 161.22-360 360 0 198.84 161.22 360 360 360s360-161.16 360-360c0-198.78-161.22-360-360-360zm0 660V212c165.72 0 300 134.34 300 300 0 165.72-134.28 300-300 300z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon dark-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="dark icon" style="display:none;"><path d="M524.8 938.667h-4.267a439.893 439.893 0 0 1-313.173-134.4 446.293 446.293 0 0 1-11.093-597.334A432.213 432.213 0 0 1 366.933 90.027a42.667 42.667 0 0 1 45.227 9.386 42.667 42.667 0 0 1 10.24 42.667 358.4 358.4 0 0 0 82.773 375.893 361.387 361.387 0 0 0 376.747 82.774 42.667 42.667 0 0 1 54.187 55.04 433.493 433.493 0 0 1-99.84 154.88 438.613 438.613 0 0 1-311.467 128z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon light-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="light icon" style="display:none;"><path d="M952 552h-80a40 40 0 0 1 0-80h80a40 40 0 0 1 0 80zM801.88 280.08a41 41 0 0 1-57.96-57.96l57.96-58a41.04 41.04 0 0 1 58 58l-58 57.96zM512 752a240 240 0 1 1 0-480 240 240 0 0 1 0 480zm0-560a40 40 0 0 1-40-40V72a40 40 0 0 1 80 0v80a40 40 0 0 1-40 40zm-289.88 88.08-58-57.96a41.04 41.04 0 0 1 58-58l57.96 58a41 41 0 0 1-57.96 57.96zM192 512a40 40 0 0 1-40 40H72a40 40 0 0 1 0-80h80a40 40 0 0 1 40 40zm30.12 231.92a41 41 0 0 1 57.96 57.96l-57.96 58a41.04 41.04 0 0 1-58-58l58-57.96zM512 832a40 40 0 0 1 40 40v80a40 40 0 0 1-80 0v-80a40 40 0 0 1 40-40zm289.88-88.08 58 57.96a41.04 41.04 0 0 1-58 58l-57.96-58a41 41 0 0 1 57.96-57.96z"></path></svg></button></div><!----><!--[--><!----><!--]--><button class="toggle-navbar-button" aria-label="Toggle Navbar" aria-expanded="false" aria-controls="nav-screen"><span class="button-container"><span class="button-top"></span><span class="button-middle"></span><span class="button-bottom"></span></span></button></div></header><!----><!--]--><!----><div class="toggle-sidebar-wrapper"><span class="arrow left"></span></div><aside class="sidebar"><!--[--><!----><!--]--><ul class="sidebar-links"><li><!--[--><a href="/" class="nav-link sidebar-link sidebar-page" aria-label="é¡¹ç›®ä¸»é¡µ"><span class="icon iconfont icon-home"></span>é¡¹ç›®ä¸»é¡µ<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><section class="sidebar-group"><button class="sidebar-heading clickable"><span class="icon iconfont icon-launch"></span><span class="title">åºç« </span><span class="arrow right"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable active"><span class="icon iconfont icon-frame"></span><span class="title">åç«¯</span><span class="arrow down"></span></button><ul class="sidebar-links"><li><!--[--><a aria-current="page" href="/edu/backend/key.html" class="router-link-active router-link-exact-active nav-link active sidebar-link sidebar-page active" aria-label="æŠ€æœ¯è¦ç‚¹ç¯‡"><!---->æŠ€æœ¯è¦ç‚¹ç¯‡<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/edu/backend/key.html#lombokä½¿ç”¨" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="LomBokä½¿ç”¨"><!---->LomBokä½¿ç”¨<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/edu/backend/key.html#mybatis-plusä»£ç ç”Ÿæˆå™¨" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="Mybatis-Plusä»£ç ç”Ÿæˆå™¨"><!---->Mybatis-Plusä»£ç ç”Ÿæˆå™¨<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/edu/backend/key.html#ç»Ÿä¸€è¿”å›ç»“æœ" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="ç»Ÿä¸€è¿”å›ç»“æœ"><!---->ç»Ÿä¸€è¿”å›ç»“æœ<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/edu/backend/key.html#å…¨å±€å¼‚å¸¸å¤„ç†" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="å…¨å±€å¼‚å¸¸å¤„ç†"><!---->å…¨å±€å¼‚å¸¸å¤„ç†<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/edu/backend/key.html#ç»Ÿä¸€æ—¥å¿—å¤„ç†" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="ç»Ÿä¸€æ—¥å¿—å¤„ç†"><!---->ç»Ÿä¸€æ—¥å¿—å¤„ç†<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/edu/backend/key.html#é˜¿é‡Œäº‘ossæ–‡ä»¶å­˜å‚¨" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="é˜¿é‡Œäº‘OSSæ–‡ä»¶å­˜å‚¨"><!---->é˜¿é‡Œäº‘OSSæ–‡ä»¶å­˜å‚¨<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/edu/backend/key.html#easyexcel-è¯»å–-excel-æ–‡ä»¶" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="EasyExcel è¯»å– Excel æ–‡ä»¶"><!---->EasyExcel è¯»å– Excel æ–‡ä»¶<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/edu/backend/key.html#nginx-é…ç½®åå°å¤šæœåŠ¡å™¨" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="nginx é…ç½®åå°å¤šæœåŠ¡å™¨"><!---->nginx é…ç½®åå°å¤šæœåŠ¡å™¨<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/edu/backend/key.html#springboot-ä¸Šä¼ è§†é¢‘åˆ°é˜¿é‡Œäº‘å¹³å°" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="SpringBoot ä¸Šä¼ è§†é¢‘åˆ°é˜¿é‡Œäº‘å¹³å°"><!---->SpringBoot ä¸Šä¼ è§†é¢‘åˆ°é˜¿é‡Œäº‘å¹³å°<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/edu/backend/key.html#springbootå®ç°é˜¿é‡Œäº‘è§†é¢‘æ’­æ”¾" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="SpringBootå®ç°é˜¿é‡Œäº‘è§†é¢‘æ’­æ”¾"><!---->SpringBootå®ç°é˜¿é‡Œäº‘è§†é¢‘æ’­æ”¾<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/edu/backend/key.html#springboot-æ•´åˆ-redis" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="SpringBoot æ•´åˆ Redis"><!---->SpringBoot æ•´åˆ Redis<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/edu/backend/key.html#springboot-æ•´åˆ-jwt" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="SpringBoot æ•´åˆ JWT"><!---->SpringBoot æ•´åˆ JWT<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/edu/backend/key.html#springboot-æ•´åˆé˜¿é‡Œäº‘çŸ­ä¿¡æœåŠ¡" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="SpringBoot æ•´åˆé˜¿é‡Œäº‘çŸ­ä¿¡æœåŠ¡"><!---->SpringBoot æ•´åˆé˜¿é‡Œäº‘çŸ­ä¿¡æœåŠ¡<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/edu/backend/key.html#springboot-æ•´åˆè·³è½¬å¾®ä¿¡ç™»å½•" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="SpringBoot æ•´åˆè·³è½¬å¾®ä¿¡ç™»å½•"><!---->SpringBoot æ•´åˆè·³è½¬å¾®ä¿¡ç™»å½•<!----></a><ul class="sidebar-sub-headers"></ul></li></ul><!--]--></li><li><!--[--><a href="/edu/backend/sql.html" class="nav-link sidebar-link sidebar-page" aria-label="æ•°æ®åº“æ¦‚è¿°"><!---->æ•°æ®åº“æ¦‚è¿°<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li></ul></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable"><span class="icon iconfont icon-class"></span><span class="title">åç«¯SpringCloud</span><span class="arrow right"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable"><span class="icon iconfont icon-note"></span><span class="title">åç«¯å‰å°</span><span class="arrow right"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable"><span class="icon iconfont icon-tool"></span><span class="title">å·¥å…·ç¯‡</span><span class="arrow right"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable"><span class="icon iconfont icon-launch"></span><span class="title">SpringBootç³»åˆ—</span><span class="arrow right"></span></button><!----></section></li></ul><!--[--><!----><!--]--></aside><!--[--><main class="page" id="main-content"><!--[--><!----><nav class="breadcrumb disable"></nav><div class="page-title"><h1><!---->æŠ€æœ¯è¦ç‚¹</h1><div class="page-info"><span class="author-info" aria-label="AuthorğŸ–Š" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon author-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="author icon"><path d="M649.6 633.6c86.4-48 147.2-144 147.2-249.6 0-160-128-288-288-288s-288 128-288 288c0 108.8 57.6 201.6 147.2 249.6-121.6 48-214.4 153.6-240 288-3.2 9.6 0 19.2 6.4 25.6 3.2 9.6 12.8 12.8 22.4 12.8h704c9.6 0 19.2-3.2 25.6-12.8 6.4-6.4 9.6-16 6.4-25.6-25.6-134.4-121.6-240-243.2-288z"></path></svg><span><span class="author-item">Ms.Wyj</span></span><span property="author" content="Ms.Wyj"></span></span><!----><span class="date-info" aria-label="Writing DateğŸ“…" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon calendar-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="calendar icon"><path d="M716.4 110.137c0-18.753-14.72-33.473-33.472-33.473-18.753 0-33.473 14.72-33.473 33.473v33.473h66.993v-33.473zm-334.87 0c0-18.753-14.72-33.473-33.473-33.473s-33.52 14.72-33.52 33.473v33.473h66.993v-33.473zm468.81 33.52H716.4v100.465c0 18.753-14.72 33.473-33.472 33.473a33.145 33.145 0 01-33.473-33.473V143.657H381.53v100.465c0 18.753-14.72 33.473-33.473 33.473a33.145 33.145 0 01-33.473-33.473V143.657H180.6A134.314 134.314 0 0046.66 277.595v535.756A134.314 134.314 0 00180.6 947.289h669.74a134.36 134.36 0 00133.94-133.938V277.595a134.314 134.314 0 00-133.94-133.938zm33.473 267.877H147.126a33.145 33.145 0 01-33.473-33.473c0-18.752 14.72-33.473 33.473-33.473h736.687c18.752 0 33.472 14.72 33.472 33.473a33.145 33.145 0 01-33.472 33.473z"></path></svg><span>November 1, 2022</span><meta property="datePublished" content="2022-11-01T00:00:00.000Z"></span><span class="category-info" aria-label="CategoryğŸŒˆ" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon category-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="category icon"><path d="M148.41 106.992h282.176c22.263 0 40.31 18.048 40.31 40.31V429.48c0 22.263-18.047 40.31-40.31 40.31H148.41c-22.263 0-40.311-18.047-40.311-40.31V147.302c0-22.263 18.048-40.31 40.311-40.31zM147.556 553.478H429.73c22.263 0 40.311 18.048 40.311 40.31v282.176c0 22.263-18.048 40.312-40.31 40.312H147.555c-22.263 0-40.311-18.049-40.311-40.312V593.79c0-22.263 18.048-40.311 40.31-40.311zM593.927 106.992h282.176c22.263 0 40.31 18.048 40.31 40.31V429.48c0 22.263-18.047 40.31-40.31 40.31H593.927c-22.263 0-40.311-18.047-40.311-40.31V147.302c0-22.263 18.048-40.31 40.31-40.31zM730.22 920.502H623.926c-40.925 0-74.22-33.388-74.22-74.425V623.992c0-41.038 33.387-74.424 74.425-74.424h222.085c41.038 0 74.424 33.226 74.424 74.067v114.233c0 10.244-8.304 18.548-18.547 18.548s-18.548-8.304-18.548-18.548V623.635c0-20.388-16.746-36.974-37.33-36.974H624.13c-20.585 0-37.331 16.747-37.331 37.33v222.086c0 20.585 16.654 37.331 37.126 37.331H730.22c10.243 0 18.547 8.304 18.547 18.547 0 10.244-8.304 18.547-18.547 18.547z"></path></svg><ul class="categories-wrapper"><li><span class="category category6" role>Guide</span></li></ul><meta property="articleSection" content="Guide"></span><span aria-label="TagğŸ·" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon tag-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="tag icon"><path d="M939.902 458.563L910.17 144.567c-1.507-16.272-14.465-29.13-30.737-30.737L565.438 84.098h-.402c-3.215 0-5.726 1.005-7.634 2.913l-470.39 470.39a10.004 10.004 0 000 14.164l365.423 365.424c1.909 1.908 4.42 2.913 7.132 2.913s5.223-1.005 7.132-2.913l470.39-470.39c2.01-2.11 3.014-5.023 2.813-8.036zm-240.067-72.121c-35.458 0-64.286-28.828-64.286-64.286s28.828-64.285 64.286-64.285 64.286 28.828 64.286 64.285-28.829 64.286-64.286 64.286z"></path></svg><ul class="tags-wrapper"><li><span class="tag tag5" role>Page config</span></li><li><span class="tag tag6" role>Guide</span></li></ul><meta property="keywords" content="Page config,Guide"></span><span class="reading-time-info" aria-label="Reading TimeâŒ›" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon timer-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="timer icon"><path d="M799.387 122.15c4.402-2.978 7.38-7.897 7.38-13.463v-1.165c0-8.933-7.38-16.312-16.312-16.312H256.33c-8.933 0-16.311 7.38-16.311 16.312v1.165c0 5.825 2.977 10.874 7.637 13.592 4.143 194.44 97.22 354.963 220.201 392.763-122.204 37.542-214.893 196.511-220.2 389.397-4.661 5.049-7.638 11.651-7.638 19.03v5.825h566.49v-5.825c0-7.379-2.849-13.981-7.509-18.9-5.049-193.016-97.867-351.985-220.2-389.527 123.24-37.67 216.446-198.453 220.588-392.892zM531.16 450.445v352.632c117.674 1.553 211.787 40.778 211.787 88.676H304.097c0-48.286 95.149-87.382 213.728-88.676V450.445c-93.077-3.107-167.901-81.297-167.901-177.093 0-8.803 6.99-15.793 15.793-15.793 8.803 0 15.794 6.99 15.794 15.793 0 80.261 63.69 145.635 142.01 145.635s142.011-65.374 142.011-145.635c0-8.803 6.99-15.793 15.794-15.793s15.793 6.99 15.793 15.793c0 95.019-73.789 172.82-165.96 177.093z"></path></svg><span>About 40 min</span><meta property="timeRequired" content="PT40M"></span></div><hr></div><div class="toc-place-holder"><aside id="toc"><div class="toc-header">On This Page</div><div class="toc-wrapper"><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/edu/backend/key.html#lombokä½¿ç”¨" class="router-link-active router-link-exact-active toc-link level2">LomBokä½¿ç”¨</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/edu/backend/key.html#mybatis-plusä»£ç ç”Ÿæˆå™¨" class="router-link-active router-link-exact-active toc-link level2">Mybatis-Plusä»£ç ç”Ÿæˆå™¨</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/edu/backend/key.html#ç»Ÿä¸€è¿”å›ç»“æœ" class="router-link-active router-link-exact-active toc-link level2">ç»Ÿä¸€è¿”å›ç»“æœ</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/edu/backend/key.html#å…¨å±€å¼‚å¸¸å¤„ç†" class="router-link-active router-link-exact-active toc-link level2">å…¨å±€å¼‚å¸¸å¤„ç†</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/edu/backend/key.html#ç»Ÿä¸€æ—¥å¿—å¤„ç†" class="router-link-active router-link-exact-active toc-link level2">ç»Ÿä¸€æ—¥å¿—å¤„ç†</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/edu/backend/key.html#é˜¿é‡Œäº‘ossæ–‡ä»¶å­˜å‚¨" class="router-link-active router-link-exact-active toc-link level2">é˜¿é‡Œäº‘OSSæ–‡ä»¶å­˜å‚¨</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/edu/backend/key.html#easyexcel-è¯»å–-excel-æ–‡ä»¶" class="router-link-active router-link-exact-active toc-link level2">EasyExcel è¯»å– Excel æ–‡ä»¶</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/edu/backend/key.html#nginx-é…ç½®åå°å¤šæœåŠ¡å™¨" class="router-link-active router-link-exact-active toc-link level2">nginx é…ç½®åå°å¤šæœåŠ¡å™¨</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/edu/backend/key.html#springboot-ä¸Šä¼ è§†é¢‘åˆ°é˜¿é‡Œäº‘å¹³å°" class="router-link-active router-link-exact-active toc-link level2">SpringBoot ä¸Šä¼ è§†é¢‘åˆ°é˜¿é‡Œäº‘å¹³å°</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/edu/backend/key.html#springbootå®ç°é˜¿é‡Œäº‘è§†é¢‘æ’­æ”¾" class="router-link-active router-link-exact-active toc-link level2">SpringBootå®ç°é˜¿é‡Œäº‘è§†é¢‘æ’­æ”¾</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/edu/backend/key.html#springboot-æ•´åˆ-redis" class="router-link-active router-link-exact-active toc-link level2">SpringBoot æ•´åˆ Redis</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/edu/backend/key.html#springboot-æ•´åˆ-jwt" class="router-link-active router-link-exact-active toc-link level2">SpringBoot æ•´åˆ JWT</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/edu/backend/key.html#springboot-æ•´åˆé˜¿é‡Œäº‘çŸ­ä¿¡æœåŠ¡" class="router-link-active router-link-exact-active toc-link level2">SpringBoot æ•´åˆé˜¿é‡Œäº‘çŸ­ä¿¡æœåŠ¡</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/edu/backend/key.html#springboot-æ•´åˆè·³è½¬å¾®ä¿¡ç™»å½•" class="router-link-active router-link-exact-active toc-link level2">SpringBoot æ•´åˆè·³è½¬å¾®ä¿¡ç™»å½•</a></li><!----><!--]--></ul></div></aside></div><!----><div class="theme-hope-content"><h2 id="lombokä½¿ç”¨" tabindex="-1"><a class="header-anchor" href="#lombokä½¿ç”¨" aria-hidden="true">#</a> LomBokä½¿ç”¨</h2><div class="custom-container info"><p class="custom-container-title">Info</p><p>Lombok å¯ä»¥é€šè¿‡æ³¨è§£çš„æ–¹å¼ï¼Œåœ¨ç¼–è¯‘æ—¶è‡ªåŠ¨ä¸ºå±æ€§ç”Ÿæˆæ„é€ å™¨ï¼Œ getter/setterã€equalsã€hashcodeã€toString æ–¹æ³•</p></div><p>Lombokä½¿ç”¨æ–¹æ³•å¦‚ä¸‹ï¼š</p><ol><li><p>ideaå®‰è£… Lombok æ’ä»¶</p><p><img src="https://eduimage1.oss-cn-beijing.aliyuncs.com/img/202203171531277.png" alt="image-20220317153101187" loading="lazy"></p></li><li><p>é¡¹ç›®ä¸­å¼•å…¥ Lombok æ’ä»¶ä¾èµ–</p><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.projectlombok<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>lombok<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>åœ¨å®ä½“ç±»ä¸Šä½¿ç”¨ç›¸å…³æ³¨è§£ï¼Œéƒ¨åˆ†æ³¨è§£å«ä¹‰å¦‚ä¸‹ï¼š</p><table><thead><tr><th>æ³¨è§£</th><th>å«ä¹‰</th></tr></thead><tbody><tr><td>@Data</td><td>ç”Ÿæˆæ‰€æœ‰å­—æ®µçš„ getterã€toString()ã€hashCode()ã€equals()ã€æ‰€æœ‰é final å­—æ®µçš„ setterã€æ„é€ å™¨ï¼Œç›¸å½“äºè®¾ç½®äº† @Getter @Setter @RequiredArgsConstructor @ToString @EqualsAndHashCode</td></tr><tr><td>@AllArgsConstructor</td><td>ç”ŸæˆåŒ…å«æ‰€æœ‰å­—æ®µçš„æ„é€ å™¨</td></tr><tr><td>@NoArgsConstructor</td><td>ç”Ÿæˆæ— å‚æ•°æ„é€ å™¨</td></tr><tr><td>@EqualsAndHashCode</td><td>ç”Ÿæˆ hashCode()ã€equals()</td></tr><tr><td>@Getter</td><td>ç”Ÿæˆ getterã€å†™åœ¨ç±»ä¸Šä¼šç”Ÿæˆè¯¥ç±»ä¸‹æ‰€æœ‰å­—æ®µçš„ getterã€‚å†™åœ¨æŸä¸ªå­—æ®µä¸Šå°±ä½œç”¨ä¸è¯¥å­—æ®µ</td></tr><tr><td>@NonNull</td><td>ç©ºæ£€æŸ¥</td></tr><tr><td>@Setter</td><td>ç”ŸæˆSetter</td></tr><tr><td>@RequiredArgsConstructor</td><td>ç”Ÿæˆå¿…é¡»åˆå§‹åŒ–å­—æ®µçš„æ„é€ å™¨ï¼Œæ¯”å¦‚å¸¦finalã€@NonNull</td></tr></tbody></table></li></ol><p>å‚è€ƒæ–‡ç« ï¼š</p><ul><li><a href="https://segmentfault.com/a/1190000016111422" target="_blank" rel="noopener noreferrer">Lombokæ³¨è§£ç¬”è®°<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li></ul><h2 id="mybatis-plusä»£ç ç”Ÿæˆå™¨" tabindex="-1"><a class="header-anchor" href="#mybatis-plusä»£ç ç”Ÿæˆå™¨" aria-hidden="true">#</a> Mybatis-Plusä»£ç ç”Ÿæˆå™¨</h2><p>å‚è€ƒ<a href="http://localhost:3000/#/codinglife/MybatisPlus?id=%E4%BB%A3%E7%A0%81%E7%94%9F%E6%88%90%E5%99%A8" target="_blank" rel="noopener noreferrer">MybatisPlusâ€”Mybatiså¼€äº†å¤–æŒ‚ï¼Ÿå†ä¹Ÿä¸ç”¨æ‰‹å†™Mapperäº†!<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><h2 id="ç»Ÿä¸€è¿”å›ç»“æœ" tabindex="-1"><a class="header-anchor" href="#ç»Ÿä¸€è¿”å›ç»“æœ" aria-hidden="true">#</a> ç»Ÿä¸€è¿”å›ç»“æœ</h2><p>åœ¨é¡¹ç›®å¼€å‘ä¸­ï¼Œæˆ‘ä»¬å¾€å¾€ä¼šå°†å“åº”çš„æ•°æ®å°è£…æˆ json æ•°æ®è¿”å›ï¼Œå¹¶å°†æ‰€æœ‰çš„æ•°æ®æ ¼å¼è¿›è¡Œç»Ÿä¸€ï¼Œä½¿å¾—å‰ç«¯å¯¹æ•°æ®çš„æ“ä½œæ›´åŠ ç®€å•å®¹æ˜“ï¼Œç»Ÿä¸€è¿”å›çš„æ•°æ®æ ¼å¼å¯ä»¥æ ¹æ®å®é™…æƒ…å†µæ¥è‡ªå®šä¹‰ï¼Œä¸€èˆ¬åŒ…æ‹¬çŠ¶æ€ç ï¼Œè¿”å›æ¶ˆæ¯å’Œæ•°æ®ä¸‰éƒ¨åˆ†ã€‚</p><p>æ–°å»º SpringBoot é¡¹ç›®<code>springboot-commonresult</code>, é¡¹ç›®ç¯å¢ƒï¼šSpringBoot 2.6.4ï¼ŒJDK17ï¼Œç»Ÿä¸€è¿”å›ç»“æœä»£ç æ¼”ç¤ºå¦‚ä¸‹ï¼š</p><ol><li><p><a id="_link_result1">å‡†å¤‡ç›¸å…³æµ‹è¯•æ•°æ®</a>ï¼Œæ•°æ®åº“è¡¨ User</p><div class="language-sql line-numbers-mode" data-ext="sql"><pre class="language-sql"><code><span class="token keyword">DROP</span> <span class="token keyword">TABLE</span> <span class="token keyword">IF</span> <span class="token keyword">EXISTS</span> <span class="token keyword">user</span><span class="token punctuation">;</span>
<span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> <span class="token keyword">user</span>
<span class="token punctuation">(</span>
 id <span class="token keyword">BIGINT</span><span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span> <span class="token operator">NOT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">&#39;ä¸»é”®ID&#39;</span><span class="token punctuation">,</span>
 name <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">30</span><span class="token punctuation">)</span> <span class="token boolean">NULL</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">&#39;å§“å&#39;</span><span class="token punctuation">,</span>
 age <span class="token keyword">INT</span><span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">)</span> <span class="token boolean">NULL</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">&#39;å¹´é¾„&#39;</span><span class="token punctuation">,</span>
 email <span class="token keyword">VARCHAR</span><span class="token punctuation">(</span><span class="token number">50</span><span class="token punctuation">)</span> <span class="token boolean">NULL</span> <span class="token keyword">DEFAULT</span> <span class="token boolean">NULL</span> <span class="token keyword">COMMENT</span> <span class="token string">&#39;é‚®ç®±&#39;</span><span class="token punctuation">,</span>
 <span class="token keyword">PRIMARY</span> <span class="token keyword">KEY</span> <span class="token punctuation">(</span>id<span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">DELETE</span> <span class="token keyword">FROM</span> <span class="token keyword">user</span><span class="token punctuation">;</span>
<span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> <span class="token keyword">user</span> <span class="token punctuation">(</span>id<span class="token punctuation">,</span> name<span class="token punctuation">,</span> age<span class="token punctuation">,</span> email<span class="token punctuation">)</span> <span class="token keyword">VALUES</span>
<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token string">&#39;codeLifeVV&#39;</span><span class="token punctuation">,</span> <span class="token number">18</span><span class="token punctuation">,</span> <span class="token string">&#39;test1@baomidou.com&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">&#39;Jack&#39;</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token string">&#39;test2@baomidou.com&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token string">&#39;Tom&#39;</span><span class="token punctuation">,</span> <span class="token number">28</span><span class="token punctuation">,</span> <span class="token string">&#39;test3@baomidou.com&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span> <span class="token string">&#39;Sandy&#39;</span><span class="token punctuation">,</span> <span class="token number">21</span><span class="token punctuation">,</span> <span class="token string">&#39;test4@baomidou.com&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token string">&#39;Billie&#39;</span><span class="token punctuation">,</span> <span class="token number">24</span><span class="token punctuation">,</span> <span class="token string">&#39;test5@baomidou.com&#39;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p><a id="_link_result2">ç¼–å†™é¡¹ç›®æ‰€éœ€ä»£ç </a>ï¼š</p><p><strong>pom.xml æ‰€éœ€ä¾èµ–</strong>ï¼š</p><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code><span class="token comment">&lt;!--Lombok--&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.projectlombok<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>lombok<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>

<span class="token comment">&lt;!--SpringBoot Web ä¾èµ–--&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-starter-web<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>

<span class="token comment">&lt;!--MybatisPlus--&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.baomidou<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>mybatis-plus-boot-starter<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>3.5.1<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>

<span class="token comment">&lt;!--mysql--&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>mysql<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>mysql-connector-java<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="custom-container tip"><p class="custom-container-title">Tips</p><p>1ã€æˆ‘ä»¬ä½¿ç”¨äº†Mybatis-Plusæ¥ç®€åŒ–å¼€å‘ï¼ŒMybatis-Pluså­¦ä¹ å‚è€ƒåŸºç¡€çŸ¥è¯†ç¯‡Mybatisâ€”Plusâ€”&gt;ä»£ç ç”Ÿæˆå™¨</p><p>2ã€Lombokå­¦ä¹ å‚è€ƒä¸Šè¿°æ–‡ç« ï¼š LomBok ä½¿ç”¨</p></div><p><strong>yaml.xml</strong>ï¼š</p><div class="language-yaml line-numbers-mode" data-ext="yml"><pre class="language-yaml"><code><span class="token comment"># é…ç½®æ•°æ®æº</span>
<span class="token key atrule">spring</span><span class="token punctuation">:</span>
  <span class="token key atrule">datasource</span><span class="token punctuation">:</span>
    <span class="token key atrule">driver-class-name</span><span class="token punctuation">:</span> com.mysql.cj.jdbc.Driver
    <span class="token key atrule">url</span><span class="token punctuation">:</span> jdbc<span class="token punctuation">:</span>mysql<span class="token punctuation">:</span>//localhost<span class="token punctuation">:</span>3306/mybatis_plus<span class="token punctuation">?</span>serverTimezone=UTC<span class="token important">&amp;useUnicode=true&amp;characterEncoding=utf-</span><span class="token number">8</span>
    <span class="token key atrule">username</span><span class="token punctuation">:</span> root
    <span class="token key atrule">password</span><span class="token punctuation">:</span> <span class="token number">1234</span>

<span class="token comment"># mybatis-plus æ—¥å¿—</span>
<span class="token key atrule">mybatis-plus</span><span class="token punctuation">:</span>
  <span class="token key atrule">configuration</span><span class="token punctuation">:</span>
    <span class="token key atrule">log-impl</span><span class="token punctuation">:</span> org.apache.ibatis.logging.stdout.StdOutImpl
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>å®ä½“ç±»User</strong>ï¼š</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>codinglife<span class="token punctuation">.</span>entity</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">lombok<span class="token punctuation">.</span></span><span class="token class-name">AllArgsConstructor</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">lombok<span class="token punctuation">.</span></span><span class="token class-name">Data</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">lombok<span class="token punctuation">.</span></span><span class="token class-name">NoArgsConstructor</span></span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@Data</span>
<span class="token annotation punctuation">@NoArgsConstructor</span>
<span class="token annotation punctuation">@AllArgsConstructor</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">User</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token class-name">Long</span> id<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> name<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">Integer</span> age<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> email<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>mapperæ¥å£</strong>ï¼š</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">UserMapper</span> <span class="token keyword">extends</span> <span class="token class-name">BaseMapper</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">User</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">{</span>

<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>Serviceæ¥å£åŠå®ç°ç±»</strong>ï¼š</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">UserService</span> <span class="token keyword">extends</span> <span class="token class-name">IService</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">User</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">{</span>

<span class="token punctuation">}</span>

<span class="token annotation punctuation">@Service</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">UserServiceImpl</span> <span class="token keyword">extends</span> <span class="token class-name">ServiceImpl</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">UserMapper</span><span class="token punctuation">,</span> <span class="token class-name">User</span><span class="token punctuation">&gt;</span></span> <span class="token keyword">implements</span> <span class="token class-name">UserService</span> <span class="token punctuation">{</span>

<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><strong>controllerç±»</strong>ï¼š</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Controller</span>
<span class="token annotation punctuation">@ResponseBody</span>
<span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/user&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">UserController</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Autowired</span>
    <span class="token keyword">private</span> <span class="token class-name">UserService</span> userService<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">&quot;listAll&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">CommonResult</span> <span class="token function">list</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">User</span><span class="token punctuation">&gt;</span></span> list <span class="token operator">=</span> userService<span class="token punctuation">.</span><span class="token function">list</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token class-name">CommonResult</span><span class="token punctuation">.</span><span class="token function">success</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">data</span><span class="token punctuation">(</span><span class="token string">&quot;items&quot;</span><span class="token punctuation">,</span> list<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@DeleteMapping</span><span class="token punctuation">(</span><span class="token string">&quot;delete/{id}&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">CommonResult</span> <span class="token function">deleteTeacherById</span><span class="token punctuation">(</span><span class="token annotation punctuation">@PathVariable</span> <span class="token class-name">String</span> id<span class="token punctuation">)</span> <span class="token punctuation">{</span>

        <span class="token keyword">boolean</span> result <span class="token operator">=</span>  userService<span class="token punctuation">.</span><span class="token function">removeById</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>result<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token class-name">CommonResult</span><span class="token punctuation">.</span><span class="token function">success</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token class-name">CommonResult</span><span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="custom-container tip"><p class="custom-container-title">Tips</p><p>ç±»<code>CommonResult</code>ä¸ºç»Ÿä¸€è¿”å›ç»“æœå¤„ç†ç±»ï¼Œæ­¥éª¤ 3 ä¼šåˆ›å»º</p></div></li><li><p>ç¼–å†™ç»Ÿä¸€è¿”å›ç»“æœå¤„ç†ç±»ä»£ç <code>ResultCode.java</code>å’Œ<code>CommonResult.java</code></p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Getter</span>
<span class="token annotation punctuation">@AllArgsConstructor</span><span class="token punctuation">(</span>access <span class="token operator">=</span> <span class="token class-name">AccessLevel</span><span class="token punctuation">.</span><span class="token constant">PRIVATE</span><span class="token punctuation">)</span> <span class="token comment">// Lombok æ‰€æœ‰å‚æ•°æ„é€ å™¨ä¸”ç§æœ‰</span>
<span class="token keyword">public</span> <span class="token keyword">enum</span> <span class="token class-name">ResultCode</span> <span class="token punctuation">{</span>
    <span class="token function">SUCCESS</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">,</span><span class="token number">200</span><span class="token punctuation">,</span> <span class="token string">&quot;æ“ä½œæˆåŠŸ&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token function">ERROR</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">,</span><span class="token number">500</span><span class="token punctuation">,</span> <span class="token string">&quot;æ“ä½œå¤±è´¥&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token function">VALIDATE_FAILED</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">,</span><span class="token number">404</span><span class="token punctuation">,</span> <span class="token string">&quot;å‚æ•°æ£€éªŒå¤±è´¥&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token function">UNAUTHORIZED</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">,</span><span class="token number">401</span><span class="token punctuation">,</span> <span class="token string">&quot;æš‚æœªç™»å½•æˆ–tokenå·²ç»è¿‡æœŸ&quot;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token function">FORBIDDEN</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">,</span><span class="token number">403</span><span class="token punctuation">,</span> <span class="token string">&quot;æ²¡æœ‰ç›¸å…³æƒé™&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">private</span> <span class="token keyword">boolean</span> success<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token keyword">long</span> code<span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> message<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Data</span>
<span class="token annotation punctuation">@AllArgsConstructor</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">CommonResult</span> <span class="token punctuation">{</span>
    <span class="token doc-comment comment">/**
     * æ˜¯å¦æˆåŠŸ
     */</span>
    <span class="token keyword">private</span> <span class="token keyword">boolean</span> success<span class="token punctuation">;</span>

    <span class="token doc-comment comment">/**
     * çŠ¶æ€ç 
     */</span>
    <span class="token keyword">private</span> <span class="token keyword">long</span> code<span class="token punctuation">;</span>

    <span class="token doc-comment comment">/**
     * æç¤ºä¿¡æ¯
     */</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> message<span class="token punctuation">;</span>

    <span class="token doc-comment comment">/**
     * è¿”å›æ•°æ®
     */</span>
    <span class="token keyword">private</span> <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> data <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">private</span>  <span class="token class-name">CommonResult</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

    <span class="token doc-comment comment">/**
     * æˆåŠŸè¿”å›ç»“æœ
     * <span class="token keyword">@return</span>
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">CommonResult</span> <span class="token function">success</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token class-name">CommonResult</span><span class="token punctuation">.</span><span class="token function">setCommonResult</span><span class="token punctuation">(</span><span class="token class-name">ResultCode</span><span class="token punctuation">.</span><span class="token constant">SUCCESS</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token doc-comment comment">/**
     * å¤±è´¥è¿”å›ç»“æœ
     * <span class="token keyword">@return</span>
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">CommonResult</span> <span class="token function">error</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token class-name">CommonResult</span><span class="token punctuation">.</span><span class="token function">setCommonResult</span><span class="token punctuation">(</span><span class="token class-name">ResultCode</span><span class="token punctuation">.</span><span class="token constant">ERROR</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token doc-comment comment">/**
     * å‚æ•°éªŒè¯å¤±è´¥è¿”å›ç»“æœ
     * <span class="token keyword">@return</span>
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">CommonResult</span> <span class="token function">validateFailed</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token class-name">CommonResult</span><span class="token punctuation">.</span><span class="token function">setCommonResult</span><span class="token punctuation">(</span><span class="token class-name">ResultCode</span><span class="token punctuation">.</span><span class="token constant">VALIDATE_FAILED</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token doc-comment comment">/**
     * ç»Ÿä¸€è®¾ç½®è¿”å›ç»“æœ
     * <span class="token keyword">@param</span> <span class="token parameter">resultCode</span>
     * <span class="token keyword">@return</span>
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">CommonResult</span> <span class="token function">setCommonResult</span><span class="token punctuation">(</span><span class="token class-name">ResultCode</span> resultCode<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">CommonResult</span> commonResult <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">CommonResult</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        commonResult<span class="token punctuation">.</span><span class="token function">setSuccess</span><span class="token punctuation">(</span>resultCode<span class="token punctuation">.</span><span class="token function">isSuccess</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        commonResult<span class="token punctuation">.</span><span class="token function">setCode</span><span class="token punctuation">(</span>resultCode<span class="token punctuation">.</span><span class="token function">getCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        commonResult<span class="token punctuation">.</span><span class="token function">setMessage</span><span class="token punctuation">(</span>resultCode<span class="token punctuation">.</span><span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> commonResult<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token doc-comment comment">/**
     * ç»Ÿä¸€è®¾ç½®è¿”å›ç»“æœ, ä¿®æ”¹æç¤ºä¿¡æ¯ message
     * <span class="token keyword">@param</span> <span class="token parameter">resultCode</span>
     * <span class="token keyword">@param</span> <span class="token parameter">message</span>
     * <span class="token keyword">@return</span>
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">CommonResult</span> <span class="token function">setCommonResult</span><span class="token punctuation">(</span><span class="token class-name">ResultCode</span> resultCode<span class="token punctuation">,</span> <span class="token class-name">String</span> message<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">CommonResult</span> commonResult <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">CommonResult</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        commonResult<span class="token punctuation">.</span><span class="token function">setSuccess</span><span class="token punctuation">(</span>resultCode<span class="token punctuation">.</span><span class="token function">isSuccess</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        commonResult<span class="token punctuation">.</span><span class="token function">setCode</span><span class="token punctuation">(</span>resultCode<span class="token punctuation">.</span><span class="token function">getCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        commonResult<span class="token punctuation">.</span><span class="token function">setMessage</span><span class="token punctuation">(</span>message<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> commonResult<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token doc-comment comment">/**
     * è¿”å›æ•°æ®å¤„ç†
     * <span class="token keyword">@param</span> <span class="token parameter">key</span> è¿”å›æ•°æ® key å€¼
     * <span class="token keyword">@param</span> <span class="token parameter">value</span> è¿”å›æ•°æ® value å€¼
     * <span class="token keyword">@return</span>
     */</span>
    <span class="token keyword">public</span>  <span class="token class-name">CommonResult</span> <span class="token function">data</span><span class="token punctuation">(</span><span class="token class-name">String</span> key<span class="token punctuation">,</span> <span class="token class-name">Object</span> value<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>data<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token doc-comment comment">/**
     * è¿”å›æ•°æ®å¤„ç†
     * <span class="token keyword">@param</span> <span class="token parameter">map</span> è¿”å›æ•°æ®
     * <span class="token keyword">@return</span>
     */</span>
    <span class="token keyword">public</span> <span class="token class-name">CommonResult</span> <span class="token function">data</span><span class="token punctuation">(</span><span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> map<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setData</span><span class="token punctuation">(</span>map<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>æµ‹è¯• controller ç±»<code>UserController</code>æ–¹æ³•<code>list()</code>å’Œ<code>deleteTeacherById()</code></p><p><code>list()</code>æ–¹æ³•æµ‹è¯•ç»“æœï¼š</p><img src="https://eduimage1.oss-cn-beijing.aliyuncs.com/img/202203051119944.png" alt="image-20220305105457979" width="600"><p><code>deleteTeacherById()</code>æ–¹æ³•æµ‹è¯•ç»“æœï¼š</p><img src="https://eduimage1.oss-cn-beijing.aliyuncs.com/img/202203051121081.png" alt="image-20220305105239314" width="600"><p>å¯ä»¥çœ‹åˆ°æœ€ç»ˆè¯·æ±‚çš„è¿”å›å†…å®¹åŒ…å«äº†ç»Ÿä¸€è¿”å›ç»“æœå¤„ç†ç±»<code>CommonResult</code>å°è£…çš„å››ä¸ªå±æ€§ï¼š<code>success</code>ã€<code>code</code>ã€<code>message</code>å’Œ<code>data</code></p></li></ol><h2 id="å…¨å±€å¼‚å¸¸å¤„ç†" tabindex="-1"><a class="header-anchor" href="#å…¨å±€å¼‚å¸¸å¤„ç†" aria-hidden="true">#</a> å…¨å±€å¼‚å¸¸å¤„ç†</h2><p>æˆ‘ä»¬åœ¨ SpringBoot é¡¹ç›®ä¸­ï¼Œå¾€å¾€ä¼šå†™è®¸å¤š Controler æ¥å£ç±»ï¼Œç”±äº Controller ç±»æ¥å£ä¸­ä¼ é€’çš„å‚æ•°å„ä¸ç›¸åŒï¼Œå‡ºç°é”™è¯¯æ—¶æŠ›å‡ºçš„å¼‚å¸¸ä»¥åŠå¼‚å¸¸çš„å¤„ç†æ–¹å¼ä¹Ÿä¸å°½ç›¸åŒã€‚SpringBoot ä¸­ä¸å‚æ•°ç›¸å…³çš„å¼‚å¸¸ä¸»è¦æœ‰ä¸‰ä¸ªéœ€è¦æ‰‹åŠ¨å¤„ç†ï¼š</p><ul><li><code>org.springframework.validation.BindException</code></li><li><code>org.springframework.web.bind.MethodArgumentNotValidException</code></li><li><code>javax.validation.ConstraintViolationException</code></li></ul><p>æˆ‘ä»¬å¯ä»¥è®¾è®¡ä¸€ä¸ªå…¨å±€å¼‚å¸¸å¤„ç†ç±»ï¼Œæ–¹ä¾¿ç»Ÿä¸€å¤„ç†å¼‚å¸¸é”™è¯¯ä¿¡æ¯ï¼Œå¯¹é¡¹ç›®<code>springboot-commonresult</code>ä»£ç è¿›è¡Œæ‰©å……ï¼Œå¢åŠ å…¨å±€å¼‚å¸¸å¤„ç†çš„ä»£ç ï¼Œæ­¥éª¤å¦‚ä¸‹ï¼š</p><ol><li><p>é‡å¤ç»Ÿä¸€è¿”å›ç»“æœ<a href="#_link_result1">æ­¥éª¤1</a>ï¼Œ<a href="_link_result1">æ­¥éª¤2</a></p></li><li><p><code>xml</code>æ–‡ä»¶ä¸­æ–°å¢æ•°æ®æ ¡éªŒæ³¨è§£ä¾èµ–</p><div class="language-yaml line-numbers-mode" data-ext="yml"><pre class="language-yaml"><code>&lt;<span class="token tag">!--</span>æ•°æ®æ ¡éªŒ SpringBoot 2.3 ç‰ˆæœ¬ä»¥ä¸Š<span class="token punctuation">-</span><span class="token punctuation">-</span><span class="token punctuation">&gt;</span>
&lt;dependency<span class="token punctuation">&gt;</span>
    &lt;groupId<span class="token punctuation">&gt;</span>org.springframework.boot&lt;/groupId<span class="token punctuation">&gt;</span>
    &lt;artifactId<span class="token punctuation">&gt;</span>spring<span class="token punctuation">-</span>boot<span class="token punctuation">-</span>starter<span class="token punctuation">-</span>validation&lt;/artifactId<span class="token punctuation">&gt;</span>
&lt;/dependency<span class="token punctuation">&gt;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="custom-container tip"><p class="custom-container-title">Tips</p><p>1ã€SpringBoot ä¸ºæˆ‘ä»¬æä¾›äº†ä¸€ç³»åˆ—å‚æ•°æ ¡éªŒçš„æ³¨è§£ï¼Œè¿™äº›æ³¨è§£å¯ä»¥ç›´æ¥ä½œç”¨åœ¨å®ä½“ç±»çš„å±æ€§ä¸Šï¼Œæ¥å¯¹å±æ€§çš„å€¼è¿›è¡Œé™åˆ¶ï¼Œä¸éœ€è¦æˆ‘ä»¬æ‰‹åŠ¨å»å†™è®¸å¤š<code>if else</code>ä»£ç æ¥å¯¹å±æ€§å€¼è¿›è¡Œåˆ¤æ–­ï¼Œå¦‚ï¼š</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">if</span> <span class="token punctuation">(</span>user<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token keyword">null</span> <span class="token operator">||</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>user<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>user<span class="token punctuation">.</span><span class="token function">getAge</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
 <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>user<span class="token punctuation">.</span><span class="token function">getUsername</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
 <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
 <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>2ã€SpringBoot 2.3 ä»¥ä¸Šç‰ˆæœ¬éœ€è¦æ·»åŠ <code>spring-boot-starter-validation</code>ä¾èµ–ï¼Œå¦åˆ™å‚æ•°æ ¡éªŒå¯èƒ½ä¼šå¤±è´¥ï¼Œ2.3 ä»¥ä¸‹ç‰ˆæœ¬å¯ä»¥ä¸æ·»åŠ ï¼Œåªéœ€è¦æ·»åŠ <code>spring-boot-starter-web</code>ä¾èµ–å³å¯ï¼š</p><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code><span class="token comment">&lt;!--SpringBoot Web ä¾èµ–--&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.springframework.boot<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>spring-boot-starter-web<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></div><p><strong>å¸¸ç”¨æ ¡éªŒæ³¨è§£å¦‚ä¸‹ï¼š</strong></p><table><thead><tr><th style="text-align:left;">æ³¨è§£</th><th>å«ä¹‰</th></tr></thead><tbody><tr><td style="text-align:left;"><code>@NotEmpty</code></td><td>è¢«æ³¨é‡Šçš„å­—ç¬¦ä¸²çš„ä¸èƒ½ä¸º null ä¹Ÿä¸èƒ½ä¸ºç©ºï¼Œä¸€èˆ¬ç”¨åœ¨é›†åˆç±»ä¸Šæˆ–è€…æ•°ç»„ä¸Š</td></tr><tr><td style="text-align:left;"><code>@NotBlank</code></td><td>è¢«æ³¨é‡Šçš„å­—ç¬¦ä¸²é nullï¼Œå¹¶ä¸”å¿…é¡»åŒ…å«ä¸€ä¸ªéç©ºç™½å­—ç¬¦ï¼Œåªèƒ½ä½œç”¨åœ¨æ¥æ”¶çš„ String ç±»å‹ä¸Š</td></tr><tr><td style="text-align:left;"><code>@Null</code></td><td>è¢«æ³¨é‡Šçš„å…ƒç´ å¿…é¡»ä¸º null</td></tr><tr><td style="text-align:left;"><code>@NotNull</code></td><td>è¢«æ³¨é‡Šçš„å…ƒç´ å¿…é¡»ä¸ä¸º nullï¼Œä½†å¯ä»¥ä¸ºemptyï¼Œä¸€èˆ¬ç”¨åœ¨ Integer ç±»å‹çš„åŸºæœ¬æ•°æ®ç±»å‹çš„éç©ºæ ¡éªŒä¸Š</td></tr><tr><td style="text-align:left;"><code>@AssertTrue</code></td><td>è¢«æ³¨é‡Šçš„å…ƒç´ å¿…é¡»ä¸º true</td></tr><tr><td style="text-align:left;"><code>@AssertFalse</code></td><td>è¢«æ³¨é‡Šçš„å…ƒç´ å¿…é¡»ä¸º false</td></tr><tr><td style="text-align:left;"><code>@Pattern(regex=,flag=)</code></td><td>è¢«æ³¨é‡Šçš„å…ƒç´ å¿…é¡»ç¬¦åˆæŒ‡å®šçš„æ­£åˆ™è¡¨è¾¾å¼</td></tr><tr><td style="text-align:left;"><code>@Email</code></td><td>è¢«æ³¨é‡Šçš„å…ƒç´ å¿…é¡»æ˜¯ Email æ ¼å¼</td></tr><tr><td style="text-align:left;"><code>@Min(value)</code></td><td>è¢«æ³¨é‡Šçš„å…ƒç´ å¿…é¡»æ˜¯ä¸€ä¸ªæ•°å­—ï¼Œå…¶å€¼å¿…é¡»å¤§äºç­‰äºæŒ‡å®šçš„æœ€å°å€¼</td></tr><tr><td style="text-align:left;"><code>@Max(value)</code></td><td>è¢«æ³¨é‡Šçš„å…ƒç´ å¿…é¡»æ˜¯ä¸€ä¸ªæ•°å­—ï¼Œå…¶å€¼å¿…é¡»å°äºç­‰äºæŒ‡å®šçš„æœ€å¤§å€¼</td></tr><tr><td style="text-align:left;"><code>@DecimalMin(value)</code></td><td>è¢«æ³¨é‡Šçš„å…ƒç´ å¿…é¡»æ˜¯ä¸€ä¸ªæ•°å­—ï¼Œå…¶å€¼å¿…é¡»å¤§äºç­‰äºæŒ‡å®šçš„æœ€å°å€¼</td></tr><tr><td style="text-align:left;"><code>@DecimalMax(value)</code></td><td>è¢«æ³¨é‡Šçš„å…ƒç´ å¿…é¡»æ˜¯ä¸€ä¸ªæ•°å­—ï¼Œå…¶å€¼å¿…é¡»å°äºç­‰äºæŒ‡å®šçš„æœ€å¤§å€¼</td></tr><tr><td style="text-align:left;"><code>@Size(max=, min=)</code></td><td>è¢«æ³¨é‡Šçš„å…ƒç´ çš„å¤§å°å¿…é¡»åœ¨æŒ‡å®šçš„èŒƒå›´å†…</td></tr></tbody></table></li><li><p>ä¿®æ”¹å®ä½“ç±»<code>User</code>ï¼Œå¯¹å®ä½“ç±»å±æ€§å¢åŠ æ•°æ®æ ¡éªŒæ³¨è§£</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Data</span>
<span class="token annotation punctuation">@NoArgsConstructor</span>
<span class="token annotation punctuation">@AllArgsConstructor</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">User</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token class-name">Long</span> id<span class="token punctuation">;</span>
    <span class="token annotation punctuation">@NotBlank</span><span class="token punctuation">(</span>message <span class="token operator">=</span> <span class="token string">&quot;åå­—ä¸ä¸ºç©º&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> name<span class="token punctuation">;</span>
    <span class="token annotation punctuation">@NotBlank</span><span class="token punctuation">(</span>message <span class="token operator">=</span> <span class="token string">&quot;å¹´é¾„ä¸ä¸ºç©º&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">Integer</span> age<span class="token punctuation">;</span>
    <span class="token annotation punctuation">@Email</span><span class="token punctuation">(</span>message <span class="token operator">=</span> <span class="token string">&quot;é‚®ç®±æ ¼å¼ä¸æ­£ç¡®&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> email<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>ç¼–å†™å…¨å±€å¼‚å¸¸å¤„ç†ç±»ä»£ç </p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Slf4j</span>
<span class="token annotation punctuation">@ControllerAdvice</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">GlobalExceptionHandler</span> <span class="token punctuation">{</span>

    <span class="token doc-comment comment">/**
     *
     * <span class="token keyword">@param</span> <span class="token parameter">e</span> BindException è¡¨å•ç»‘å®šåˆ° JavaBean å‡ºé”™æ—¶,æŠ›å‡º BindException å¼‚å¸¸
     * <span class="token keyword">@return</span>
     * @ExceptionHandler ç»Ÿä¸€å¤„ç† BindException å¼‚å¸¸
     */</span>
    <span class="token annotation punctuation">@ResponseBody</span>
    <span class="token annotation punctuation">@ExceptionHandler</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token class-name">BindException</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">CommonResult</span> <span class="token function">handleValidException</span><span class="token punctuation">(</span><span class="token class-name">BindException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Map</span><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> list <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">ObjectError</span> objectError <span class="token operator">:</span> e<span class="token punctuation">.</span><span class="token function">getAllErrors</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> map <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>objectError <span class="token keyword">instanceof</span> <span class="token class-name">FieldError</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token class-name">FieldError</span> fieldError <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">FieldError</span><span class="token punctuation">)</span> objectError<span class="token punctuation">;</span>
                map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;field&quot;</span><span class="token punctuation">,</span> fieldError<span class="token punctuation">.</span><span class="token function">getField</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;message&quot;</span><span class="token punctuation">,</span> fieldError<span class="token punctuation">.</span><span class="token function">getDefaultMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
                map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;field&quot;</span><span class="token punctuation">,</span> objectError<span class="token punctuation">.</span><span class="token function">getObjectName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;message&quot;</span><span class="token punctuation">,</span> objectError<span class="token punctuation">.</span><span class="token function">getDefaultMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            list<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>map<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> <span class="token class-name">CommonResult</span><span class="token punctuation">.</span><span class="token function">validateFailed</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">data</span><span class="token punctuation">(</span><span class="token string">&quot;items&quot;</span><span class="token punctuation">,</span> list<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token doc-comment comment">/**
     *
     * <span class="token keyword">@param</span> <span class="token parameter">e</span> å°†è¯·æ±‚ä½“è§£æå¹¶ç»‘å®šåˆ° JavaBean å‡ºé”™æ—¶,æŠ›å‡º MethodArgumentNotValidException å¼‚å¸¸
     * <span class="token keyword">@return</span>
     */</span>
    <span class="token annotation punctuation">@ResponseBody</span>
    <span class="token annotation punctuation">@ExceptionHandler</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token class-name">MethodArgumentNotValidException</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">CommonResult</span> <span class="token function">handleValidException</span><span class="token punctuation">(</span><span class="token class-name">MethodArgumentNotValidException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Map</span><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">&gt;</span><span class="token punctuation">&gt;</span></span> list <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token class-name">ObjectError</span> objectError <span class="token operator">:</span> e<span class="token punctuation">.</span><span class="token function">getAllErrors</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// éå†æ‰€æœ‰é”™è¯¯</span>
            <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> map <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>objectError <span class="token keyword">instanceof</span> <span class="token class-name">FieldError</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>       <span class="token comment">// æ˜¯å¦ä¸ºå‚æ•°é”™è¯¯</span>
                <span class="token class-name">FieldError</span> fieldError <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">FieldError</span><span class="token punctuation">)</span> objectError<span class="token punctuation">;</span>
                map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;field&quot;</span><span class="token punctuation">,</span> fieldError<span class="token punctuation">.</span><span class="token function">getField</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;message&quot;</span><span class="token punctuation">,</span> fieldError<span class="token punctuation">.</span><span class="token function">getDefaultMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
                map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;field&quot;</span><span class="token punctuation">,</span> objectError<span class="token punctuation">.</span><span class="token function">getObjectName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                map<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;message&quot;</span><span class="token punctuation">,</span> objectError<span class="token punctuation">.</span><span class="token function">getDefaultMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            list<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>map<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> <span class="token class-name">CommonResult</span><span class="token punctuation">.</span><span class="token function">validateFailed</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">data</span><span class="token punctuation">(</span><span class="token string">&quot;items&quot;</span><span class="token punctuation">,</span> list<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="custom-container tip"><p class="custom-container-title">Tips</p><p>å‚è€ƒ<a href="https://juejin.cn/post/6844904003684302861" target="_blank" rel="noopener noreferrer">Spring å‚æ•°æ ¡éªŒçš„å¼‚å¸¸å¤„ç† - æ˜é‡‘ (juejin.cn)<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p></div></li><li><p>UserControler ç±»ä¸­æ·»åŠ æ–¹æ³• <code>addUser()</code> æ¥å£</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@PostMapping</span><span class="token punctuation">(</span><span class="token string">&quot;addUser&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token class-name">CommonResult</span> <span class="token function">addUser</span><span class="token punctuation">(</span><span class="token annotation punctuation">@Valid</span> <span class="token annotation punctuation">@RequestBody</span> <span class="token class-name">User</span> user<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">boolean</span> result <span class="token operator">=</span> userService<span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span>user<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>result<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    	<span class="token keyword">return</span> <span class="token class-name">CommonResult</span><span class="token punctuation">.</span><span class="token function">success</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span>
    	<span class="token keyword">return</span> <span class="token class-name">CommonResult</span><span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="custom-container tip"><p class="custom-container-title">Tips</p><p>æ³¨è§£<code>@Valid</code>ç”¨æ¥éªŒè¯è¡¨å•ä¼ é€’è¿‡æ¥çš„æ•°æ®æ˜¯å¦ç¬¦åˆå‚æ•°æ ¡éªŒï¼Œå¦‚æœæ•°æ®å¼‚å¸¸åˆ™ä¼šç»Ÿä¸€æŠ›å‡ºå¼‚å¸¸ï¼Œæ–¹ä¾¿å¼‚å¸¸ä¸­å¿ƒç»Ÿä¸€å¤„ç†</p></div></li><li><p>æµ‹è¯•<code>addUser()</code>æ¥å£</p><p>å½“ User ç±»å±æ€§ <code>name=&quot;&quot;</code>ï¼Œå±æ€§<code>email</code>æ ¼å¼ä¸æ­£ç¡®æ—¶ï¼Œè¾“å‡ºå†…å®¹å¦‚ä¸‹ï¼š</p><img src="https://eduimage1.oss-cn-beijing.aliyuncs.com/img/image-20221023213515128.png" alt="image-20221023213515128" style="zoom:50%;"></li><li><p>æˆ‘ä»¬ä¹Ÿå¯ä»¥è‡ªå®šä¹‰å¼‚å¸¸ï¼Œç¼–å†™è‡ªå®šä¹‰å¼‚å¸¸ç±»<code>CustomizeApiException</code></p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Data</span>
<span class="token annotation punctuation">@AllArgsConstructor</span>  <span class="token comment">//æœ‰å‚æ•°æ„é€ å™¨</span>
<span class="token annotation punctuation">@NoArgsConstructor</span>   <span class="token comment">//ç”Ÿæˆæ— å‚æ•°æ„é€ </span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">CustomizeApiException</span> <span class="token keyword">extends</span> <span class="token class-name">RuntimeException</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token class-name">Integer</span> code<span class="token punctuation">;</span>   <span class="token comment">// çŠ¶æ€ç </span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> msg<span class="token punctuation">;</span>     <span class="token comment">// è¾“å‡ºæ¶ˆæ¯</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>åœ¨å…¨å±€å¼‚å¸¸å¤„ç†ç±»<code>GlobalExceptionHandler</code>æ·»åŠ å¯¹è‡ªå®šä¹‰å¼‚å¸¸çš„å¤„ç†æ–¹æ³•</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token doc-comment comment">/**
* è‡ªå®šä¹‰å¼‚å¸¸å¤„ç†
* <span class="token keyword">@return</span>
*/</span>
<span class="token annotation punctuation">@ExceptionHandler</span><span class="token punctuation">(</span><span class="token class-name">CustomizeApiException</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@ResponseBody</span>
<span class="token keyword">public</span> <span class="token class-name">CommonResult</span> <span class="token function">handleCustomizeApiException</span><span class="token punctuation">(</span><span class="token class-name">CustomizeApiException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    log<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span><span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token class-name">CommonResult</span><span class="token punctuation">.</span><span class="token function">setCommonResult</span><span class="token punctuation">(</span><span class="token class-name">ResultCode</span><span class="token punctuation">.</span><span class="token constant">ERROR</span><span class="token punctuation">,</span> e<span class="token punctuation">.</span><span class="token function">getMsg</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ol><h2 id="ç»Ÿä¸€æ—¥å¿—å¤„ç†" tabindex="-1"><a class="header-anchor" href="#ç»Ÿä¸€æ—¥å¿—å¤„ç†" aria-hidden="true">#</a> ç»Ÿä¸€æ—¥å¿—å¤„ç†</h2><p>åœ¨é¡¹ç›®å¼€å‘ä¸­ï¼Œå¾€å¾€ä¼šé‡åˆ°å„ç§é”™è¯¯ï¼Œ<strong>ç»Ÿä¸€æ—¥å¿—å¤„ç†</strong>å¯ä»¥æ–¹ä¾¿å¿«é€Ÿå®šä½é”™è¯¯ä½ç½®ï¼Œä¾¿äºç¨‹åºè°ƒè¯•ã€‚</p><div class="custom-container info"><p class="custom-container-title">ä½¿ç”¨åŸåˆ™</p><p>é˜¿é‡Œå·´å·´ Java å¼€å‘æ‰‹å†Œä¸­å»ºè®®ï¼šåº”ç”¨ä¸­ä¸å¯ç›´æ¥ä½¿ç”¨æ—¥å¿—ç³»ç»Ÿï¼ˆLog4j ã€Logbackï¼‰ä¸­çš„ API ï¼Œè€Œåº”ä¾èµ–ä½¿ç”¨æ—¥å¿—æ¡†æ¶ SLF4J ä¸­çš„ API ï¼Œä½¿ç”¨é—¨é¢æ¨¡å¼çš„æ—¥å¿—æ¡†æ¶ï¼Œæœ‰åˆ©äºç»´æŠ¤å’Œå„ä¸ªç±»çš„æ—¥å¿—å¤„ç†æ–¹å¼ç»Ÿä¸€</p></div><p>SpringBoot é¡¹ç›®ä¸­ä½¿ç”¨<code>SLF4J+Log4j2</code>è¿›è¡Œç»Ÿä¸€æ—¥å¿—å¤„ç†ï¼Œæµç¨‹å¦‚ä¸‹ï¼š</p><ol><li><p><code>pom.xml</code> æ–‡ä»¶ä¸­å¼•å…¥ç›¸å…³ä¾èµ–</p><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code><span class="token comment">&lt;!-- log4j2æ—¥å¿—ä¾èµ–æ ¸å¿ƒåŒ… --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.apache.logging.log4j<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>log4j-api<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>2.17.1<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.apache.logging.log4j<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>log4j-core<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>2.17.1<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
<span class="token comment">&lt;!--ç”¨äºä¸ slf4j ä¿æŒæ¡¥æ¥--&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.apache.logging.log4j<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>log4j-slf4j-impl<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>2.17.1<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
<span class="token comment">&lt;!-- slf4j æ—¥å¿—æ¡†æ¶æ ¸å¿ƒåŒ…--&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.slf4j<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>slf4j-api<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>1.7.32<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>resources èµ„æºæ–‡ä»¶ç›®å½•ä¸‹æ–°å»ºæ—¥å¿—é…ç½®æ–‡ä»¶<code>log4j2.xml</code></p><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code><span class="token prolog">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span>
<span class="token comment">&lt;!--æ—¥å¿—çº§åˆ«ä»¥åŠä¼˜å…ˆçº§æ’åº: OFF &gt; FATAL &gt; ERROR &gt; WARN &gt; INFO &gt; DEBUG &gt; TRACE &gt; ALL è·Ÿè¸ªã€è°ƒè¯•ã€ä¿¡æ¯ã€è­¦å‘Šã€é”™è¯¯å’Œè‡´å‘½--&gt;</span>
<span class="token comment">&lt;!--status=&quot;WARN&quot; :ç”¨äºè®¾ç½® log4j2 è‡ªèº«å†…éƒ¨æ—¥å¿—çš„ä¿¡æ¯è¾“å‡ºçº§åˆ«ï¼Œé»˜è®¤æ˜¯OFF--&gt;</span>
<span class="token comment">&lt;!--monitorInterval=&quot;30&quot;  :é—´éš”ç§’æ•°, è‡ªåŠ¨æ£€æµ‹é…ç½®æ–‡ä»¶çš„å˜æ›´å’Œé‡æ–°é…ç½®æœ¬èº«--&gt;</span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>configuration</span> <span class="token attr-name">status</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>WARN<span class="token punctuation">&quot;</span></span> <span class="token attr-name">monitorInterval</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>30<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>

    <span class="token comment">&lt;!--å˜é‡é…ç½®--&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Properties</span><span class="token punctuation">&gt;</span></span>
        <span class="token comment">&lt;!-- æ ¼å¼åŒ–è¾“å‡ºï¼š%dateè¡¨ç¤ºæ—¥æœŸ, %threadè¡¨ç¤ºçº¿ç¨‹å, %-5level: çº§åˆ«ä»å·¦æ˜¾ç¤º 5 ä¸ªå­—ç¬¦å®½åº¦ %msg: æ—¥å¿—æ¶ˆæ¯, %næ˜¯æ¢è¡Œç¬¦--&gt;</span>
        <span class="token comment">&lt;!-- %logger{36} è¡¨ç¤º Logger åå­—æœ€é•¿ 36 ä¸ªå­—ç¬¦ --&gt;</span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>LOG_PATTERN<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>%d{yyyy-MM-dd HH:mm:ss} [%thread] %-5level %logger{36} - %msg%n<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
        <span class="token comment">&lt;!-- å®šä¹‰æ—¥å¿—å­˜å‚¨çš„è·¯å¾„, ä¸è¦é…ç½®ç›¸å¯¹è·¯å¾„ --&gt;</span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>LOG_FILE_PATH<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>E:\logs\log4j2<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>LOG_FILE_NAME<span class="token punctuation">&quot;</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>edulog4j2<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Properties</span><span class="token punctuation">&gt;</span></span>

    <span class="token comment">&lt;!--appenders: å®šä¹‰è¾“å‡ºå†…å®¹, è¾“å‡ºæ ¼å¼, è¾“å‡ºæ–¹å¼, æ—¥å¿—ä¿å­˜ç­–ç•¥ç­‰, å¸¸ç”¨å…¶ä¸‹ä¸‰ç§æ ‡ç­¾[console, File, RollingFile]--&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>appenders</span><span class="token punctuation">&gt;</span></span>
        <span class="token comment">&lt;!--Appender 1. è¾“å‡ºåˆ° Console æ§åˆ¶å°, æŒ‡å®šè¾“å‡ºæ ¼å¼å’Œè¿‡æ»¤å™¨ç­‰çº§ä¸º INFO --&gt;</span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>console</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>Console<span class="token punctuation">&quot;</span></span> <span class="token attr-name">target</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>SYSTEM_OUT<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
            <span class="token comment">&lt;!--æ—¥å¿—è¾“å‡ºçš„æ ¼å¼--&gt;</span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>PatternLayout</span> <span class="token attr-name">pattern</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>${LOG_PATTERN}<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
            <span class="token comment">&lt;!--ThresholdFilter æŒ‡å®šæ—¥å¿—æ¶ˆæ¯çš„è¾“å‡ºæœ€ä½å±‚æ¬¡--&gt;</span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ThresholdFilter</span> <span class="token attr-name">level</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>info<span class="token punctuation">&quot;</span></span> <span class="token attr-name">onMatch</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>ACCEPT<span class="token punctuation">&quot;</span></span> <span class="token attr-name">onMismatch</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>DENY<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>console</span><span class="token punctuation">&gt;</span></span>

        <span class="token comment">&lt;!--File: åŒæ­¥è¾“å‡ºæ—¥å¿—åˆ°æœ¬åœ°æ–‡ä»¶--&gt;</span>
        <span class="token comment">&lt;!--append=&quot;false&quot;: æ ¹æ®å…¶ä¸‹æ—¥å¿—ç­–ç•¥, æ¯æ¬¡æ¸…ç©ºæ–‡ä»¶é‡æ–°è¾“å…¥æ—¥å¿—, å¯ç”¨äºæµ‹è¯•--&gt;</span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>File</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>Filelog<span class="token punctuation">&quot;</span></span> <span class="token attr-name">fileName</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>${LOG_FILE_PATH}/test.log<span class="token punctuation">&quot;</span></span> <span class="token attr-name">append</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>false<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>PatternLayout</span> <span class="token attr-name">pattern</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>${LOG_PATTERN}<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>File</span><span class="token punctuation">&gt;</span></span>

        <span class="token comment">&lt;!-- æ‰“å°å‡ºæ‰€æœ‰çš„ info åŠä»¥ä¸‹çº§åˆ«çš„ä¿¡æ¯, æ¯æ¬¡å¤§å°è¶…è¿‡ size, åˆ™è¿™ä¸ª size å¤§å°çš„æ—¥å¿—ä¼šè‡ªåŠ¨å­˜å…¥æŒ‰å¹´ä»½-æœˆä»½å»ºç«‹çš„æ–‡ä»¶å¤¹ä¸‹é¢å¹¶è¿›è¡Œå‹ç¼©, ä½œä¸ºå­˜æ¡£--&gt;</span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>RollingFile</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>RollingFileInfo<span class="token punctuation">&quot;</span></span> <span class="token attr-name">fileName</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>${LOG_FILE_PATH}/info.log<span class="token punctuation">&quot;</span></span> <span class="token attr-name">filePattern</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>${LOG_FILE_PATH}/${LOG_FILE_NAME}-INFO-%d{yyyy-MM-dd}_%i.log.gz<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
            <span class="token comment">&lt;!--ThresholdFilter : æ—¥å¿—è¾“å‡ºè¿‡æ»¤--&gt;</span>
            <span class="token comment">&lt;!--level=&quot;info&quot; : æ—¥å¿—çº§åˆ«; onMatch=&quot;ACCEPT&quot; : çº§åˆ«åœ¨ info ä¹‹ä¸Šåˆ™æ¥å—; onMismatch=&quot;DENY&quot; : çº§åˆ«åœ¨ info ä¹‹ä¸‹åˆ™æ‹’ç»--&gt;</span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ThresholdFilter</span> <span class="token attr-name">level</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>info<span class="token punctuation">&quot;</span></span> <span class="token attr-name">onMatch</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>ACCEPT<span class="token punctuation">&quot;</span></span> <span class="token attr-name">onMismatch</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>DENY<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>PatternLayout</span> <span class="token attr-name">pattern</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>${LOG_PATTERN}<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
            <span class="token comment">&lt;!-- Policies: æ—¥å¿—æ»šåŠ¨ç­–ç•¥--&gt;</span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Policies</span><span class="token punctuation">&gt;</span></span>
                <span class="token comment">&lt;!-- TimeBasedTriggeringPolicy : æ—¶é—´æ»šåŠ¨ç­–ç•¥, é»˜è®¤0ç‚¹äº§ç”Ÿæ–°çš„æ–‡ä»¶,
                        interval=&quot;6&quot; : è‡ªå®šä¹‰æ–‡ä»¶æ»šåŠ¨æ—¶é—´é—´éš”, æ¯éš” 6 å°æ—¶äº§ç”Ÿæ–°æ–‡ä»¶,
                        modulate=&quot;true&quot; : äº§ç”Ÿæ–‡ä»¶æ˜¯å¦ä»¥ 0 ç‚¹åç§»æ—¶é—´, å³6ç‚¹, 12ç‚¹, 18ç‚¹, 0ç‚¹--&gt;</span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>TimeBasedTriggeringPolicy</span> <span class="token attr-name">interval</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>6<span class="token punctuation">&quot;</span></span> <span class="token attr-name">modulate</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>true<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
                <span class="token comment">&lt;!-- SizeBasedTriggeringPolicy : æ–‡ä»¶å¤§å°æ»šåŠ¨ç­–ç•¥--&gt;</span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>SizeBasedTriggeringPolicy</span> <span class="token attr-name">size</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>10MB<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Policies</span><span class="token punctuation">&gt;</span></span>
            <span class="token comment">&lt;!-- DefaultRolloverStrategy å±æ€§å¦‚ä¸è®¾ç½®, åˆ™é»˜è®¤ä¸ºæœ€å¤šåŒä¸€æ–‡ä»¶å¤¹ä¸‹ 7 ä¸ªæ–‡ä»¶å¼€å§‹è¦†ç›–--&gt;</span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>DefaultRolloverStrategy</span> <span class="token attr-name">max</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>15<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>RollingFile</span><span class="token punctuation">&gt;</span></span>

        <span class="token comment">&lt;!-- æ‰“å°å‡ºæ‰€æœ‰çš„ warn åŠä»¥ä¸‹çº§åˆ«çš„ä¿¡æ¯, æ¯æ¬¡å¤§å°è¶…è¿‡size, åˆ™è¿™ä¸ª size å¤§å°çš„æ—¥å¿—ä¼šè‡ªåŠ¨å­˜å…¥æŒ‰å¹´ä»½-æœˆä»½å»ºç«‹çš„æ–‡ä»¶å¤¹ä¸‹é¢å¹¶è¿›è¡Œå‹ç¼©, ä½œä¸ºå­˜æ¡£--&gt;</span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>RollingFile</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>RollingFileWarn<span class="token punctuation">&quot;</span></span> <span class="token attr-name">fileName</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>${LOG_FILE_PATH}/warn.log<span class="token punctuation">&quot;</span></span> <span class="token attr-name">filePattern</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>${LOG_FILE_PATH}/${LOG_FILE_NAME}-WARN-%d{yyyy-MM-dd}_%i.log.gz<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ThresholdFilter</span> <span class="token attr-name">level</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>warn<span class="token punctuation">&quot;</span></span> <span class="token attr-name">onMatch</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>ACCEPT<span class="token punctuation">&quot;</span></span> <span class="token attr-name">onMismatch</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>DENY<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>PatternLayout</span> <span class="token attr-name">pattern</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>${LOG_PATTERN}<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Policies</span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>TimeBasedTriggeringPolicy</span> <span class="token attr-name">interval</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>1<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>SizeBasedTriggeringPolicy</span> <span class="token attr-name">size</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>10MB<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Policies</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>DefaultRolloverStrategy</span> <span class="token attr-name">max</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>15<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>RollingFile</span><span class="token punctuation">&gt;</span></span>

        <span class="token comment">&lt;!-- æ‰“å°å‡ºæ‰€æœ‰çš„ erroråŠä»¥ä¸‹çº§åˆ«çš„ä¿¡æ¯, æ¯æ¬¡å¤§å°è¶…è¿‡size, åˆ™è¿™ä¸ª size å¤§å°çš„æ—¥å¿—ä¼šè‡ªåŠ¨å­˜å…¥æŒ‰å¹´ä»½-æœˆä»½å»ºç«‹çš„æ–‡ä»¶å¤¹ä¸‹é¢å¹¶è¿›è¡Œå‹ç¼©, ä½œä¸ºå­˜æ¡£--&gt;</span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>RollingFile</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>RollingFileError<span class="token punctuation">&quot;</span></span> <span class="token attr-name">fileName</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>${LOG_FILE_PATH}/error.log<span class="token punctuation">&quot;</span></span> <span class="token attr-name">filePattern</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>${LOG_FILE_PATH}/${LOG_FILE_NAME}-ERROR-%d{yyyy-MM-dd}_%i.log.gz<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ThresholdFilter</span> <span class="token attr-name">level</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>error<span class="token punctuation">&quot;</span></span> <span class="token attr-name">onMatch</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>ACCEPT<span class="token punctuation">&quot;</span></span> <span class="token attr-name">onMismatch</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>DENY<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>PatternLayout</span> <span class="token attr-name">pattern</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>${LOG_PATTERN}<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Policies</span><span class="token punctuation">&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>TimeBasedTriggeringPolicy</span> <span class="token attr-name">interval</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>1<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>SizeBasedTriggeringPolicy</span> <span class="token attr-name">size</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>10MB<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>Policies</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>DefaultRolloverStrategy</span> <span class="token attr-name">max</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>15<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>RollingFile</span><span class="token punctuation">&gt;</span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>appenders</span><span class="token punctuation">&gt;</span></span>

    <span class="token comment">&lt;!--LoggerèŠ‚ç‚¹ç”¨æ¥å•ç‹¬æŒ‡å®šæ—¥å¿—çš„å½¢å¼ï¼Œæ¯”å¦‚è¦ä¸ºæŒ‡å®šåŒ…ä¸‹çš„classæŒ‡å®šä¸åŒçš„æ—¥å¿—çº§åˆ«ç­‰ã€‚--&gt;</span>
    <span class="token comment">&lt;!-- å®šä¹‰loggers, åªæœ‰å®šä¹‰äº† logger å¹¶å¼•å…¥çš„ appender, appenderæ‰ä¼šç”Ÿæ•ˆ--&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>loggers</span><span class="token punctuation">&gt;</span></span>

        <span class="token comment">&lt;!--è¿‡æ»¤æ‰ spring å’Œ mybatis çš„ä¸€äº›æ— ç”¨çš„ DEBUG ä¿¡æ¯--&gt;</span>
        <span class="token comment">&lt;!--Logger èŠ‚ç‚¹ç”¨æ¥å•ç‹¬æŒ‡å®šæ—¥å¿—çš„å½¢å¼, nameä¸ºåŒ…è·¯å¾„, æ¯”å¦‚è¦ä¸º org.springframework åŒ…ä¸‹æ‰€æœ‰æ—¥å¿—æŒ‡å®šä¸º INFO çº§åˆ«ç­‰ --&gt;</span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>logger</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>org.springframework<span class="token punctuation">&quot;</span></span> <span class="token attr-name">level</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>INFO<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>logger</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>logger</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>org.mybatis<span class="token punctuation">&quot;</span></span> <span class="token attr-name">level</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>INFO<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>logger</span><span class="token punctuation">&gt;</span></span>
        <span class="token comment">&lt;!-- RootèŠ‚ç‚¹ç”¨æ¥æŒ‡å®šé¡¹ç›®çš„æ ¹æ—¥å¿—, å¦‚æœæ²¡æœ‰å•ç‹¬æŒ‡å®š Logger, é‚£ä¹ˆå°±ä¼šé»˜è®¤ä½¿ç”¨è¯¥ Root æ—¥å¿—è¾“å‡º --&gt;</span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>root</span> <span class="token attr-name">level</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>info<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>appender-ref</span> <span class="token attr-name">ref</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>Console<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>appender-ref</span> <span class="token attr-name">ref</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>Filelog<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>appender-ref</span> <span class="token attr-name">ref</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>RollingFileInfo<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>appender-ref</span> <span class="token attr-name">ref</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>RollingFileWarn<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>appender-ref</span> <span class="token attr-name">ref</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>RollingFileError<span class="token punctuation">&quot;</span></span><span class="token punctuation">/&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>root</span><span class="token punctuation">&gt;</span></span>
        <span class="token comment">&lt;!--AsyncLogger : å¼‚æ­¥æ—¥å¿—, LOG4J æœ‰ä¸‰ç§æ—¥å¿—æ¨¡å¼: å…¨å¼‚æ­¥æ—¥å¿—,æ··åˆæ¨¡å¼,åŒæ­¥æ—¥å¿—; æ€§èƒ½ä»é«˜åˆ°åº•, çº¿ç¨‹è¶Šå¤šæ•ˆç‡è¶Šé«˜, ä¹Ÿå¯ä»¥é¿å…æ—¥å¿—å¡æ­»çº¿ç¨‹æƒ…å†µå‘ç”Ÿ--&gt;</span>
        <span class="token comment">&lt;!--additivity=&quot;false&quot; : additivity è®¾ç½®äº‹ä»¶æ˜¯å¦åœ¨ root logger è¾“å‡º, ä¸ºäº†é¿å…é‡å¤è¾“å‡º, å¯ä»¥åœ¨ Logger æ ‡ç­¾ä¸‹è®¾ç½® additivityä¸º â€falseâ€ --&gt;</span>
        <span class="token comment">&lt;!--&lt;AsyncLogger name=&quot;AsyncLogger&quot; level=&quot;trace&quot; includeLocation=&quot;true&quot; additivity=&quot;false&quot;&gt;
            &lt;appender-ref ref=&quot;RollingFileError&quot;/&gt;
        &lt;/AsyncLogger&gt;--&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>loggers</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>configuration</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>ç¼–å†™æµ‹è¯•ä»£ç å¹¶æµ‹è¯•</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">import</span> <span class="token import"><span class="token namespace">lombok<span class="token punctuation">.</span>extern<span class="token punctuation">.</span>slf4j<span class="token punctuation">.</span></span><span class="token class-name">Slf4j</span></span><span class="token punctuation">;</span> <span class="token comment">// @Slf4j æ³¨è§£ä¾èµ–åŒ…</span>

<span class="token annotation punctuation">@Slf4j</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">LogTest</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Test</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">testLog4j2</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        log<span class="token punctuation">.</span><span class="token function">trace</span><span class="token punctuation">(</span><span class="token string">&quot;trace1&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        log<span class="token punctuation">.</span><span class="token function">debug</span><span class="token punctuation">(</span><span class="token string">&quot;debug1&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        log<span class="token punctuation">.</span><span class="token function">warn</span><span class="token punctuation">(</span><span class="token string">&quot;warn1&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;info1&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        log<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token string">&quot;error1&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="custom-container info"><p class="custom-container-title">çŸ¥è¯†ç‚¹</p><p>1ã€<strong>SLF4J</strong> ä¸ºç®€å•æ—¥å¿—é—¨é¢ï¼Œæ˜¯æ—¥å¿—æ¡†æ¶çš„æŠ½è±¡ï¼Œæ˜¯å¯¹æ‰€æœ‰æ—¥å¿—æ¡†æ¶åˆ¶å®šçš„ä¸€ç§è§„èŒƒã€æ ‡å‡†ã€æ¥å£ï¼Œå¹¶ä¸æ˜¯ä¸€ä¸ªæ¡†æ¶çš„å…·ä½“çš„å®ç°ï¼Œå› ä¸ºæ¥å£å¹¶ä¸èƒ½ç‹¬ç«‹ä½¿ç”¨ï¼Œå®ƒéœ€è¦å’Œå…·ä½“çš„æ—¥å¿—æ¡†æ¶æ¥é…åˆä½¿ç”¨</p><p>2ã€<strong>Log4j2</strong> æ˜¯æ—¥å¿—å®ç°ï¼ŒSLF4J + Log4j2 ä½œä¸ºç»Ÿä¸€æ—¥å¿—å¤„ç†çš„æ–¹å¼çš„å¥½å¤„åœ¨äºï¼Œå¦‚æœé¡¹ç›®ä¸­å¸Œæœ›ä½¿ç”¨åˆ°å…¶å®ƒæ—¥å¿—å®ç°ï¼ˆå¦‚ Logbackï¼‰ï¼Œæ›´æ¢æ—¥å¿—æ¡†æ¶æ—¶å¯ä»¥ä¸æ”¹åŠ¨ä»£ç ï¼Œåªéœ€è¦æŠŠä¾èµ–çš„ jar åŒ…æ›¿æ¢æ‰å°±å¯ä»¥äº†ã€‚</p><p>3ã€æ³¨è§£<code>@Slf4j</code>å¯ä»¥æ›¿ä»£ä»¥ä¸‹ä»£ç ï¼š</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">private</span>  <span class="token keyword">final</span> <span class="token class-name">Logger</span> logger <span class="token operator">=</span> <span class="token class-name">LoggerFactory</span><span class="token punctuation">.</span><span class="token function">getLogger</span><span class="token punctuation">(</span>å½“å‰ç±»å<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>ä½¿ç”¨æ³¨è§£<code>@Slf4j</code>æ—¶æˆ‘ä»¬éœ€è¦åœ¨ pom.xml æ–‡ä»¶ä¸­åŠ å…¥ Lombok ä¾èµ–ï¼š</p><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code><span class="token comment">&lt;!--Lombok--&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.projectlombok<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
 <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>lombok<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></div><p>æµ‹è¯•ç»“æœï¼š</p><p><img src="https://eduimage1.oss-cn-beijing.aliyuncs.com/img/202203130908788.png" alt="image-20220313090845627" loading="lazy"></p></li></ol><p>å‚è€ƒæ–‡ç« ï¼š</p><ul><li><a href="https://segmentfault.com/a/1190000037598528" target="_blank" rel="noopener noreferrer">ä¸€ç¯‡æ–‡ç« ææ‡‚Slf4jå’ŒLog4j2<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li><li><a href="https://segmentfault.com/a/1190000015568449" target="_blank" rel="noopener noreferrer">SpringBooté›†æˆslf4j+log4j2<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li><li><a href="https://www.jianshu.com/p/d13c2e50a89c" target="_blank" rel="noopener noreferrer">LOG4J2 å®Œæ•´é…ç½®è¯¦è§£<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li><li><a href="https://cloud.tencent.com/developer/article/1383510" target="_blank" rel="noopener noreferrer">webé¡¹ç›®ä¸­å¦‚ä½•é€‰æ‹©æ—¥å¿—ç»„ä»¶ï¼ˆSLF4Jã€Log4J2ã€logbackï¼‰<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li></ul><h2 id="é˜¿é‡Œäº‘ossæ–‡ä»¶å­˜å‚¨" tabindex="-1"><a class="header-anchor" href="#é˜¿é‡Œäº‘ossæ–‡ä»¶å­˜å‚¨" aria-hidden="true">#</a> é˜¿é‡Œäº‘OSSæ–‡ä»¶å­˜å‚¨</h2><div class="custom-container tip"><p class="custom-container-title">OSSæ¦‚å¿µ</p><p>OSSï¼ˆObject Storage Serviceï¼‰æ˜¯é˜¿é‡Œäº‘æä¾›çš„ä¸€ç§ Restful å¯¹è±¡å­˜å‚¨æœåŠ¡ï¼Œå¯ä»¥åœ¨ä»»ä½•åº”ç”¨ã€ä»»ä½•æ—¶é—´ã€ä»»ä½•åœ°ç‚¹å­˜å‚¨å’Œè®¿é—®ä»»æ„ç±»å‹çš„æ•°æ®ã€‚</p></div><p>æˆ‘ä»¬æ–°å»ºä¸€ä¸ª SpringBoot é¡¹ç›® <code>springboot-oss-uploadfile</code>ï¼Œæ¥æ•´åˆé˜¿é‡Œäº‘æ–‡ä»¶ä¸Šä¼ åŠŸèƒ½ï¼Œé¡¹ç›®ç¯å¢ƒï¼šJDK17ï¼ŒSpringBoot 2.6.4ï¼Œé¡¹ç›®ç›®å½•ç»“æ„å¦‚ä¸‹ï¼š</p><img src="https://eduimage1.oss-cn-beijing.aliyuncs.com/img/202203171554428.png" alt="image-20220317155457344" width="400"><p><strong>é˜¿é‡Œäº‘æ–‡ä»¶ä¸Šä¼ ä»£ç å®ç°æ­¥éª¤å¦‚ä¸‹</strong>ï¼š</p><ol><li><p>ç™»å½•é˜¿é‡Œäº‘ï¼Œå¼€é€š OSS æœåŠ¡ï¼Œåˆ›å»ºæ–°çš„ Bucketï¼Œä¿å­˜ä½  Bucket çš„ Endpointï¼ˆåœ°åŸŸèŠ‚ç‚¹ï¼‰</p><p><img src="https://eduimage1.oss-cn-beijing.aliyuncs.com/img/202203170950300.png" alt="image-20220317095004967" loading="lazy"></p><p>ç‚¹å‡»é¡µé¢å³ä¸Šè§’å¤´åƒï¼Œé€‰æ‹© AccessKey ç®¡ç†ï¼Œåˆ›å»ºä½ çš„ AccessKeyï¼Œå¹¶ä¿å­˜ä½ çš„ <code>AccessKey ID</code> å’Œ <code>AccessKey Secret</code></p><div class="custom-container tip"><p class="custom-container-title">Tips</p><p>1ã€Endpointï¼šOSSå¯¹å¤–æœåŠ¡çš„è®¿é—®åŸŸå</p><p>2ã€Bucketï¼šå­˜å‚¨ç©ºé—´ï¼Œç”¨äºå­˜å‚¨å¯¹è±¡(Object)çš„å®¹å™¨</p><p>3ã€AccessKey ID å’Œ AccessKey Secretï¼šè®¿é—®é˜¿é‡Œäº‘ API çš„å¯†é’¥ï¼Œå…·æœ‰è¯¥è´¦æˆ·å®Œå…¨çš„æƒé™ï¼ŒOSS é€šè¿‡ä½¿ç”¨ AccessKey ID å’ŒAccessKey Secret å¯¹ç§°åŠ å¯†çš„æ–¹æ³•æ¥éªŒè¯æŸä¸ªè¯·æ±‚çš„å‘é€è€…èº«ä»½</p></div></li><li><p>åˆ›å»º SpringBoot é¡¹ç›®ï¼Œç¼–å†™ä»£ç </p><p>é…ç½®æ–‡ä»¶<code>application.properties</code>å†…å®¹ï¼š</p><div class="language-properties line-numbers-mode" data-ext="properties"><pre class="language-properties"><code><span class="token comment">#é˜¿é‡Œäº‘Oss</span>
<span class="token key attr-name">aliyun.oss.endpoint</span><span class="token punctuation">=</span><span class="token value attr-value">ä½ åˆ›å»ºçš„Bucketçš„è®¿é—®åŸŸå</span>
<span class="token key attr-name">aliyun.oss.accessKeyId</span><span class="token punctuation">=</span><span class="token value attr-value">ä½ çš„AccessKey ID</span>
<span class="token key attr-name">aliyun.oss.accessKeySecret</span><span class="token punctuation">=</span><span class="token value attr-value">ä½ çš„AccessKey Secret</span>
<span class="token key attr-name">aliyun.oss.bucketName</span><span class="token punctuation">=</span><span class="token value attr-value">ä½ åˆ›å»ºçš„Bucket</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><code>AliyunOSSConfigConstant</code> ç±»è¯»å–é…ç½®æ–‡ä»¶å†…å®¹ï¼š</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Configuration</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">AliyunOSSConfigConstant</span> <span class="token keyword">implements</span> <span class="token class-name">InitializingBean</span> <span class="token punctuation">{</span>
    <span class="token comment">// è¯»å–é…ç½®æ–‡ä»¶</span>
    <span class="token annotation punctuation">@Value</span><span class="token punctuation">(</span><span class="token string">&quot;${aliyun.oss.endpoint}&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> endpoint<span class="token punctuation">;</span>
    <span class="token annotation punctuation">@Value</span><span class="token punctuation">(</span><span class="token string">&quot;${aliyun.oss.accessKeyId}&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> keyid<span class="token punctuation">;</span>
    <span class="token annotation punctuation">@Value</span><span class="token punctuation">(</span><span class="token string">&quot;${aliyun.oss.accessKeySecret}&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> keysecret<span class="token punctuation">;</span>
    <span class="token annotation punctuation">@Value</span><span class="token punctuation">(</span><span class="token string">&quot;${aliyun.oss.bucketName}&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> bucketname<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">String</span> <span class="token constant">END_POINT</span><span class="token punctuation">;</span> <span class="token comment">// OSSå¯¹å¤–æœåŠ¡çš„è®¿é—®åŸŸå</span>
    <span class="token comment">// OSSé€šè¿‡ä½¿ç”¨AccessKeyIdå’ŒAccessKeySecretå¯¹ç§°åŠ å¯†çš„æ–¹æ³•æ¥éªŒè¯æŸä¸ªè¯·æ±‚çš„å‘é€è€…èº«ä»½</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">String</span> <span class="token constant">ACCESS_KEYID</span><span class="token punctuation">;</span> <span class="token comment">//AccessKey ID</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">String</span> <span class="token constant">ACCESS_KEYSECRET</span><span class="token punctuation">;</span> <span class="token comment">//Access Key Secret</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">String</span> <span class="token constant">BUCKET_NAME</span><span class="token punctuation">;</span> <span class="token comment">// å­˜å‚¨ç©ºé—´, ç”¨äºå­˜å‚¨å¯¹è±¡(Object)çš„å®¹å™¨</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">afterPropertiesSet</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
        <span class="token constant">END_POINT</span> <span class="token operator">=</span> endpoint<span class="token punctuation">;</span>
        <span class="token constant">ACCESS_KEYID</span> <span class="token operator">=</span> keyid<span class="token punctuation">;</span>
        <span class="token constant">ACCESS_KEYSECRET</span> <span class="token operator">=</span> keysecret<span class="token punctuation">;</span>
        <span class="token constant">BUCKET_NAME</span> <span class="token operator">=</span> bucketname<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p><code>Service</code>å±‚å®šä¹‰å®ç°ä¸Šä¼ æ–¹æ³•æ¥å£ <code>OssFileService</code> ä¸å®ç°ç±» <code>OssFileServiceImpl</code>ï¼š</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">OssFileService</span> <span class="token punctuation">{</span>
    <span class="token doc-comment comment">/**
     * æ–‡ä»¶ä¸Šä¼ åˆ°é˜¿é‡Œäº‘
     * <span class="token keyword">@param</span> <span class="token parameter">file</span>
     * <span class="token keyword">@return</span>
     */</span>
    <span class="token class-name">String</span> <span class="token function">upload</span><span class="token punctuation">(</span><span class="token class-name">MultipartFile</span> file<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Slf4j</span>
<span class="token annotation punctuation">@Service</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">OssFileServiceImpl</span> <span class="token keyword">implements</span> <span class="token class-name">OssFileService</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">upload</span><span class="token punctuation">(</span><span class="token class-name">MultipartFile</span> file<span class="token punctuation">)</span> <span class="token punctuation">{</span>

        <span class="token class-name">String</span> bucketName <span class="token operator">=</span> <span class="token class-name">AliyunOSSConfigConstant</span><span class="token punctuation">.</span><span class="token constant">BUCKET_NAME</span><span class="token punctuation">;</span>
        <span class="token class-name">String</span> endpoint <span class="token operator">=</span> <span class="token class-name">AliyunOSSConfigConstant</span><span class="token punctuation">.</span><span class="token constant">END_POINT</span><span class="token punctuation">;</span>
        <span class="token class-name">String</span> accessKeyId <span class="token operator">=</span> <span class="token class-name">AliyunOSSConfigConstant</span><span class="token punctuation">.</span><span class="token constant">ACCESS_KEYID</span><span class="token punctuation">;</span>
        <span class="token class-name">String</span> accessKeySecret <span class="token operator">=</span> <span class="token class-name">AliyunOSSConfigConstant</span><span class="token punctuation">.</span><span class="token constant">ACCESS_KEYSECRET</span><span class="token punctuation">;</span>
        <span class="token class-name">String</span> uploadUrl<span class="token punctuation">;</span> <span class="token comment">// ä¸Šä¼ URL</span>

        <span class="token comment">// åˆ›å»ºOSSClientå®ä¾‹</span>
        <span class="token class-name">OSS</span> ossClient <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">OSSClientBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span>endpoint<span class="token punctuation">,</span> accessKeyId<span class="token punctuation">,</span> accessKeySecret<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token comment">//åˆ¤æ–­osså®ä¾‹æ˜¯å¦å­˜åœ¨, ä¸å­˜åœ¨åˆ™åˆ›å»º</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>ossClient<span class="token punctuation">.</span><span class="token function">doesBucketExist</span><span class="token punctuation">(</span>bucketName<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token comment">//åˆ›å»ºbucket</span>
                ossClient<span class="token punctuation">.</span><span class="token function">createBucket</span><span class="token punctuation">(</span>bucketName<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token comment">// osså®ä¾‹çš„è®¿é—®æƒé™:å…¬å…±è¯»</span>
                ossClient<span class="token punctuation">.</span><span class="token function">setBucketAcl</span><span class="token punctuation">(</span>bucketName<span class="token punctuation">,</span> <span class="token class-name">CannedAccessControlList<span class="token punctuation">.</span>PublicRead</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token comment">// ä¸Šä¼ æ–‡ä»¶å­—èŠ‚è¾“å…¥æµ</span>
            <span class="token class-name">InputStream</span> inputStream <span class="token operator">=</span> file<span class="token punctuation">.</span><span class="token function">getInputStream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token comment">// æ„å»ºæ—¥æœŸè·¯å¾„</span>
            <span class="token class-name">String</span> fileUrl <span class="token operator">=</span> file<span class="token punctuation">.</span><span class="token function">getOriginalFilename</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// è·å–æ–‡ä»¶åç§°</span>
            <span class="token class-name">String</span> uuid <span class="token operator">=</span> <span class="token constant">UUID</span><span class="token punctuation">.</span><span class="token function">randomUUID</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token string">&quot;-&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// æ‹¼æ¥uuid</span>
            <span class="token class-name">String</span> dateStr <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">DateTime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token string">&quot;yyyy/MM/dd&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// æ‹¼æ¥æ—¶é—´</span>
            fileUrl <span class="token operator">=</span> dateStr <span class="token operator">+</span> <span class="token string">&quot;/&quot;</span> <span class="token operator">+</span> uuid <span class="token operator">+</span> fileUrl<span class="token punctuation">;</span>

            <span class="token comment">// è°ƒç”¨ossè¿›è¡Œä¸Šä¼ </span>
            <span class="token comment">// å‚æ•°åˆ†åˆ«ä¸º BucketName, ä¸Šä¼ åˆ°ossæ–‡ä»¶çš„è·¯å¾„å’Œåç§°, ç¬¬ä¸‰ä¸ªæ–‡ä»¶è¾“å…¥æµ</span>
            ossClient<span class="token punctuation">.</span><span class="token function">putObject</span><span class="token punctuation">(</span>bucketName<span class="token punctuation">,</span> fileUrl<span class="token punctuation">,</span> inputStream<span class="token punctuation">)</span><span class="token punctuation">;</span>

            uploadUrl <span class="token operator">=</span> <span class="token string">&quot;http://&quot;</span> <span class="token operator">+</span> bucketName <span class="token operator">+</span> <span class="token string">&quot;.&quot;</span> <span class="token operator">+</span> endpoint <span class="token operator">+</span> <span class="token string">&quot;/&quot;</span> <span class="token operator">+</span> fileUrl<span class="token punctuation">;</span>
            <span class="token keyword">return</span> uploadUrl<span class="token punctuation">;</span>

        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">OSSException</span> oe<span class="token punctuation">)</span> <span class="token punctuation">{</span> 
            log<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>oe<span class="token punctuation">.</span><span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">ClientException</span> ce<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            log<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>ce<span class="token punctuation">.</span><span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">IOException</span> ie<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            log<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span>ie<span class="token punctuation">.</span><span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">finally</span> <span class="token punctuation">{</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>ossClient <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment">// æœ€åè¦å…³é—­ ossClient</span>
                ossClient<span class="token punctuation">.</span><span class="token function">shutdown</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Controllerå±‚å®ç°æ¥å£ï¼š</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@RestController</span>
<span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/oss/file&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">OssFileController</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Autowired</span>
    <span class="token keyword">private</span> <span class="token class-name">OssFileService</span> fileService<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@PostMapping</span><span class="token punctuation">(</span><span class="token string">&quot;upload&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">upload</span><span class="token punctuation">(</span><span class="token annotation punctuation">@RequestParam</span><span class="token punctuation">(</span><span class="token string">&quot;file&quot;</span><span class="token punctuation">)</span> <span class="token class-name">MultipartFile</span> file<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">String</span> uploadUrl <span class="token operator">=</span> fileService<span class="token punctuation">.</span><span class="token function">upload</span><span class="token punctuation">(</span>file<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> uploadUrl<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>æµ‹è¯•ä¸Šä¼ åŠŸèƒ½ï¼Œä½¿ç”¨å·¥å…· ApiPost è¿›è¡Œæ¥å£æµ‹è¯•</p><p>æµ‹è¯•ç»“æœï¼Œä¸Šä¼ æˆåŠŸä¹‹åè¿”å›ä¸Šä¼  ULRï¼š</p><p><img src="https://eduimage1.oss-cn-beijing.aliyuncs.com/img/202203171512858.png" alt="image-20220317151226674" loading="lazy"></p></li></ol><p>å‚è€ƒæ–‡ç« ï¼š</p><ul><li><a href="https://segmentfault.com/a/1190000017273629" target="_blank" rel="noopener noreferrer">SpringBootæ•´åˆé˜¿é‡Œäº‘OSSå­˜å‚¨æœåŠ¡<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li><li><a href="https://segmentfault.com/a/1190000020963346" target="_blank" rel="noopener noreferrer">é˜¿é‡Œäº‘OSSæ–‡ä»¶ä¸Šä¼ ï¼ˆåˆ†é¡µä¸Šä¼ ï¼Œæ–­ç‚¹ç»­ä¼ ï¼‰<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li><li><a href="https://segmentfault.com/a/1190000023698805" target="_blank" rel="noopener noreferrer">SpringBoot OSSæ•´åˆå…¨è¿‡ç¨‹<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li></ul><h2 id="easyexcel-è¯»å–-excel-æ–‡ä»¶" tabindex="-1"><a class="header-anchor" href="#easyexcel-è¯»å–-excel-æ–‡ä»¶" aria-hidden="true">#</a> EasyExcel è¯»å– Excel æ–‡ä»¶</h2><div class="custom-container tip"><p class="custom-container-title">Tips</p><p>EasyExcel æ˜¯é˜¿é‡Œå·´å·´å¼€æºçš„ä¸€ä¸ª excel å¤„ç†æ¡†æ¶ï¼Œä½¿ç”¨ EasyExcel å¯ä»¥é«˜æ•ˆçš„å°† Excel è¡¨ä¸­çš„æ•°æ®å¯¼å…¥åˆ°æ•°æ®åº“ä¸­</p></div><p>åˆ›å»º SpringBoot é¡¹ç›® <code>springboot-easyexcel</code>ï¼Œè¯»å–â€œç”¨æˆ·åˆ†ç±».xlsxâ€ Excel è¡¨ä¸­çš„æ•°æ®åˆ°æ•°æ®åº“Userè¡¨ï¼Œé¡¹ç›®ç¯å¢ƒä¸º JDK 17ï¼ŒSpringBoot 2.6.4</p><p><img src="https://eduimage1.oss-cn-beijing.aliyuncs.com/img/image-20220409084517069.png" alt="image-20220409084517069" loading="lazy"></p><p>ä»£ç å®ç°å¦‚ä¸‹ï¼š</p><ol><li><p>å¯¼å…¥é¡¹ç›®æ‰€éœ€ä¾èµ–</p><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code><span class="token comment">&lt;!--mysql--&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>mysql<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>mysql-connector-java<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>

<span class="token comment">&lt;!--MybatisPlus--&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.baomidou<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>mybatis-plus-boot-starter<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>3.5.1<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>

<span class="token comment">&lt;!--Lombok--&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.projectlombok<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>lombok<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>ç¼–å†™é¡¹ç›®æ‰€éœ€ä»£ç </p><p><strong>å®ä½“ç±» User</strong>ï¼š</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Data</span>
<span class="token annotation punctuation">@TableName</span><span class="token punctuation">(</span><span class="token string">&quot;user&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">User</span> <span class="token punctuation">{</span>

    <span class="token comment">// id æ˜¯è‡ªå¢çš„,å› æ­¤ä¸éœ€è¦ä½¿ç”¨@ExcelPropertyæ³¨è§£</span>
    <span class="token keyword">private</span> <span class="token class-name">Long</span> id<span class="token punctuation">;</span>
    <span class="token annotation punctuation">@ExcelProperty</span><span class="token punctuation">(</span>index <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> name<span class="token punctuation">;</span>
    <span class="token annotation punctuation">@ExcelProperty</span><span class="token punctuation">(</span>index <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">Integer</span> age<span class="token punctuation">;</span>
    <span class="token annotation punctuation">@ExcelProperty</span><span class="token punctuation">(</span>index <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> email<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="custom-container tip"><p class="custom-container-title">Tips</p><p>éœ€è¦ä½¿ç”¨æ³¨è§£ <code>@ExcelProperty</code>å’Œ Excel è¡¨éœ€è¦è¯»å–çš„åˆ—å¯¹åº”ï¼Œ<code>index = 0</code>è¡¨ç¤ºç¬¬ä¸€åˆ—ï¼Œ<code>index = 1</code>è¡¨ç¤ºç¬¬äºŒåˆ—ï¼Œä»¥æ­¤ç±»æ¨</p></div><p><strong>Service æ¥å£åŠæ–¹æ³•</strong>ï¼š</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">UserService</span> <span class="token keyword">extends</span> <span class="token class-name">IService</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">User</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">{</span>
    <span class="token keyword">void</span> <span class="token function">batchImportUser</span><span class="token punctuation">(</span><span class="token class-name">MultipartFile</span> file<span class="token punctuation">,</span> <span class="token class-name">UserService</span> userService<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token annotation punctuation">@Service</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">UserServiceImpl</span> <span class="token keyword">extends</span> <span class="token class-name">ServiceImpl</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">UserMapper</span><span class="token punctuation">,</span> <span class="token class-name">User</span><span class="token punctuation">&gt;</span></span> <span class="token keyword">implements</span> <span class="token class-name">UserService</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">batchImportUser</span><span class="token punctuation">(</span><span class="token class-name">MultipartFile</span> file<span class="token punctuation">,</span> <span class="token class-name">UserService</span> userService<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token class-name">InputStream</span> is <span class="token operator">=</span> file<span class="token punctuation">.</span><span class="token function">getInputStream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">// read(InputStream inputStream, Class head, ReadListener readListener)</span>
            <span class="token comment">// inputStream è¾“å…¥æµ; head éœ€è¦å¯¼å…¥excelè¡¨å¯¹åº”çš„å®ä½“ç±»; readListener äº‹ä»¶ç›‘å¬å™¨,ç”¨æ¥ç›‘å¬å¤„ç†è¯»å–åˆ°çš„æ¯ä¸€æ¡æ•°æ®,è¯»å–excelè¡¨ç¬¬ä¸€ä¸ªsheet</span>
            <span class="token class-name">EasyExcel</span><span class="token punctuation">.</span><span class="token function">read</span><span class="token punctuation">(</span>is<span class="token punctuation">,</span> <span class="token class-name">User</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">UserExcelListener</span><span class="token punctuation">(</span>userService<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">sheet</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">doRead</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">IOException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="custom-container info"><p class="custom-container-title">Info</p><p><code>UserServiceImpl</code> ç±»ä¸­è°ƒç”¨ <code>EasyExcel.read(...)</code> æ–¹æ³•æ¥è¯»å– Excel è¡¨ä¸­æ•°æ®ï¼Œéœ€è¦è‡ªå®šä¹‰ä¸€ä¸ª Excel ç›‘å¬å™¨å¹¶å®ç° Excel çš„åˆ†æç›‘å¬å™¨æ¥å£ <code>AnalysisEventListener</code></p></div></li><li><p>ç¼–å†™ Excel ç›‘å¬å™¨ç±» <code>UserExcelListener</code>ä»£ç </p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">UserExcelListener</span> <span class="token keyword">extends</span> <span class="token class-name">AnalysisEventListener</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">User</span><span class="token punctuation">&gt;</span></span> <span class="token punctuation">{</span>

    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">Logger</span> <span class="token constant">LOGGER</span> <span class="token operator">=</span> <span class="token class-name">LoggerFactory</span><span class="token punctuation">.</span><span class="token function">getLogger</span><span class="token punctuation">(</span><span class="token class-name">UserExcelListener</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token class-name">UserService</span> userService<span class="token punctuation">;</span>

    <span class="token doc-comment comment">/**
     * æ¯éš”5æ¡å­˜å‚¨æ•°æ®åº“ï¼Œå®é™…ä½¿ç”¨ä¸­å¯ä»¥3000æ¡ï¼Œç„¶åæ¸…ç†list ï¼Œæ–¹ä¾¿å†…å­˜å›æ”¶
     */</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">int</span> <span class="token constant">BATCH_COUNT</span> <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span>
    <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">User</span><span class="token punctuation">&gt;</span></span> list <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">User</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token class-name">UserExcelListener</span><span class="token punctuation">(</span><span class="token class-name">UserService</span> userService<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>userService <span class="token operator">=</span> userService<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token class-name">UserExcelListener</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">invoke</span><span class="token punctuation">(</span><span class="token class-name">User</span> user<span class="token punctuation">,</span> <span class="token class-name">AnalysisContext</span> analysisContext<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token constant">LOGGER</span><span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;è§£æåˆ°ä¸€æ¡æ•°æ®&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        list<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>user<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// è¾¾åˆ°BATCH_COUNTäº†ï¼Œéœ€è¦å»å­˜å‚¨ä¸€æ¬¡æ•°æ®åº“ï¼Œé˜²æ­¢æ•°æ®å‡ ä¸‡æ¡æ•°æ®åœ¨å†…å­˜ï¼Œå®¹æ˜“OOM</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>list<span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">&gt;=</span> <span class="token constant">BATCH_COUNT</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment">// æ‰¹é‡å°†æ•°æ®å­˜å‚¨åœ¨æ•°æ®åº“ä¸­</span>
            userService<span class="token punctuation">.</span><span class="token function">saveBatch</span><span class="token punctuation">(</span>list<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token constant">LOGGER</span><span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;å­˜å‚¨æ•°æ®åº“æˆåŠŸï¼&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">// å­˜å‚¨å®Œæˆæ¸…ç† list</span>
            list<span class="token punctuation">.</span><span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

    <span class="token punctuation">}</span>

    <span class="token doc-comment comment">/**
     * æ‰€æœ‰æ•°æ®è§£æå®Œæˆäº† éƒ½ä¼šæ¥è°ƒç”¨
     * <span class="token keyword">@param</span> <span class="token parameter">analysisContext</span>
     */</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">doAfterAllAnalysed</span><span class="token punctuation">(</span><span class="token class-name">AnalysisContext</span> analysisContext<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// è¿™é‡Œä¹Ÿè¦ä¿å­˜æ•°æ®ï¼Œç¡®ä¿æœ€åé—ç•™çš„æ•°æ®ä¹Ÿå­˜å‚¨åˆ°æ•°æ®åº“</span>
        userService<span class="token punctuation">.</span><span class="token function">saveBatch</span><span class="token punctuation">(</span>list<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token constant">LOGGER</span><span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;æ‰€æœ‰æ•°æ®è§£æå®Œæˆï¼&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>ç¼–å†™ Controller ä»£ç å¹¶ä½¿ç”¨ ApiPost è¿›è¡Œæ¥å£æµ‹è¯•</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@RestController</span>
<span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/user&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">UserController</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Autowired</span>
    <span class="token keyword">private</span> <span class="token class-name">UserService</span> userService<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@PostMapping</span><span class="token punctuation">(</span><span class="token string">&quot;addSubject&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">addCourseSubject</span><span class="token punctuation">(</span><span class="token annotation punctuation">@RequestParam</span><span class="token punctuation">(</span><span class="token string">&quot;file&quot;</span><span class="token punctuation">)</span> <span class="token class-name">MultipartFile</span> file<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">StaticComponentContainer<span class="token punctuation">.</span>Modules</span><span class="token punctuation">.</span><span class="token function">exportAllToAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// è§£å†³JDK17ä¸easyexcelæŠ¥é”™é—®é¢˜</span>
        userService<span class="token punctuation">.</span><span class="token function">batchImportUser</span><span class="token punctuation">(</span>file<span class="token punctuation">,</span> userService<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token string">&quot;OK&quot;</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="custom-container danger"><p class="custom-container-title">Warning</p><p>JDK17 ç¯å¢ƒä¸‹ä½¿ç”¨ EasyExcel ä¼šå‡ºç° <code>Caused by: java.lang.reflect.InaccessibleObjectException</code> å¼‚å¸¸ä¿¡æ¯ï¼Œéœ€è¦åœ¨ pom æ–‡ä»¶å¼•å…¥ä»¥ä¸‹ä¾èµ–ï¼š</p><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.burningwave<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>core<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>9.5.2<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å¹¶ä¸”å†™å…¥ä»¥ä¸‹ä»£ç ï¼š</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token comment">// è§£å†³JDK17ä¸easyexcelæŠ¥é”™é—®é¢˜</span>
<span class="token class-name">StaticComponentContainer<span class="token punctuation">.</span>Modules</span><span class="token punctuation">.</span><span class="token function">exportAllToAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div></div></li></ol><h2 id="nginx-é…ç½®åå°å¤šæœåŠ¡å™¨" tabindex="-1"><a class="header-anchor" href="#nginx-é…ç½®åå°å¤šæœåŠ¡å™¨" aria-hidden="true">#</a> nginx é…ç½®åå°å¤šæœåŠ¡å™¨</h2><div class="custom-container info"><p class="custom-container-title">Info</p><p>ä½¿ç”¨ SpringBoot + Vue æŠ€æœ¯æ ˆå¼€å‘çš„å‰åç«¯åˆ†ç¦»çš„é¡¹ç›®ï¼Œå¯ä»¥ä½¿ç”¨ nginx åå‘ä»£ç†æ¥é…ç½®åå°å¤šå°æœåŠ¡å™¨</p></div><p>ä»¥æœ¬æ–‡é¡¹ç›®eduå’Œedu-adminä¸ºä¾‹ï¼Œä½¿ç”¨nginxé…ç½®åå°å¤šå°æœåŠ¡å™¨è¿‡ç¨‹å¦‚ä¸‹ï¼š</p><ol><li><p>ä¸‹è½½å®‰è£… nginx</p><!----></li><li><p>ä¿®æ”¹ nginx é…ç½®æ–‡ä»¶å†…å®¹</p><!----><p>åœ¨ <code>http { }</code> å†…æ–°æ·»åŠ ä¸€ä¸ª <code>server{ }</code> ï¼Œç”¨æ¥é…ç½®é¡¹ç›® eduä¸­å¯¹åº”çš„å¾®æœåŠ¡æœåŠ¡å™¨åœ°å€ï¼Œä¿®æ”¹åçš„é…ç½®æ–‡ä»¶å†…å®¹å¦‚ä¸‹ï¼š</p><div class="language-nginx line-numbers-mode" data-ext="nginx"><pre class="language-nginx"><code><span class="token comment"># httpæœåŠ¡å™¨é…ç½®</span>
<span class="token directive"><span class="token keyword">http</span></span> <span class="token punctuation">{</span>
  <span class="token comment"># è™šæ‹Ÿä¸»æœºçš„é…ç½®</span>
  <span class="token directive"><span class="token keyword">server</span></span> <span class="token punctuation">{</span>
      <span class="token comment"># ç›‘å¬ç«¯å£ï¼Œnginx é»˜è®¤ä¸º 80ï¼Œå¯ä»¥è‡ªè¡Œä¿®æ”¹</span>
    	<span class="token directive"><span class="token keyword">listen</span>       <span class="token number">81</span></span><span class="token punctuation">;</span>
      <span class="token comment"># åŸŸåï¼Œå¯ä»¥æœ‰å¤šä¸ªï¼Œç”¨ç©ºæ ¼éš”å¼€</span>
    	<span class="token directive"><span class="token keyword">server_name</span>  localhost</span><span class="token punctuation">;</span>
    	<span class="token comment"># ...</span>
  <span class="token punctuation">}</span>
  <span class="token comment"># ...</span>
  <span class="token comment"># ä»¥ä¸‹å†…å®¹ä¸ºæ–°å¢</span>
  <span class="token comment"># é¡¹ç›®eduæœåŠ¡</span>
  <span class="token directive"><span class="token keyword">server</span></span> <span class="token punctuation">{</span>
        <span class="token directive"><span class="token keyword">listen</span>       <span class="token number">8888</span></span><span class="token punctuation">;</span>
        <span class="token directive"><span class="token keyword">server_name</span>  localhost</span><span class="token punctuation">;</span>

        <span class="token comment"># edu åŒ¹é…è¯·æ±‚ URL</span>
        <span class="token comment"># http://localhost:8080/edu/...</span>
        <span class="token directive"><span class="token keyword">location</span> ~/edu/</span> <span class="token punctuation">{</span> <span class="token comment"># å½“å®¢æˆ·ç«¯è¯·æ±‚çš„ URL æœ‰ /edu/ æ—¶</span>
      			// è¯·æ±‚ä»£ç†æœåŠ¡ç«¯å£
            <span class="token directive"><span class="token keyword">proxy_pass</span> http://localhost:8001</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token comment"># http://localhost:8080/oss/...</span>
        <span class="token directive"><span class="token keyword">location</span> ~/oss/</span> <span class="token punctuation">{</span> <span class="token comment"># å½“å®¢æˆ·ç«¯è¯·æ±‚çš„ URL æœ‰ /oss/ æ—¶</span>
      			// è¯·æ±‚ä»£ç†æœåŠ¡ç«¯å£
            <span class="token directive"><span class="token keyword">proxy_pass</span> http://localhost:8002</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> 
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="custom-container tip"><p class="custom-container-title">Tips</p><p>å½“åç«¯æœ‰å¤šä¸ªæœåŠ¡æ—¶ï¼Œå¯ä»¥é…ç½®å¤šä¸ª location</p></div></li><li><p>å¯åŠ¨ nginx</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>nginx
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><div class="custom-container warning"><p class="custom-container-title">Note</p><p>æ¯æ¬¡ä¿®æ”¹å®Œ nginx é…ç½®æ–‡ä»¶ä¹‹åï¼Œéœ€è¦é‡å¯ nginxï¼Œé‡å¯å‘½ä»¤ä¸ºï¼š</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>nginx <span class="token parameter variable">-s</span> reload
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div></div></li><li><p>ä¿®æ”¹åç«¯å‰å°é¡¹ç›®edu-adminæœåŠ¡ç«¯å£ä¸º nginx æ–‡ä»¶é…ç½®çš„ listen æ¥å£ 8888ï¼Œé…ç½®æ–‡ä»¶ä¸º<code>.env.development</code></p><div class="language-text line-numbers-mode" data-ext="text"><pre class="language-text"><code># VUE_APP_BASE_API = &#39;/dev-api&#39;
# ä¿®æ”¹ä¸ºåç«¯ edu-service-edu æœåŠ¡è®¿é—®æ¥å£
VUE_APP_BASE_API = &#39;http://localhost:8888&#39;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="custom-container tip"><p class="custom-container-title">Tips</p><p>å½“åç«¯å‰å°å‘é€ä¸€ä¸ªè¯·æ±‚ï¼Œå¦‚ <code>http://localhost:8888/edu/teacher/listByPageCondition/1/10</code>æ—¶ï¼Œnginx åå‘ä»£ç†ä¼šè¯·æ±‚åç«¯æœåŠ¡ <code>http://localhost:8001/edu/teacher/listByPageCondition/1/10</code>ï¼Œåç«¯æœåŠ¡ç«¯å£é…ç½®åœ¨<code>application.yaml</code>æ–‡ä»¶ï¼š</p><div class="language-yaml line-numbers-mode" data-ext="yml"><pre class="language-yaml"><code><span class="token comment"># æœåŠ¡ç«¯å£</span>
<span class="token key atrule">server</span><span class="token punctuation">:</span>
  <span class="token key atrule">port</span><span class="token punctuation">:</span> <span class="token number">8001</span>

<span class="token key atrule">spring</span><span class="token punctuation">:</span>
  <span class="token comment"># æœåŠ¡åç§°</span>
  <span class="token key atrule">application</span><span class="token punctuation">:</span>
    <span class="token key atrule">name</span><span class="token punctuation">:</span> edu<span class="token punctuation">-</span>service<span class="token punctuation">-</span>edu
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></div></li><li><p>åç«¯ä»£ç è§£å†³è·¨åŸŸé—®é¢˜ï¼Œä½¿ç”¨<code>@CrossOrigin</code>æ³¨è§£</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@RestController</span>
<span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/edu/teacher&quot;</span><span class="token punctuation">)</span>
<span class="token annotation punctuation">@CrossOrigin</span> <span class="token comment">// è§£å†³è·¨åŸŸé—®é¢˜</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">TeacherController</span> <span class="token punctuation">{</span>
		<span class="token annotation punctuation">@ApiOperation</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;æ¡ä»¶æŸ¥è¯¢åˆ†é¡µæ–¹æ³•&quot;</span><span class="token punctuation">)</span>
    <span class="token annotation punctuation">@PostMapping</span><span class="token punctuation">(</span><span class="token string">&quot;listByPageCondition/{current}/{limit}&quot;</span><span class="token punctuation">)</span>
  	<span class="token comment">// åç«¯æœåŠ¡åº”ç”¨æ¥å£ `http://localhost:8001/edu/teacher/listByPageCondition/1/10`ï¼Œ</span>
    <span class="token keyword">public</span> <span class="token class-name">CommonResult</span> <span class="token function">listByPageCondition</span><span class="token punctuation">(</span><span class="token annotation punctuation">@PathVariable</span> <span class="token class-name">Long</span> current<span class="token punctuation">,</span>
                                   <span class="token annotation punctuation">@PathVariable</span> <span class="token class-name">Long</span> limit<span class="token punctuation">,</span>
                                   <span class="token annotation punctuation">@RequestBody</span> <span class="token class-name">TeachQueryVo</span> teachQuery<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// ...çœç•¥</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>æµ‹è¯•</p><p><img src="https://eduimage1.oss-cn-beijing.aliyuncs.com/img/image-20220409203216198.png" alt="image-20220409203216198" loading="lazy"></p></li></ol><h2 id="springboot-ä¸Šä¼ è§†é¢‘åˆ°é˜¿é‡Œäº‘å¹³å°" tabindex="-1"><a class="header-anchor" href="#springboot-ä¸Šä¼ è§†é¢‘åˆ°é˜¿é‡Œäº‘å¹³å°" aria-hidden="true">#</a> SpringBoot ä¸Šä¼ è§†é¢‘åˆ°é˜¿é‡Œäº‘å¹³å°</h2><div class="custom-container info"><p class="custom-container-title">Info</p><p>é˜¿é‡Œäº‘è§†é¢‘ç‚¹æ’­ï¼ˆVODï¼‰æ˜¯é›†éŸ³è§†é¢‘ä¸Šä¼ ã€è‡ªåŠ¨åŒ–è½¬ç å¤„ç†ã€åª’ä½“èµ„æºç®¡ç†ã€åˆ†å‘åŠ é€Ÿäºä¸€ä½“çš„å…¨é“¾è·¯éŸ³è§†é¢‘ç‚¹æ’­æœåŠ¡ã€‚å¯ä»¥æœ‰æ•ˆçš„ä¿éšœè§†é¢‘å†…å®¹çš„å®‰å…¨ï¼Œä¸è¢«ç›—é“¾ã€éæ³•ä¸‹è½½å’Œä¼ æ’­ï¼Œå¹¿æ³›åº”ç”¨åœ¨éŸ³è§†é¢‘ç½‘ç«™ï¼ŒçŸ­è§†é¢‘ï¼Œåœ¨çº¿æ•™è‚²ç­‰åœºæ™¯ã€‚</p></div><p>æ–°å»ºé¡¹ç›® SpringBoot é¡¹ç›® <code>springboot-aliyun-vod</code>ï¼Œé¡¹ç›®ç¯å¢ƒä¸º JDK 17ï¼ŒSpringBoot 2.6.4ï¼Œæ¼”ç¤ºè§†é¢‘ä¸Šä¼ åˆ°é˜¿é‡Œäº‘å¹³å°ï¼Œé˜¿é‡Œäº‘è®¾ç½®æ­¥éª¤å¦‚ä¸‹ï¼š</p><ol><li><p>ç™»é™†é˜¿é‡Œäº‘å®˜ç½‘ï¼Œå®˜ç½‘é¦–é¡µå³ä¸Šè§’è¿›å…¥æ§åˆ¶å°ï¼Œç‚¹å‡»å¤´åƒ-AccessKeyç®¡ç†ï¼Œè·å–é˜¿é‡Œäº‘è®¿é—®å¯†é’¥ï¼Œ<code>AccessKeyId</code>å’Œ<code>AccessKeySecret</code></p><p><img src="https://eduimage1.oss-cn-beijing.aliyuncs.com/img/image-20220412214606032.png" alt="image-20220412214606032" loading="lazy"></p></li><li><p>å¼€é€šé˜¿é‡Œäº‘è§†é¢‘ç‚¹æ’­æœåŠ¡ï¼Œ<a href="https://help.aliyun.com/document_detail/51512.html" target="_blank" rel="noopener noreferrer">å‚è€ƒç½‘å€<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><div class="custom-container warning"><p class="custom-container-title">Note</p><p>ä»…æ¼”ç¤ºè§†é¢‘ä¸Šä¼ åŠŸèƒ½æ— éœ€è¿›è¡ŒåŸŸåæ³¨å†ŒåŠŸèƒ½</p></div></li><li><p>è¿›å…¥è§†é¢‘ç‚¹æ’­æœåŠ¡æ§åˆ¶å°ï¼Œå¼€å¯å­˜å‚¨åœ°å€çŠ¶æ€</p><p><img src="https://eduimage1.oss-cn-beijing.aliyuncs.com/img/image-20220413094429696.png" alt="image-20220413094429696" loading="lazy"></p></li></ol><p>ä¹‹åä¾¿å¯ä»¥ç¼–å†™ä¸Šä¼ ä»£ç ï¼Œå‚è€ƒå®˜ç½‘<a href="https://help.aliyun.com/document_detail/53406.html" target="_blank" rel="noopener noreferrer">Javaä¸Šä¼ SDK<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>ï¼Œæ­¥éª¤å¦‚ä¸‹ï¼š</p><ol><li><p>pom æ–‡ä»¶å¼•å…¥ç›¸å…³ä¾èµ–</p><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code><span class="token comment">&lt;!--é˜¿é‡Œäº‘ oss--&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.aliyun.oss<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>aliyun-sdk-oss<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>3.10.2<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
<span class="token comment">&lt;!--é˜¿é‡Œäº‘è§†é¢‘ç‚¹æ’­æœåŠ¡--&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.aliyun<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>aliyun-java-sdk-core<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>4.5.1<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.aliyun<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>aliyun-java-sdk-vod<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>2.15.11<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
<span class="token comment">&lt;!--Json æ•°æ®è½¬æ¢--&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>org.json<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>json<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>20170516<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.alibaba<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>fastjson<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>1.2.28<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.google.code.gson<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>gson<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>2.8.2<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>Idea-å·¥ç¨‹ç»“æ„-Modulesä¸­æ‰‹åŠ¨å¼•å…¥ä¾èµ–<code>aliyun-java-upload-1.4.14.jar</code>ä¾èµ–</p><p><img src="https://eduimage1.oss-cn-beijing.aliyuncs.com/img/image-20220413100437672.png" alt="image-20220413100437672" loading="lazy"></p><div class="custom-container warning"><p class="custom-container-title">Note</p><p>ç”±äº<code>aliyun-java-upload-1.4.14.jar</code>æš‚æœªå¼€æºï¼Œå› æ­¤å¯ä»¥ä½¿ç”¨ä¸Šè¿°æ–¹å¼å°†å…¶æ‰‹åŠ¨å¼•å…¥åˆ°é¡¹ç›®ä¾èµ–ä¸­ï¼Œä¹‹åå¯ä»¥é€‰æ‹©å°†å…¶ç§»åŠ¨åˆ°å·¥ç¨‹åº“ä¸­æˆ–è€…resourcesæ–‡ä»¶å¤¹ä¸‹ï¼Œé˜²æ­¢å·¥ç¨‹ç§»æ¤æ—¶jaråŒ…ä¸¢å¤±ï¼Œæˆ–è€…å¯ä»¥<a href="https://blog.csdn.net/u012723673/article/details/107390612" target="_blank" rel="noopener noreferrer">åŠ å…¥åˆ°è‡ªå·±æœ¬åœ°Mavenä»“åº“ä¸­<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>ï¼Œåœ¨è¿›è¡ŒMavenä¾èµ–å¼•å…¥</p></div><div class="custom-container danger"><p class="custom-container-title">Warning</p><p>æ­¥éª¤1ã€2ä¸­å¼•å…¥çš„ jar åŒ…ç‰ˆæœ¬è¦æ³¨æ„å¯¹åº”ï¼Œå‚è€ƒ<a href="https://help.aliyun.com/document_detail/53406.html#section-we5-kov-5o0" target="_blank" rel="noopener noreferrer">é›†æˆJavaä¸Šä¼ SDK<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>ï¼Œ<a href="https://help.aliyun.com/document_detail/51992.htm?spm=a2c4g.11186623.0.0.67d44150SLpjlN#title-jq2-fre-l7l" target="_blank" rel="noopener noreferrer">demoç¤ºä¾‹å‚è€ƒ<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p></div></li><li><p>ç¼–å†™<code>application.properties</code>é…ç½®æ–‡ä»¶å†…å®¹</p><div class="language-properties line-numbers-mode" data-ext="properties"><pre class="language-properties"><code><span class="token comment"># æœåŠ¡ç«¯å£</span>
<span class="token key attr-name">server.port</span><span class="token punctuation">=</span><span class="token value attr-value">8003</span>

<span class="token comment"># é˜¿é‡Œäº‘è®¿é—®å¯†é’¥</span>
<span class="token key attr-name">aliyun.vod.file.keyid</span><span class="token punctuation">=</span><span class="token value attr-value">ä½ çš„AccessKeyId</span>
<span class="token key attr-name">aliyun.vod.file.keysecret</span><span class="token punctuation">=</span><span class="token value attr-value">ä½ çš„AccessKeySecret</span>

<span class="token comment"># ä¸Šä¼ å¤§å°é™åˆ¶</span>
<span class="token key attr-name">spring.servlet.multipart.max-file-size</span><span class="token punctuation">=</span><span class="token value attr-value">1024MB</span>
<span class="token key attr-name">spring.servlet.multipart.max-request-size</span><span class="token punctuation">=</span><span class="token value attr-value">1024MB</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>å¸¸é‡é…ç½®ç±»<code>AliyunVodConfigConstant</code>è¯»å–é…ç½®æ–‡ä»¶ <code>AccessKeyId</code>ã€<code>AccessKeySecret</code></p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Configuration</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">AliyunVodConfigConstant</span> <span class="token keyword">implements</span> <span class="token class-name">InitializingBean</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Value</span><span class="token punctuation">(</span><span class="token string">&quot;${aliyun.vod.file.keyid}&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> keyId<span class="token punctuation">;</span>
    <span class="token annotation punctuation">@Value</span><span class="token punctuation">(</span><span class="token string">&quot;${aliyun.vod.file.keysecret}&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> keySecret<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">String</span> <span class="token constant">ACCESS_KEY_ID</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">String</span> <span class="token constant">ACCESS_KEY_SECRET</span><span class="token punctuation">;</span>


    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">afterPropertiesSet</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
        <span class="token constant">ACCESS_KEY_ID</span> <span class="token operator">=</span> keyId<span class="token punctuation">;</span>
        <span class="token constant">ACCESS_KEY_SECRET</span> <span class="token operator">=</span> keySecret<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>è§†é¢‘ç‚¹æ’­å·¥å…·ç±»å¡«å…¥ AccessKey ä¿¡æ¯ï¼Œè¿›è¡Œåˆå§‹åŒ–ï¼Œå‚è€ƒå®˜æ–¹<a href="https://help.aliyun.com/document_detail/61062.html" target="_blank" rel="noopener noreferrer">åˆå§‹åŒ–<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">AliyunVodSDKUtils</span> <span class="token punctuation">{</span>
    <span class="token doc-comment comment">/**
     * å¡«å…¥AccessKeyä¿¡æ¯ï¼Œè¿›è¡Œåˆå§‹åŒ–
     * <span class="token keyword">@param</span> <span class="token parameter">accessKeyId</span>
     * <span class="token keyword">@param</span> <span class="token parameter">accessKeySecret</span>
     * <span class="token keyword">@return</span>
     * <span class="token keyword">@throws</span>
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">DefaultAcsClient</span> <span class="token function">initVodClient</span><span class="token punctuation">(</span><span class="token class-name">String</span> accessKeyId<span class="token punctuation">,</span> <span class="token class-name">String</span> accessKeySecret<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">ClientException</span> <span class="token punctuation">{</span>
        <span class="token class-name">String</span> regionId <span class="token operator">=</span> <span class="token string">&quot;cn-shanghai&quot;</span><span class="token punctuation">;</span>  <span class="token comment">// ç‚¹æ’­æœåŠ¡æ¥å…¥åœ°åŸŸ</span>
        <span class="token class-name">DefaultProfile</span> profile <span class="token operator">=</span> <span class="token class-name">DefaultProfile</span><span class="token punctuation">.</span><span class="token function">getProfile</span><span class="token punctuation">(</span>regionId<span class="token punctuation">,</span> accessKeyId<span class="token punctuation">,</span> accessKeySecret<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">DefaultAcsClient</span> client <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">DefaultAcsClient</span><span class="token punctuation">(</span>profile<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> client<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p><code>VodServiceImpl</code> ç±»å®ç°è§†é¢‘ä¸Šä¼ ã€åˆ é™¤æœåŠ¡</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">VodService</span> <span class="token punctuation">{</span>
    <span class="token class-name">String</span> <span class="token function">uploadVideo</span><span class="token punctuation">(</span><span class="token class-name">MultipartFile</span> file<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">void</span> <span class="token function">removeVideo</span><span class="token punctuation">(</span><span class="token class-name">String</span> videoId<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token annotation punctuation">@Service</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">VodServiceImpl</span> <span class="token keyword">implements</span> <span class="token class-name">VodService</span> <span class="token punctuation">{</span>

    <span class="token doc-comment comment">/**
     * ä¸Šä¼ è§†é¢‘åˆ°é˜¿é‡Œäº‘ç«¯
     * <span class="token keyword">@param</span> <span class="token parameter">file</span>
     * <span class="token keyword">@return</span>
     */</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">uploadVideo</span><span class="token punctuation">(</span><span class="token class-name">MultipartFile</span> file<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token comment">//accessKeyId, accessKeySecret</span>
            <span class="token class-name">String</span> fileName <span class="token operator">=</span> file<span class="token punctuation">.</span><span class="token function">getOriginalFilename</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">//titleï¼šä¸Šä¼ ä¹‹åæ˜¾ç¤ºåç§°</span>
            <span class="token class-name">String</span> title <span class="token operator">=</span> fileName<span class="token punctuation">.</span><span class="token function">substring</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> fileName<span class="token punctuation">.</span><span class="token function">lastIndexOf</span><span class="token punctuation">(</span><span class="token string">&quot;.&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">InputStream</span> inputStream <span class="token operator">=</span> file<span class="token punctuation">.</span><span class="token function">getInputStream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">UploadStreamRequest</span> request <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">UploadStreamRequest</span><span class="token punctuation">(</span><span class="token class-name">AliyunVodConfigConstant</span><span class="token punctuation">.</span><span class="token constant">ACCESS_KEY_ID</span><span class="token punctuation">,</span> <span class="token class-name">AliyunVodConfigConstant</span><span class="token punctuation">.</span><span class="token constant">ACCESS_KEY_SECRET</span><span class="token punctuation">,</span> title<span class="token punctuation">,</span> fileName<span class="token punctuation">,</span> inputStream<span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token class-name">UploadVideoImpl</span> uploader <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">UploadVideoImpl</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">UploadStreamResponse</span> response <span class="token operator">=</span> uploader<span class="token punctuation">.</span><span class="token function">uploadStream</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token class-name">String</span> videoId <span class="token operator">=</span> response<span class="token punctuation">.</span><span class="token function">getVideoId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>response<span class="token punctuation">.</span><span class="token function">isSuccess</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token class-name">String</span> errorMessage <span class="token operator">=</span> <span class="token string">&quot;é˜¿é‡Œäº‘ä¸Šä¼ é”™è¯¯ï¼š&quot;</span> <span class="token operator">+</span> <span class="token string">&quot;codeï¼š&quot;</span> <span class="token operator">+</span>
                        response<span class="token punctuation">.</span><span class="token function">getCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot;, messageï¼š&quot;</span> <span class="token operator">+</span> response<span class="token punctuation">.</span><span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token class-name">ObjectUtils</span><span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span>videoId<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
                    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>errorMessage<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>

            <span class="token keyword">return</span> videoId<span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">removeVideo</span><span class="token punctuation">(</span><span class="token class-name">String</span> videoId<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token comment">//åˆå§‹åŒ–å¯¹è±¡</span>
            <span class="token class-name">DefaultAcsClient</span> client <span class="token operator">=</span> <span class="token class-name">AliyunVodSDKUtils</span><span class="token punctuation">.</span><span class="token function">initVodClient</span><span class="token punctuation">(</span>
                    <span class="token class-name">AliyunVodConfigConstant</span><span class="token punctuation">.</span><span class="token constant">ACCESS_KEY_ID</span><span class="token punctuation">,</span>
                    <span class="token class-name">AliyunVodConfigConstant</span><span class="token punctuation">.</span><span class="token constant">ACCESS_KEY_SECRET</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">//åˆ›å»ºåˆ é™¤è§†é¢‘çš„requestå¯¹è±¡</span>
            <span class="token class-name">DeleteVideoRequest</span> request <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">DeleteVideoRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">//å‘requestä¸­è®¾ç½®videoId</span>
            request<span class="token punctuation">.</span><span class="token function">setVideoIds</span><span class="token punctuation">(</span>videoId<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">//è°ƒç”¨åˆ é™¤æ–¹æ³•</span>
            <span class="token class-name">DeleteVideoResponse</span> response <span class="token operator">=</span> client<span class="token punctuation">.</span><span class="token function">getAcsResponse</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;RequestId = &quot;</span> <span class="token operator">+</span> response<span class="token punctuation">.</span><span class="token function">getRequestId</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">&quot;\n&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">ClientException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;è§†é¢‘åˆ é™¤å¤±è´¥&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>ç¼–å†™ Controller ä»£ç å¹¶æµ‹è¯•</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/video&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">VodController</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Autowired</span>
    <span class="token keyword">private</span> <span class="token class-name">VodService</span> vodService<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@PostMapping</span><span class="token punctuation">(</span><span class="token string">&quot;uploadVideo&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">uploadVideo</span><span class="token punctuation">(</span><span class="token class-name">MultipartFile</span> file<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">String</span> videoId <span class="token operator">=</span> vodService<span class="token punctuation">.</span><span class="token function">uploadVideo</span><span class="token punctuation">(</span>file<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token string">&quot;è§†é¢‘ä¸Šä¼ æˆæœï¼ŒvideoId&quot;</span> <span class="token operator">+</span> videoId<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>ä½¿ç”¨ ApiPost æµ‹è¯•ä¸Šä¼ åŠŸèƒ½ï¼š</p><p><img src="https://eduimage1.oss-cn-beijing.aliyuncs.com/img/image-20220413093036806.png" alt="image-20220413093036806" loading="lazy"></p><p>ä¸Šä¼ æˆåŠŸåå›åˆ°é˜¿é‡Œäº‘è§†é¢‘ç‚¹æ’­æ§åˆ¶å°ä¼šçœ‹åˆ°ä¸Šä¼ çš„è§†é¢‘ï¼š</p><p><img src="https://eduimage1.oss-cn-beijing.aliyuncs.com/img/image-20220413093329811.png" alt="image-20220413093329811" loading="lazy"></p></li></ol><h2 id="springbootå®ç°é˜¿é‡Œäº‘è§†é¢‘æ’­æ”¾" tabindex="-1"><a class="header-anchor" href="#springbootå®ç°é˜¿é‡Œäº‘è§†é¢‘æ’­æ”¾" aria-hidden="true">#</a> SpringBootå®ç°é˜¿é‡Œäº‘è§†é¢‘æ’­æ”¾</h2><div class="custom-container info"><p class="custom-container-title">Info</p><p>ä¸Šæ–‡è®²è§£äº†å¦‚ä½•å°†æœ¬åœ°è§†é¢‘ä¸Šä¼ åˆ°é˜¿é‡Œäº‘å¹³å°ï¼Œå¦‚æœå¸Œæœ›ç‚¹æ’­é˜¿é‡Œäº‘å¹³å°å†…çš„è§†é¢‘ï¼Œéœ€è¦é¡¹ç›®ä¸­æ¥å…¥é˜¿é‡Œäº‘è§†é¢‘ç‚¹æ’­åŠŸèƒ½</p></div><p>ä»¥å‰ç«¯é¡¹ç›®edu-frontå’Œåç«¯é¡¹ç›®eduä¸ºä¾‹ï¼Œé›†æˆé˜¿é‡Œäº‘è§†é¢‘æ’­æ”¾å‰ç«¯é…ç½®å‚è€ƒ<a href="https://help.aliyun.com/document_detail/125570.html?spm=a2c4g.11186623.0.0.36f36515DQIzLs" target="_blank" rel="noopener noreferrer">Webæ’­æ”¾å™¨å¿«é€Ÿæ¥å…¥<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>ï¼Œæ­¥éª¤å¦‚ä¸‹ï¼š</p><ol><li><p>å‰ç«¯é¡¹ç›®edu-frontå¼•å…¥è„šæœ¬æ–‡ä»¶å’Œcssæ–‡ä»¶</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token operator">&lt;</span>head<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>link rel<span class="token operator">=</span><span class="token string">&quot;stylesheet&quot;</span> href<span class="token operator">=</span><span class="token string">&quot;https://g.alicdn.com/de/prismplayer/2.12.1/skins/default/aliplayer-min.css&quot;</span> <span class="token operator">/</span><span class="token operator">&gt;</span>  <span class="token comment">//ï¼ˆå¯é€‰ï¼‰å¦‚æœæ‚¨çš„ä½¿ç”¨åœºæ™¯éœ€è¦ç”¨åˆ°H5æ¨¡å¼çš„æ’­æ”¾å™¨ï¼Œåˆ™éœ€å¼•ç”¨æ­¤cssæ–‡ä»¶ã€‚</span>
  <span class="token operator">&lt;</span>script charset<span class="token operator">=</span><span class="token string">&quot;utf-8&quot;</span> type<span class="token operator">=</span><span class="token string">&quot;text/javascript&quot;</span> src<span class="token operator">=</span><span class="token string">&quot;https://g.alicdn.com/de/prismplayer/2.12.1/aliplayer-min.js&quot;</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span>  <span class="token comment">//ï¼ˆå¿…é¡»ï¼‰å¼•å…¥jsæ–‡ä»¶ã€‚</span>
<span class="token operator">&lt;</span><span class="token operator">/</span>head<span class="token operator">&gt;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>æä¾›æŒ‚è½½å…ƒç´ </p><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>J_prismPlayer<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>å®ä¾‹åŒ–æ’­æ”¾å™¨ï¼Œå‚è€ƒ<a href="https://help.aliyun.com/document_detail/125570.html?spm=a2c4g.11186623.0.0.36f36515DQIzLs#section-m6w-48u-jvw" target="_blank" rel="noopener noreferrer">ç‚¹æ’­æ’­æ”¾æ–¹å¼<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>æˆ–è€…<a href="https://help.aliyun.com/document_detail/125570.html?spm=a2c4g.11186623.0.0.36f36515DQIzLs#section-ov3-t67-45x" target="_blank" rel="noopener noreferrer">ç›´æ’­è§†é¢‘æ’­æ”¾<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><div class="custom-container tip"><p class="custom-container-title">Tips</p><p>ä¸Šè¿°ä»£ç åœ¨é¡¹ç›®edu-frontè·¯å¾„<code>pages/player/_vid.vue</code>ä¸‹å®ç°</p></div></li></ol><p>é›†æˆé˜¿é‡Œäº‘è§†é¢‘æ’­æ”¾åç«¯é…ç½®åªéœ€è¦<a href="https://help.aliyun.com/document_detail/61064.html" target="_blank" rel="noopener noreferrer">è·å–è§†é¢‘æ’­æ”¾å‡­è¯<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>å³å¯ï¼Œæ­¥éª¤å¦‚ä¸‹ï¼š</p><ol><li><p><a href="https://help.aliyun.com/document_detail/53045.htm?spm=a2c4g.11186623.0.0.3d393669b6yTjz#task-354412" target="_blank" rel="noopener noreferrer">è·å–AccessKey<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>ï¼Œåˆ›å»ºé˜¿é‡Œäº‘AccessKeyå¸¸é‡ç±»</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Configuration</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">AliyunVodConfigConstant</span> <span class="token keyword">implements</span> <span class="token class-name">InitializingBean</span> <span class="token punctuation">{</span>
    
    <span class="token annotation punctuation">@Value</span><span class="token punctuation">(</span><span class="token string">&quot;${aliyun.vod.file.keyid}&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> keyId<span class="token punctuation">;</span>
    <span class="token annotation punctuation">@Value</span><span class="token punctuation">(</span><span class="token string">&quot;${aliyun.vod.file.keysecret}&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> keySecret<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">String</span> <span class="token constant">ACCESS_KEY_ID</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">String</span> <span class="token constant">ACCESS_KEY_SECRET</span><span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">afterPropertiesSet</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
        <span class="token constant">ACCESS_KEY_ID</span> <span class="token operator">=</span> keyId<span class="token punctuation">;</span>
        <span class="token constant">ACCESS_KEY_SECRET</span> <span class="token operator">=</span> keySecret<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-properties line-numbers-mode" data-ext="properties"><pre class="language-properties"><code><span class="token comment"># ä½ çš„accessKeyId # ä½ çš„AccessKey Secret</span>
<span class="token key attr-name">aliyun.vod.file.keyid</span><span class="token punctuation">=</span><span class="token value attr-value">ä½ çš„accessKeyId</span>
<span class="token key attr-name">aliyun.vod.file.keysecret</span><span class="token punctuation">=</span><span class="token value attr-value">ä½ çš„AccessKey Secret</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>åˆ›å»ºé˜¿é‡Œäº‘è§†é¢‘ç‚¹æ’­æœåŠ¡å·¥å…·ç±»<code>AliyunVodSDKUtils</code></p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">AliyunVodSDKUtils</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">DefaultAcsClient</span> <span class="token function">initVodClient</span><span class="token punctuation">(</span><span class="token class-name">String</span> accessKeyId<span class="token punctuation">,</span> <span class="token class-name">String</span> accessKeySecret<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">ClientException</span> <span class="token punctuation">{</span>
        <span class="token class-name">String</span> regionId <span class="token operator">=</span> <span class="token string">&quot;cn-shanghai&quot;</span><span class="token punctuation">;</span>  <span class="token comment">// ç‚¹æ’­æœåŠ¡æ¥å…¥åœ°åŸŸ</span>
        <span class="token class-name">DefaultProfile</span> profile <span class="token operator">=</span> <span class="token class-name">DefaultProfile</span><span class="token punctuation">.</span><span class="token function">getProfile</span><span class="token punctuation">(</span>regionId<span class="token punctuation">,</span> accessKeyId<span class="token punctuation">,</span> accessKeySecret<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">DefaultAcsClient</span> client <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">DefaultAcsClient</span><span class="token punctuation">(</span>profile<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> client<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>è·å–è§†é¢‘æ’­æ”¾å‡­è¯</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">&quot;getVideoPlayAuth/{id}&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token class-name">CommonResult</span> <span class="token function">getVideoPlayAuth</span><span class="token punctuation">(</span><span class="token annotation punctuation">@PathVariable</span> <span class="token class-name">String</span> id<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">try</span> <span class="token punctuation">{</span>
        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">&quot;id:&quot;</span> <span class="token operator">+</span> id<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//åˆ›å»ºåˆå§‹åŒ–å¯¹è±¡</span>
        <span class="token class-name">DefaultAcsClient</span> client <span class="token operator">=</span> <span class="token class-name">AliyunVodSDKUtils</span><span class="token punctuation">.</span><span class="token function">initVodClient</span><span class="token punctuation">(</span><span class="token class-name">AliyunVodConfigConstant</span><span class="token punctuation">.</span><span class="token constant">ACCESS_KEY_ID</span><span class="token punctuation">,</span> <span class="token class-name">AliyunVodConfigConstant</span><span class="token punctuation">.</span><span class="token constant">ACCESS_KEY_SECRET</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//åˆ›å»ºè·å–å‡­è¯çš„requestå’Œresponseå¯¹è±¡</span>
        <span class="token class-name">GetVideoPlayAuthRequest</span> request <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">GetVideoPlayAuthRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//å‘requestå¯¹è±¡ä¸­è®¾ç½®è§†é¢‘id</span>
        request<span class="token punctuation">.</span><span class="token function">setVideoId</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">//è°ƒç”¨æ–¹æ³•è·å¾—å‡­è¯</span>
        <span class="token class-name">GetVideoPlayAuthResponse</span> response <span class="token operator">=</span> client<span class="token punctuation">.</span><span class="token function">getAcsResponse</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">String</span> playAuth <span class="token operator">=</span> response<span class="token punctuation">.</span><span class="token function">getPlayAuth</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token class-name">CommonResult</span><span class="token punctuation">.</span><span class="token function">success</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">data</span><span class="token punctuation">(</span><span class="token string">&quot;playAuth&quot;</span><span class="token punctuation">,</span> playAuth<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">ClientException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">CustomizeApiException</span><span class="token punctuation">(</span><span class="token number">20001</span><span class="token punctuation">,</span><span class="token string">&quot;è§†é¢‘playAuthè·å–å¤±è´¥&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ol><h2 id="springboot-æ•´åˆ-redis" tabindex="-1"><a class="header-anchor" href="#springboot-æ•´åˆ-redis" aria-hidden="true">#</a> SpringBoot æ•´åˆ Redis</h2><div class="custom-container tip"><p class="custom-container-title">Redisç®€ä»‹</p><p><a href="https://redis.io/docs/about/" target="_blank" rel="noopener noreferrer">Redis<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> æ˜¯ä¸€ä¸ªå¼€æºã€åŸºäºå†…å­˜ã€ä½¿ç”¨ C è¯­è¨€ç¼–å†™çš„key-valueæ•°æ®åº“ï¼ŒRedis æ”¯æŒäº”ç§æ•°æ®ç±»å‹ï¼šstringï¼ˆå­—ç¬¦ä¸²ï¼‰ï¼Œlistï¼ˆåˆ—è¡¨ï¼‰ï¼Œsetï¼ˆé›†åˆï¼‰ï¼Œhashï¼ˆå“ˆå¸Œï¼‰åŠ zset(sorted setï¼šæœ‰åºé›†åˆ)ã€‚redis ä¸­çš„æ•°æ®éƒ½æ˜¯å­—ç¬¦ä¸²ï¼Œredis æ˜¯å•çº¿ç¨‹ï¼Œä¸é€‚åˆå­˜å‚¨æ¯”è¾ƒå¤§çš„æ•°æ®ï¼Œä¸»è¦å¯ä»¥ç”¨äºæ•°æ®åº“ã€ç¼“å­˜ã€åˆ†å¸ƒå¼é”ã€æ¶ˆæ¯é˜Ÿåˆ—ç­‰...</p></div><p>ç½‘ç«™é¦–é¡µBannerå¾€å¾€å˜åŒ–ä¸æ˜¯å¾ˆé¢‘ç¹ä¸”è®¿é—®é‡ç›¸å¯¹è¾ƒå¤§ï¼Œå› æ­¤æœ‰å¿…è¦ä½¿ç”¨Rediså®ç°æ•°æ®ç¼“å­˜ï¼Œä»¥ä¾¿å‡å°‘æ•°æ®åº“å‹åŠ›å’Œæé«˜è®¿é—®é€Ÿåº¦ã€‚æ–°å»ºSpringBooté¡¹ç›®<code>springboot-redis</code>ï¼Œé¡¹ç›®ä¸­é›†æˆRedisæœåŠ¡æ­¥éª¤å¦‚ä¸‹ï¼š</p><ol><li><p><a href="https://redis.io/docs/getting-started/" target="_blank" rel="noopener noreferrer">å®‰è£…å¹¶å¯åŠ¨RedisæœåŠ¡<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p></li><li><p><code>pom.xml</code>æ–‡ä»¶ä¸­æ·»åŠ é¡¹ç›®ä¾èµ–</p><div class="language-pom line-numbers-mode" data-ext="pom"><pre class="language-pom"><code>&lt;!-- redis --&gt;
&lt;dependency&gt;
    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;
    &lt;artifactId&gt;spring-boot-starter-data-redis&lt;/artifactId&gt;
&lt;/dependency&gt;
&lt;dependency&gt;
    &lt;groupId&gt;org.apache.commons&lt;/groupId&gt;
    &lt;artifactId&gt;commons-pool2&lt;/artifactId&gt;
&lt;/dependency&gt;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>æ–°å»ºRedisé…ç½®ç±»</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>codinglife<span class="token punctuation">.</span>config</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>fasterxml<span class="token punctuation">.</span>jackson<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">JsonAutoDetect</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>fasterxml<span class="token punctuation">.</span>jackson<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">PropertyAccessor</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>fasterxml<span class="token punctuation">.</span>jackson<span class="token punctuation">.</span>databind<span class="token punctuation">.</span></span><span class="token class-name">ObjectMapper</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>fasterxml<span class="token punctuation">.</span>jackson<span class="token punctuation">.</span>databind<span class="token punctuation">.</span></span><span class="token class-name">PropertyNamingStrategy</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>fasterxml<span class="token punctuation">.</span>jackson<span class="token punctuation">.</span>databind<span class="token punctuation">.</span></span><span class="token class-name">SerializationFeature</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>fasterxml<span class="token punctuation">.</span>jackson<span class="token punctuation">.</span>datatype<span class="token punctuation">.</span>jsr310<span class="token punctuation">.</span></span><span class="token class-name">JavaTimeModule</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>fasterxml<span class="token punctuation">.</span>jackson<span class="token punctuation">.</span>datatype<span class="token punctuation">.</span>jsr310<span class="token punctuation">.</span>ser<span class="token punctuation">.</span></span><span class="token class-name">LocalDateTimeSerializer</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>cache<span class="token punctuation">.</span></span><span class="token class-name">CacheManager</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>cache<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">EnableCaching</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>context<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Bean</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>context<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Configuration</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>data<span class="token punctuation">.</span>redis<span class="token punctuation">.</span>cache<span class="token punctuation">.</span></span><span class="token class-name">RedisCacheConfiguration</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>data<span class="token punctuation">.</span>redis<span class="token punctuation">.</span>cache<span class="token punctuation">.</span></span><span class="token class-name">RedisCacheManager</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>data<span class="token punctuation">.</span>redis<span class="token punctuation">.</span>connection<span class="token punctuation">.</span></span><span class="token class-name">RedisConnectionFactory</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>data<span class="token punctuation">.</span>redis<span class="token punctuation">.</span>core<span class="token punctuation">.</span></span><span class="token class-name">RedisTemplate</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>data<span class="token punctuation">.</span>redis<span class="token punctuation">.</span>serializer<span class="token punctuation">.</span></span><span class="token operator">*</span></span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>text<span class="token punctuation">.</span></span><span class="token class-name">SimpleDateFormat</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>time<span class="token punctuation">.</span></span><span class="token class-name">Duration</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>time<span class="token punctuation">.</span></span><span class="token class-name">LocalDateTime</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>time<span class="token punctuation">.</span>format<span class="token punctuation">.</span></span><span class="token class-name">DateTimeFormatter</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">TimeZone</span></span><span class="token punctuation">;</span>

<span class="token doc-comment comment">/**
 * @Description: Redisé…ç½®ç±»
 * <span class="token keyword">@author</span>: CodingLifeVV
 * <span class="token keyword">@date</span>: 2022.04.22
 */</span>
<span class="token annotation punctuation">@Configuration</span>
<span class="token annotation punctuation">@EnableCaching</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">RedisConfig</span> <span class="token punctuation">{</span>

    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">DateTimeFormatter</span> <span class="token constant">DATE_TIME_FORMATTER</span> <span class="token operator">=</span> <span class="token class-name">DateTimeFormatter</span><span class="token punctuation">.</span><span class="token function">ofPattern</span><span class="token punctuation">(</span><span class="token string">&quot;yyyy-MM-dd HH:mm:ss&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">DateTimeFormatter</span> <span class="token constant">DATE_FORMATTER</span> <span class="token operator">=</span> <span class="token class-name">DateTimeFormatter</span><span class="token punctuation">.</span><span class="token function">ofPattern</span><span class="token punctuation">(</span><span class="token string">&quot;yyyy-MM-dd&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">DateTimeFormatter</span> <span class="token constant">TIME_FORMATTER</span> <span class="token operator">=</span> <span class="token class-name">DateTimeFormatter</span><span class="token punctuation">.</span><span class="token function">ofPattern</span><span class="token punctuation">(</span><span class="token string">&quot;HH:mm:ss&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


    <span class="token annotation punctuation">@Bean</span>
    <span class="token keyword">public</span> <span class="token class-name">RedisTemplate</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> <span class="token function">redisTemplate</span><span class="token punctuation">(</span><span class="token class-name">RedisConnectionFactory</span> redisConnectionFactory<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">RedisTemplate</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> template <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">RedisTemplate</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        template<span class="token punctuation">.</span><span class="token function">setConnectionFactory</span><span class="token punctuation">(</span>redisConnectionFactory<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token doc-comment comment">/**
         * JSONåºåˆ—åŒ–
         */</span>
        <span class="token class-name">Jackson2JsonRedisSerializer</span> serializer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Jackson2JsonRedisSerializer</span><span class="token punctuation">(</span><span class="token class-name">Object</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">ObjectMapper</span> mapper <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ObjectMapper</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//å–æ¶ˆæ—¶é—´è½¬æ¢æ ¼å¼ï¼Œé»˜è®¤æ˜¯æ—¶é—´æˆ³ï¼ŒåŒæ—¶éœ€è¦è®¾ç½®è¦è¡¨ç°çš„æ—¶é—´æ ¼å¼</span>
        mapper<span class="token punctuation">.</span><span class="token function">configure</span><span class="token punctuation">(</span><span class="token class-name">SerializationFeature</span><span class="token punctuation">.</span><span class="token constant">WRITE_DATES_AS_TIMESTAMPS</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        mapper<span class="token punctuation">.</span><span class="token function">configure</span><span class="token punctuation">(</span><span class="token class-name">SerializationFeature</span><span class="token punctuation">.</span><span class="token constant">WRITE_DURATIONS_AS_TIMESTAMPS</span><span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        mapper<span class="token punctuation">.</span><span class="token function">setDateFormat</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">SimpleDateFormat</span><span class="token punctuation">(</span><span class="token string">&quot;yyy-MM-dd HH:mm:ss&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">//é»˜è®¤åºåˆ—åŒ–æ²¡æœ‰å®ç°ï¼Œååºåˆ—åŒ–æœ‰å®ç°</span>
        <span class="token class-name">JavaTimeModule</span> javaTimeModule <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">JavaTimeModule</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        javaTimeModule<span class="token punctuation">.</span><span class="token function">addSerializer</span><span class="token punctuation">(</span><span class="token class-name">LocalDateTime</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">LocalDateTimeSerializer</span><span class="token punctuation">(</span><span class="token constant">DATE_TIME_FORMATTER</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        mapper<span class="token punctuation">.</span><span class="token function">registerModule</span><span class="token punctuation">(</span>javaTimeModule<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//è®¾ç½®æ—¶åŒº</span>
        mapper<span class="token punctuation">.</span><span class="token function">setTimeZone</span><span class="token punctuation">(</span><span class="token class-name">TimeZone</span><span class="token punctuation">.</span><span class="token function">getDefault</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">//è®¾ç½®æ ¼å¼åŒ–è¾“å‡º</span>
        mapper<span class="token punctuation">.</span><span class="token function">setPropertyNamingStrategy</span><span class="token punctuation">(</span><span class="token class-name">PropertyNamingStrategy</span><span class="token punctuation">.</span><span class="token constant">SNAKE_CASE</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        mapper<span class="token punctuation">.</span><span class="token function">setVisibility</span><span class="token punctuation">(</span><span class="token class-name">PropertyAccessor</span><span class="token punctuation">.</span><span class="token constant">ALL</span><span class="token punctuation">,</span> <span class="token class-name">JsonAutoDetect<span class="token punctuation">.</span>Visibility</span><span class="token punctuation">.</span><span class="token constant">ANY</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        serializer<span class="token punctuation">.</span><span class="token function">setObjectMapper</span><span class="token punctuation">(</span>mapper<span class="token punctuation">)</span><span class="token punctuation">;</span>

        template<span class="token punctuation">.</span><span class="token function">setKeySerializer</span><span class="token punctuation">(</span>serializer<span class="token punctuation">)</span><span class="token punctuation">;</span>
        template<span class="token punctuation">.</span><span class="token function">setHashKeySerializer</span><span class="token punctuation">(</span>serializer<span class="token punctuation">)</span><span class="token punctuation">;</span>
        template<span class="token punctuation">.</span><span class="token function">setValueSerializer</span><span class="token punctuation">(</span>serializer<span class="token punctuation">)</span><span class="token punctuation">;</span>
        template<span class="token punctuation">.</span><span class="token function">setHashValueSerializer</span><span class="token punctuation">(</span>serializer<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> template<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@Bean</span>
    <span class="token keyword">public</span> <span class="token class-name">CacheManager</span> <span class="token function">cacheManager</span><span class="token punctuation">(</span><span class="token class-name">RedisConnectionFactory</span> factory<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">RedisSerializer</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> redisSerializer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">StringRedisSerializer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Jackson2JsonRedisSerializer</span> jackson2JsonRedisSerializer <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Jackson2JsonRedisSerializer</span><span class="token punctuation">(</span><span class="token class-name">Object</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">//è§£å†³æŸ¥è¯¢ç¼“å­˜è½¬æ¢å¼‚å¸¸çš„é—®é¢˜</span>
        <span class="token class-name">ObjectMapper</span> om <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ObjectMapper</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        om<span class="token punctuation">.</span><span class="token function">setVisibility</span><span class="token punctuation">(</span><span class="token class-name">PropertyAccessor</span><span class="token punctuation">.</span><span class="token constant">ALL</span><span class="token punctuation">,</span> <span class="token class-name">JsonAutoDetect<span class="token punctuation">.</span>Visibility</span><span class="token punctuation">.</span><span class="token constant">ANY</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        om<span class="token punctuation">.</span><span class="token function">enableDefaultTyping</span><span class="token punctuation">(</span><span class="token class-name">ObjectMapper<span class="token punctuation">.</span>DefaultTyping</span><span class="token punctuation">.</span><span class="token constant">NON_FINAL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        jackson2JsonRedisSerializer<span class="token punctuation">.</span><span class="token function">setObjectMapper</span><span class="token punctuation">(</span>om<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// é…ç½®åºåˆ—åŒ–ï¼ˆè§£å†³ä¹±ç çš„é—®é¢˜ï¼‰,è¿‡æœŸæ—¶é—´600ç§’</span>
        <span class="token class-name">RedisCacheConfiguration</span> config <span class="token operator">=</span> <span class="token class-name">RedisCacheConfiguration</span><span class="token punctuation">.</span><span class="token function">defaultCacheConfig</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">entryTtl</span><span class="token punctuation">(</span><span class="token class-name">Duration</span><span class="token punctuation">.</span><span class="token function">ofSeconds</span><span class="token punctuation">(</span><span class="token number">600</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">serializeKeysWith</span><span class="token punctuation">(</span><span class="token class-name">RedisSerializationContext<span class="token punctuation">.</span>SerializationPair</span><span class="token punctuation">.</span><span class="token function">fromSerializer</span><span class="token punctuation">(</span>redisSerializer<span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">serializeValuesWith</span><span class="token punctuation">(</span><span class="token class-name">RedisSerializationContext<span class="token punctuation">.</span>SerializationPair</span><span class="token punctuation">.</span><span class="token function">fromSerializer</span><span class="token punctuation">(</span>jackson2JsonRedisSerializer<span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">disableCachingNullValues</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">RedisCacheManager</span> cacheManager <span class="token operator">=</span> <span class="token class-name">RedisCacheManager</span><span class="token punctuation">.</span><span class="token function">builder</span><span class="token punctuation">(</span>factory<span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">cacheDefaults</span><span class="token punctuation">(</span>config<span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> cacheManager<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>é…ç½®æ–‡ä»¶<code>application.properties</code>ä¸­æ·»åŠ Redisé…ç½®</p><div class="language-properties line-numbers-mode" data-ext="properties"><pre class="language-properties"><code><span class="token comment"># redis é…ç½®</span>
<span class="token key attr-name">spring.redis.host</span><span class="token punctuation">=</span><span class="token value attr-value">127.0.0.1</span>
<span class="token key attr-name">spring.redis.port</span><span class="token punctuation">=</span><span class="token value attr-value">6379</span>
<span class="token key attr-name">spring.redis.database</span><span class="token punctuation">=</span> <span class="token value attr-value">0</span>
<span class="token key attr-name">spring.redis.timeout</span><span class="token punctuation">=</span><span class="token value attr-value">1800000</span>

<span class="token comment"># SpringBoot 2.x ä½¿ç”¨äº†lettuceå®¢æˆ·ç«¯</span>
<span class="token key attr-name">spring.redis.lettuce.pool.max-active</span><span class="token punctuation">=</span><span class="token value attr-value">20</span>
<span class="token key attr-name">spring.redis.lettuce.pool.max-wait</span><span class="token punctuation">=</span><span class="token value attr-value">-1</span>
<span class="token comment"># æœ€å¤§é˜»å¡ç­‰å¾…æ—¶é—´(è´Ÿæ•°è¡¨ç¤ºæ²¡é™åˆ¶)</span>
<span class="token key attr-name">spring.redis.lettuce.pool.max-idle</span><span class="token punctuation">=</span><span class="token value attr-value">5</span>
<span class="token key attr-name">spring.redis.lettuce.pool.min-idle</span><span class="token punctuation">=</span><span class="token value attr-value">0</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>æœåŠ¡ç±»ä¸­ä½¿ç”¨SpringBootç¼“å­˜æ³¨è§£</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">BannerServiceImpl</span> <span class="token keyword">implements</span> <span class="token class-name">BannerService</span> <span class="token punctuation">{</span>

    <span class="token doc-comment comment">/**
     * æŸ¥è¯¢æ‰€æœ‰banner
     * @Cacheable æ ¹æ®æ–¹æ³•å¯¹å…¶è¿”å›ç»“æœè¿›è¡Œç¼“å­˜ value ç¼“å­˜å key è‡ªå®šä¹‰ç¼“å­˜ key
     * <span class="token keyword">@return</span>
     */</span>
    <span class="token annotation punctuation">@Cacheable</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;banner&quot;</span><span class="token punctuation">,</span>key <span class="token operator">=</span> <span class="token string">&quot;&#39;bannerList&#39;&quot;</span><span class="token punctuation">)</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Banner</span><span class="token punctuation">&gt;</span></span> <span class="token function">getAllBanner</span><span class="token punctuation">(</span><span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Banner</span><span class="token punctuation">&gt;</span></span> list<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">//æŸ¥è¯¢æ•°æ®åº“æ•°æ®åº“ä»£ç </span>
        <span class="token keyword">return</span> list<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token doc-comment comment">/**
     * ä¿å­˜banner
     * <span class="token keyword">@param</span> <span class="token parameter">crmBanner</span>
     * @CacheEvict æ¸…ç©ºæŒ‡å®šçš„ç¼“å­˜ã€‚ä¸€èˆ¬ç”¨åœ¨æ›´æ–°æˆ–è€…åˆ é™¤æ–¹æ³•ä¸Š value ç¼“å­˜å allEntries æ˜¯å¦æ¸…ç©ºæ‰€æœ‰ç¼“å­˜
     */</span>
    <span class="token annotation punctuation">@CacheEvict</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;banner&quot;</span><span class="token punctuation">,</span> allEntries<span class="token operator">=</span><span class="token boolean">true</span><span class="token punctuation">)</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">savaBanner</span><span class="token punctuation">(</span><span class="token class-name">Banner</span> crmBanner<span class="token punctuation">)</span> <span class="token punctuation">{</span>
				<span class="token comment">//æ›´æ–°æ•°æ®åº“æ•°æ®ä»£ç </span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@CacheEvict</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;banner&quot;</span><span class="token punctuation">,</span> allEntries<span class="token operator">=</span><span class="token boolean">true</span><span class="token punctuation">)</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">updateBannerById</span><span class="token punctuation">(</span><span class="token class-name">Banner</span> crmBanner<span class="token punctuation">)</span> <span class="token punctuation">{</span>
				<span class="token comment">//æ›´æ–°æ•°æ®åº“æ•°æ®ä»£ç </span>
    <span class="token punctuation">}</span>

    <span class="token annotation punctuation">@CacheEvict</span><span class="token punctuation">(</span>value <span class="token operator">=</span> <span class="token string">&quot;banner&quot;</span><span class="token punctuation">,</span> allEntries<span class="token operator">=</span><span class="token boolean">true</span><span class="token punctuation">)</span>
    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">removeBannerById</span><span class="token punctuation">(</span><span class="token class-name">String</span> id<span class="token punctuation">)</span> <span class="token punctuation">{</span>
				<span class="token comment">//åˆ é™¤æ•°æ®åº“æ•°æ®ä»£ç </span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="custom-container info"><p class="custom-container-title">SpringBootç¼“å­˜æ³¨è§£</p><p>å¸¸ç”¨çš„SpringBootç¼“å­˜æ³¨è§£æœ‰<code>@Cacheable</code>ã€<code>@CacheEvit</code>ã€<code>@CachePut</code>ï¼Œå«ä¹‰åˆ†åˆ«ä¸ºï¼š</p><p>1ã€<code>@Cacheable</code>ï¼šä¿®é¥°æ–¹æ³•æˆ–ç±»ï¼Œå½“æˆ‘ä»¬è®¿é—®å®ƒä¿®é¥°çš„æ–¹æ³•æ—¶ï¼Œä¼˜å…ˆä»ç¼“å­˜ä¸­è·å–ï¼Œè‹¥ç¼“å­˜ä¸­å­˜åœ¨ï¼Œåˆ™ç›´æ¥è·å–ç¼“å­˜çš„å€¼ï¼›ç¼“å­˜ä¸å­˜åœ¨æ—¶ï¼Œæ‰§è¡Œæ–¹æ³•ï¼Œå¹¶å°†ç»“æœå†™å…¥ç¼“å­˜ï¼Œ<code>value</code>è¡¨ç¤ºç¼“å­˜åï¼Œ<code>key</code>è¡¨ç¤ºè‡ªå®šä¹‰ç¼“å­˜key</p><p>2ã€<code>@CacheEvit</code>ï¼šåˆ é™¤ç¼“å­˜ï¼Œä¸€èˆ¬ç”¨åœ¨æ›´æ–°æˆ–è€…åˆ é™¤æ–¹æ³•ä¸Šï¼Œ<code>value</code>è¡¨ç¤ºç¼“å­˜åï¼Œ<code>allEntries</code>è¡¨ç¤ºæ˜¯å¦æ¸…ç©ºæ‰€æœ‰ç¼“å­˜</p><p>3ã€<code>@CachePut</code>ï¼šä¸ç®¡ç¼“å­˜æœ‰æ²¡æœ‰ï¼Œéƒ½å°†æ–¹æ³•çš„è¿”å›ç»“æœå†™å…¥ç¼“å­˜ï¼›é€‚ç”¨äºç¼“å­˜æ›´æ–°</p></div></li></ol><p>å‚è€ƒæ–‡ç« ï¼š</p><ul><li><p><a href="https://segmentfault.com/a/1190000039341264" target="_blank" rel="noopener noreferrer">Spring boot é›†æˆRedis<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p></li><li><p><a href="https://segmentfault.com/a/1190000040280838" target="_blank" rel="noopener noreferrer">Springç³»åˆ—ç¼“å­˜æ³¨è§£@Cacheable @CacheEvit @CachePut ä½¿ç”¨å§¿åŠ¿ä»‹ç»<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p></li></ul><h2 id="springboot-æ•´åˆ-jwt" tabindex="-1"><a class="header-anchor" href="#springboot-æ•´åˆ-jwt" aria-hidden="true">#</a> SpringBoot æ•´åˆ JWT</h2><div class="custom-container info"><p class="custom-container-title">JWT æ¦‚è¿°</p><p>JSON Web Tokenï¼ˆJWTï¼‰æ˜¯ç›®å‰æœ€æµè¡Œçš„è·¨åŸŸèº«ä»½éªŒè¯è§£å†³æ–¹æ¡ˆã€‚ä¾‹å¦‚æœåŠ¡ç«¯Aåœ¨è®¤è¯äº†ç”¨æˆ·èº«ä»½åï¼Œé¢å‘ä¸€ä¸ªå¾ˆçŸ­è¿‡æœŸæ—¶é—´çš„JWTç»™å®¢æˆ·ç«¯ï¼Œå®¢æˆ·ç«¯åœ¨å‘æœåŠ¡ç«¯Bçš„è¯·æ±‚ä¸­å¸¦ä¸Šè¯¥JWTï¼Œåˆ™æœåŠ¡ç«¯Bå¯ä»¥é€šè¿‡éªŒè¯è¯¥JWTæ¥åˆ¤æ–­ç”¨æˆ·æ˜¯å¦æœ‰æƒæ‰§è¡ŒæœåŠ¡ç«¯Bä¸Šçš„ç›¸å…³æ“ä½œã€‚JWT çš„å­¦ä¹ å‚è€ƒæ–‡æœ«å‚è€ƒæ–‡ç« ã€‚</p></div><p>é¡¹ç›®eduæ•´åˆäº† JWT è·¨åŸŸèº«ä»½éªŒè¯ï¼Œæ­¥éª¤å¦‚ä¸‹ï¼š</p><ol><li><p>å­æ¨¡å—<code>edu-common</code>ä¸‹çš„pom æ–‡ä»¶ä¸­æ·»åŠ  JWT ä¾èµ– edu-common-utils</p><div class="language-pom line-numbers-mode" data-ext="pom"><pre class="language-pom"><code>&lt;!-- JWT è·¨è¶Šèº«ä»½éªŒè¯--&gt;
&lt;dependency&gt;
    &lt;groupId&gt;io.jsonwebtoken&lt;/groupId&gt;
    &lt;artifactId&gt;jjwt&lt;/artifactId&gt;
&lt;/dependency&gt;
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>å­æ¨¡å—<code>edu-common</code>ä¸‹æ¨¡å—<code>edu-common-utils</code>åˆ›å»º JWT å·¥å…·ç±»</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">import</span> <span class="token import"><span class="token namespace">io<span class="token punctuation">.</span>jsonwebtoken<span class="token punctuation">.</span></span><span class="token class-name">Claims</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">io<span class="token punctuation">.</span>jsonwebtoken<span class="token punctuation">.</span></span><span class="token class-name">Jws</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">io<span class="token punctuation">.</span>jsonwebtoken<span class="token punctuation">.</span></span><span class="token class-name">Jwts</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">io<span class="token punctuation">.</span>jsonwebtoken<span class="token punctuation">.</span></span><span class="token class-name">SignatureAlgorithm</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">StringUtils</span></span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token import"><span class="token namespace">javax<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span>http<span class="token punctuation">.</span></span><span class="token class-name">HttpServletRequest</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">Date</span></span><span class="token punctuation">;</span>

<span class="token doc-comment comment">/**
 * @Description: JWTè·¨è¶Šèº«ä»½éªŒè¯å·¥å…·ç±»
 * JWT tokençš„æ ¼å¼ï¼šheader.payload.signature å¤´éƒ¨.è´Ÿè½½.ç­¾å
 * headerçš„æ ¼å¼ï¼ˆç®—æ³•ã€tokençš„ç±»å‹ï¼‰,é»˜è®¤ï¼š<span class="token punctuation">{</span>&quot;alg&quot;: &quot;HS512&quot;,&quot;typ&quot;: &quot;JWT&quot;<span class="token punctuation">}</span> alg-ç­¾åç®—æ³• typ-ä»¤ç‰Œç±»å‹
 * payloadçš„æ ¼å¼ è®¾ç½®ï¼šï¼ˆç”¨æˆ·ä¿¡æ¯ã€åˆ›å»ºæ—¶é—´ã€ç”Ÿæˆæ—¶é—´ï¼‰
 * signatureçš„ç”Ÿæˆç®—æ³•ï¼š
 * HMACSHA512(base64UrlEncode(header) + &quot;.&quot; +base64UrlEncode(payload),secret)
 * <span class="token keyword">@author</span>: CodingLifeVV
 * <span class="token keyword">@date</span>: 2022.04.24
 */</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">JwtUtils</span> <span class="token punctuation">{</span>
  
    <span class="token doc-comment comment">/**
     * ä¸»é¢˜
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">String</span> <span class="token constant">SUBJECT</span> <span class="token operator">=</span> <span class="token string">&quot;edu-user&quot;</span><span class="token punctuation">;</span>

    <span class="token doc-comment comment">/**
     * è¿‡æœŸæ—¶é—´ï¼Œæ¯«ç§’ï¼Œä¸€å¤©
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">long</span> <span class="token constant">EXPIRE</span> <span class="token operator">=</span> <span class="token number">1000</span> <span class="token operator">*</span> <span class="token number">60</span> <span class="token operator">*</span> <span class="token number">60</span> <span class="token operator">*</span> <span class="token number">24</span><span class="token punctuation">;</span>

    <span class="token doc-comment comment">/**
     * å¯†é’¥
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">String</span> <span class="token constant">APP_SECRET</span> <span class="token operator">=</span> <span class="token string">&quot;secretkeycodinglifevv&quot;</span><span class="token punctuation">;</span>

    <span class="token doc-comment comment">/**
     * åˆ›å»º token ä¿¡æ¯
     * <span class="token keyword">@param</span> <span class="token parameter">id</span>
     * <span class="token keyword">@return</span>
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">String</span> <span class="token function">createToken</span><span class="token punctuation">(</span><span class="token class-name">String</span> id<span class="token punctuation">,</span> <span class="token class-name">String</span> nickname<span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token class-name">String</span> <span class="token class-name">JwtToken</span> <span class="token operator">=</span> <span class="token class-name">Jwts</span><span class="token punctuation">.</span><span class="token function">builder</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">setHeaderParam</span><span class="token punctuation">(</span><span class="token string">&quot;typ&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;JWT&quot;</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">setHeaderParam</span><span class="token punctuation">(</span><span class="token string">&quot;alg&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;HS256&quot;</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">setSubject</span><span class="token punctuation">(</span><span class="token constant">SUBJECT</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">setIssuedAt</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">setExpiration</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">currentTimeMillis</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token constant">EXPIRE</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">claim</span><span class="token punctuation">(</span><span class="token string">&quot;id&quot;</span><span class="token punctuation">,</span> id<span class="token punctuation">)</span>    <span class="token comment">// è‡ªå®šä¹‰å‚æ•°å£°æ˜å€¼</span>
                <span class="token punctuation">.</span><span class="token function">claim</span><span class="token punctuation">(</span><span class="token string">&quot;username&quot;</span><span class="token punctuation">,</span> nickname<span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">signWith</span><span class="token punctuation">(</span><span class="token class-name">SignatureAlgorithm</span><span class="token punctuation">.</span><span class="token constant">HS256</span><span class="token punctuation">,</span> <span class="token constant">APP_SECRET</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">compact</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">return</span> <span class="token class-name">JwtToken</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">String</span> <span class="token function">getJwtToken</span><span class="token punctuation">(</span><span class="token class-name">String</span> id<span class="token punctuation">,</span> <span class="token class-name">String</span> username<span class="token punctuation">)</span><span class="token punctuation">{</span>

        <span class="token class-name">String</span> <span class="token class-name">JwtToken</span> <span class="token operator">=</span> <span class="token class-name">Jwts</span><span class="token punctuation">.</span><span class="token function">builder</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">setHeaderParam</span><span class="token punctuation">(</span><span class="token string">&quot;typ&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;JWT&quot;</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">setHeaderParam</span><span class="token punctuation">(</span><span class="token string">&quot;alg&quot;</span><span class="token punctuation">,</span> <span class="token string">&quot;HS256&quot;</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">setSubject</span><span class="token punctuation">(</span><span class="token constant">SUBJECT</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">setIssuedAt</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// ç­¾å‘æ—¶é—´</span>
                <span class="token punctuation">.</span><span class="token function">setExpiration</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">currentTimeMillis</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token constant">EXPIRE</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">claim</span><span class="token punctuation">(</span><span class="token string">&quot;id&quot;</span><span class="token punctuation">,</span> id<span class="token punctuation">)</span> <span class="token comment">// è‡ªå®šä¹‰å‚æ•°å£°æ˜å€¼</span>
                <span class="token punctuation">.</span><span class="token function">claim</span><span class="token punctuation">(</span><span class="token string">&quot;nickname&quot;</span><span class="token punctuation">,</span> username<span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">signWith</span><span class="token punctuation">(</span><span class="token class-name">SignatureAlgorithm</span><span class="token punctuation">.</span><span class="token constant">HS256</span><span class="token punctuation">,</span> <span class="token constant">APP_SECRET</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">compact</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token class-name">JwtToken</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token doc-comment comment">/**
     * éªŒè¯ token æ˜¯å¦å­˜åœ¨ä¸”æœ‰æ•ˆ
     * <span class="token keyword">@param</span> <span class="token parameter">jwtToken</span>
     * <span class="token keyword">@return</span>
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">boolean</span> <span class="token function">validateToken</span><span class="token punctuation">(</span><span class="token class-name">String</span> jwtToken<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token class-name">StringUtils</span><span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span>jwtToken<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token class-name">Jwts</span><span class="token punctuation">.</span><span class="token function">parser</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setSigningKey</span><span class="token punctuation">(</span><span class="token constant">APP_SECRET</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">parseClaimsJws</span><span class="token punctuation">(</span>jwtToken<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token doc-comment comment">/**
     * éªŒè¯ token æ˜¯å¦å­˜åœ¨ä¸”æœ‰æ•ˆ
     * <span class="token keyword">@param</span> <span class="token parameter">request</span>
     * <span class="token keyword">@return</span>
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">boolean</span> <span class="token function">checkToken</span><span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span> request<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token class-name">String</span> jwtToken <span class="token operator">=</span> request<span class="token punctuation">.</span><span class="token function">getHeader</span><span class="token punctuation">(</span><span class="token string">&quot;token&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token class-name">StringUtils</span><span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span>jwtToken<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
            <span class="token class-name">Jwts</span><span class="token punctuation">.</span><span class="token function">parser</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setSigningKey</span><span class="token punctuation">(</span><span class="token constant">APP_SECRET</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">parseClaimsJws</span><span class="token punctuation">(</span>jwtToken<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token doc-comment comment">/**
     * æ ¹æ®tokenè·å–ä¼šå‘˜id
     * <span class="token keyword">@param</span> <span class="token parameter">request</span>
     * <span class="token keyword">@return</span>
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">String</span> <span class="token function">getMemberIdByJwtToken</span><span class="token punctuation">(</span><span class="token class-name">HttpServletRequest</span> request<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token class-name">String</span> jwtToken <span class="token operator">=</span> request<span class="token punctuation">.</span><span class="token function">getHeader</span><span class="token punctuation">(</span><span class="token string">&quot;token&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token class-name">StringUtils</span><span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span>jwtToken<span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token keyword">return</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">;</span>
        <span class="token class-name">Jws</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Claims</span><span class="token punctuation">&gt;</span></span> claimsJws <span class="token operator">=</span> <span class="token class-name">Jwts</span><span class="token punctuation">.</span><span class="token function">parser</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setSigningKey</span><span class="token punctuation">(</span><span class="token constant">APP_SECRET</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">parseClaimsJws</span><span class="token punctuation">(</span>jwtToken<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token class-name">Claims</span> claims <span class="token operator">=</span> claimsJws<span class="token punctuation">.</span><span class="token function">getBody</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">)</span>claims<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;id&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>ç™»é™†ä¸šåŠ¡ä½¿ç”¨ JWT è¿›è¡Œè·¨åŸŸèº«ä»½éªŒè¯ï¼Œåœ¨ <code>edu-service-ucenter</code> å­æ¨¡å—ServiceæœåŠ¡ç±» <code>UcenterMemberServiceImpl.java</code> <code>login()</code> æ–¹æ³•ä¸­</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Override</span>
<span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">login</span><span class="token punctuation">(</span><span class="token class-name">UcenterMember</span> ucenterMember<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token class-name">String</span> phone <span class="token operator">=</span> ucenterMember<span class="token punctuation">.</span><span class="token function">getMobile</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">String</span> password <span class="token operator">=</span> ucenterMember<span class="token punctuation">.</span><span class="token function">getPassword</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name">ObjectUtils</span><span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span>phone<span class="token punctuation">)</span><span class="token operator">||</span><span class="token class-name">ObjectUtils</span><span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span>password<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">CustomizeApiException</span><span class="token punctuation">(</span><span class="token number">20001</span><span class="token punctuation">,</span><span class="token string">&quot;æ‰‹æœºå·å’Œå¯†ç ä¸ºç©º&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  
    <span class="token comment">//åˆ¤æ–­æ‰‹æœºå·æ˜¯å¦æ­£ç¡®</span>
    <span class="token comment">//...çœç•¥ä»£ç </span>

    <span class="token comment">//åˆ¤æ–­å¯†ç æ˜¯å¦ç›¸ç­‰</span>
    <span class="token comment">//...çœç•¥ä»£ç </span>

    <span class="token comment">//åˆ¤æ–­ç”¨æˆ·æ˜¯å¦è¢«ç¦ç”¨</span>
    <span class="token comment">//...çœç•¥ä»£ç </span>

    <span class="token comment">//ç™»å½•æˆåŠŸ</span>
    <span class="token comment">//æŒ‰ç…§jwtç”Ÿäº§tokenè¿”å›</span>
    <span class="token class-name">String</span> token <span class="token operator">=</span> <span class="token class-name">JwtUtils</span><span class="token punctuation">.</span><span class="token function">createToken</span><span class="token punctuation">(</span>mobileMember<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> mobileMember<span class="token punctuation">.</span><span class="token function">getNickname</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> token<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Controllerå±‚ç±»<code>UcenterMemberController</code>è°ƒç”¨Serviceå±‚<code>login()</code>æ–¹æ³•ï¼Œè¿”å›tokenä¿¡æ¯åˆ°å‰ç«¯</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token doc-comment comment">/**
 * ä½¿ç”¨æ‰‹æœºå·å’Œå¯†ç ç™»é™†
 * <span class="token keyword">@param</span> <span class="token parameter">ucenterMember</span>
 * <span class="token keyword">@return</span>
 */</span>
<span class="token annotation punctuation">@PostMapping</span><span class="token punctuation">(</span><span class="token string">&quot;login&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token class-name">CommonResult</span> <span class="token function">login</span><span class="token punctuation">(</span><span class="token annotation punctuation">@RequestBody</span> <span class="token class-name">UcenterMember</span> ucenterMember<span class="token punctuation">)</span><span class="token punctuation">{</span>
    <span class="token class-name">String</span> token <span class="token operator">=</span>ucenterMemberService<span class="token punctuation">.</span><span class="token function">login</span><span class="token punctuation">(</span>ucenterMember<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token class-name">CommonResult</span><span class="token punctuation">.</span><span class="token function">success</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">data</span><span class="token punctuation">(</span><span class="token string">&quot;token&quot;</span><span class="token punctuation">,</span>token<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ol><p>å‚è€ƒæ–‡ç« ï¼š</p><ul><li><p><a href="https://segmentfault.com/a/1190000021224288" target="_blank" rel="noopener noreferrer">åŸºäºJWTå®ç°çš„Tokenèº«ä»½è®¤è¯<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p></li><li><p><a href="https://segmentfault.com/a/1190000038434077" target="_blank" rel="noopener noreferrer">JWTè·¨è¶Šè®¤è¯è¯¦è§£åŠåº”ç”¨åœºæ™¯<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p></li><li><p><a href="https://segmentfault.com/a/1190000040003653" target="_blank" rel="noopener noreferrer">SpringBootæ•´åˆJWT<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p></li><li><p><a href="https://www.zhihu.com/question/19786827" target="_blank" rel="noopener noreferrer">Cookie å’Œ Session çš„åŒºåˆ«<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p></li></ul><h2 id="springboot-æ•´åˆé˜¿é‡Œäº‘çŸ­ä¿¡æœåŠ¡" tabindex="-1"><a class="header-anchor" href="#springboot-æ•´åˆé˜¿é‡Œäº‘çŸ­ä¿¡æœåŠ¡" aria-hidden="true">#</a> SpringBoot æ•´åˆé˜¿é‡Œäº‘çŸ­ä¿¡æœåŠ¡</h2><p>é˜¿é‡Œäº‘çŸ­ä¿¡æœåŠ¡å¯ç”¨äºéªŒè¯ç å‘é€ï¼ŒçŸ­ä¿¡é€šçŸ¥ä»¥åŠæ¨å¹¿çŸ­ä¿¡ç­‰ä¸šåŠ¡ã€‚é˜¿é‡Œäº‘çŸ­ä¿¡æœåŠ¡éœ€è¦å¼€é€šçŸ­ä¿¡æœåŠ¡ï¼Œå¼€é€šæ­¥éª¤å¦‚ä¸‹ï¼š</p><ol><li><p>ç™»é™†<a href="https://www.aliyun.com/?utm_content=se_1008364713" target="_blank" rel="noopener noreferrer">é˜¿é‡Œäº‘å®˜ç½‘<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>ï¼Œé€‰æ‹©<a href="https://www.aliyun.com/product/sms?spm=5176.19720258.J_3207526240.38.7b8176f4jD4U88" target="_blank" rel="noopener noreferrer">çŸ­ä¿¡æœåŠ¡<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>ä¸­<strong>å…è´¹å¼€é€š</strong>åŠŸèƒ½</p><p><img src="https://eduimage1.oss-cn-beijing.aliyuncs.com/img/image-20221021103639198.png" alt="image-20221021103639198" loading="lazy"></p></li><li><p>æ·»åŠ ç­¾åç®¡ç†ï¼Œé€‰æ‹©<strong>å›½å†…æ¶ˆæ¯-ç­¾åç®¡ç†-æ·»åŠ ç­¾å</strong>ï¼Œè¾“å…¥ç›¸å…³ä¿¡æ¯åæäº¤</p><p><img src="https://eduimage1.oss-cn-beijing.aliyuncs.com/img/image-20221021104725962.png" alt="image-20221021104725962" loading="lazy"></p></li><li><p>æ·»åŠ æ¨¡ç‰ˆç®¡ç†ï¼Œé€‰æ‹©<strong>å›½å†…æ¶ˆæ¯-æ¨¡ç‰ˆç®¡ç†-æ·»åŠ æ¨¡ç‰ˆ</strong>ï¼Œè¾“å…¥ç›¸å…³ä¿¡æ¯åæ·»åŠ </p><img src="https://eduimage1.oss-cn-beijing.aliyuncs.com/img/image-20221021110428025.png" alt="image-20221021110428025" style="zoom:50%;"></li></ol><p>å¼€é€šçŸ­ä¿¡æœåŠ¡å®¡æ ¸é€šè¿‡ä¹‹åï¼Œä¾¿å¯ä»¥ä½¿ç”¨çŸ­ä¿¡æœåŠ¡ï¼Œedué¡¹ç›®ä¸­æ•´åˆé˜¿é‡Œäº‘çŸ­ä¿¡æœåŠ¡æ­¥éª¤å¦‚ä¸‹ï¼š</p><ol><li><p>ç™»é™†é˜¿é‡Œäº‘ï¼Œç‚¹å‡»å³ä¸Šè§’å¤´åƒAccessKeyç®¡ç†ï¼Œåˆ›å»ºä½ çš„AccessKey</p><img src="https://eduimage1.oss-cn-beijing.aliyuncs.com/img/image-20221021133614371.png" alt="image-20221021133614371" style="zoom:50%;"><p>ä¹‹åè®°ä½ä½ çš„<code>AccessKey ID</code> å’Œ <code>AccessKey Secret</code></p></li><li><p>åˆ›å»ºçŸ­ä¿¡å‘é€æ¨¡å—<code>edu-service-msm</code>ï¼Œ<code>application.properies</code> æ–‡ä»¶é…ç½®é˜¿é‡Œäº‘<code>AccessKey ID</code> å’Œ <code>AccessKey Secret</code></p><div class="language-properties line-numbers-mode" data-ext="properties"><pre class="language-properties"><code><span class="token key attr-name">aliyun.msm.file.keyid</span><span class="token punctuation">=</span><span class="token value attr-value">ä½ çš„keyid</span>
<span class="token key attr-name">aliyun.msm.file.keysecret</span><span class="token punctuation">=</span><span class="token value attr-value">ä½ çš„keysecret</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><p>åˆ›å»ºé…ç½®å·¥å…·ç±»<code>AliyunMsmConfigConstant</code>è·å–é…ç½®æ–‡ä»¶<code>AccessKey ID</code> å’Œ <code>AccessKey Secret</code></p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>beans<span class="token punctuation">.</span>factory<span class="token punctuation">.</span></span><span class="token class-name">InitializingBean</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>beans<span class="token punctuation">.</span>factory<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Value</span></span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token import"><span class="token namespace">org<span class="token punctuation">.</span>springframework<span class="token punctuation">.</span>context<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">Configuration</span></span><span class="token punctuation">;</span>

<span class="token annotation punctuation">@Configuration</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">AliyunMsmConfigConstant</span> <span class="token keyword">implements</span> <span class="token class-name">InitializingBean</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Value</span><span class="token punctuation">(</span><span class="token string">&quot;${aliyun.msm.file.keyid}&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> keyId<span class="token punctuation">;</span>
    <span class="token annotation punctuation">@Value</span><span class="token punctuation">(</span><span class="token string">&quot;${aliyun.msm.file.keysecret}&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> keySecret<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">String</span> <span class="token constant">ACCESS_KEY_ID</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">String</span> <span class="token constant">ACCESS_KEY_SECRET</span><span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">afterPropertiesSet</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
        <span class="token constant">ACCESS_KEY_ID</span> <span class="token operator">=</span> keyId<span class="token punctuation">;</span>
        <span class="token constant">ACCESS_KEY_SECRET</span> <span class="token operator">=</span> keySecret<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>pomæ–‡ä»¶ä¸­å¼•å…¥ç›¸å…³ä¾èµ–</p><div class="language-xml line-numbers-mode" data-ext="xml"><pre class="language-xml"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">&gt;</span></span>com.aliyun<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">&gt;</span></span>dysmsapi20170525<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">&gt;</span></span>2.0.22<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">&gt;</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>åˆ›å»ºå‘é€çŸ­ä¿¡å·¥å…·ç±»<code>SendSmsUtils</code></p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SendSmsUtils</span> <span class="token punctuation">{</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">boolean</span> <span class="token function">send</span><span class="token punctuation">(</span><span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> param<span class="token punctuation">,</span> <span class="token class-name">String</span> phone<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
        <span class="token class-name">Client</span> client <span class="token operator">=</span> <span class="token class-name">SendSmsUtils</span><span class="token punctuation">.</span><span class="token function">createClient</span><span class="token punctuation">(</span><span class="token class-name">AliyunMsmConfigConstant</span><span class="token punctuation">.</span><span class="token constant">ACCESS_KEY_ID</span><span class="token punctuation">,</span>
                <span class="token class-name">AliyunMsmConfigConstant</span><span class="token punctuation">.</span><span class="token constant">ACCESS_KEY_SECRET</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token class-name">SendSmsRequest</span> sendSmsRequest <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SendSmsRequest</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token punctuation">.</span><span class="token function">setSignName</span><span class="token punctuation">(</span><span class="token string">&quot;é˜¿é‡Œäº‘çŸ­ä¿¡æµ‹è¯•&quot;</span><span class="token punctuation">)</span>      <span class="token comment">// çŸ­ä¿¡ç­¾ååç§°</span>
                <span class="token punctuation">.</span><span class="token function">setTemplateCode</span><span class="token punctuation">(</span><span class="token string">&quot;SMS_154950909&quot;</span><span class="token punctuation">)</span> <span class="token comment">// çŸ­ä¿¡æ¨¡ç‰ˆ</span>
                <span class="token punctuation">.</span><span class="token function">setPhoneNumbers</span><span class="token punctuation">(</span>phone<span class="token punctuation">)</span>           <span class="token comment">// æ¥æ”¶çŸ­ä¿¡çš„æ‰‹æœºå·</span>
                <span class="token punctuation">.</span><span class="token function">setTemplateParam</span><span class="token punctuation">(</span><span class="token class-name">JSONObject</span><span class="token punctuation">.</span><span class="token function">toJSONString</span><span class="token punctuation">(</span>param<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// çŸ­ä¿¡æ¨¡ç‰ˆå¯¹åº”çš„å˜é‡å€¼</span>
        <span class="token comment">// å¤åˆ¶ä»£ç è¿è¡Œè¯·è‡ªè¡Œæ‰“å° API çš„è¿”å›å€¼</span>
        <span class="token class-name">SendSmsResponse</span> response <span class="token operator">=</span> client<span class="token punctuation">.</span><span class="token function">sendSms</span><span class="token punctuation">(</span>sendSmsRequest<span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token keyword">if</span> <span class="token punctuation">(</span>response<span class="token punctuation">.</span><span class="token function">getBody</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span><span class="token string">&quot;OK&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token doc-comment comment">/**
     * ä½¿ç”¨AK&amp;SKåˆå§‹åŒ–è´¦å·Client
     * <span class="token keyword">@param</span> <span class="token parameter">accessKeyId</span>
     * <span class="token keyword">@param</span> <span class="token parameter">accessKeySecret</span>
     * <span class="token keyword">@return</span>
     * <span class="token keyword">@throws</span> <span class="token reference"><span class="token class-name">Exception</span></span>
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">Client</span> <span class="token function">createClient</span><span class="token punctuation">(</span><span class="token class-name">String</span> accessKeyId<span class="token punctuation">,</span> <span class="token class-name">String</span> accessKeySecret<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
        <span class="token class-name">Config</span> config <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Config</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token comment">// æ‚¨çš„AccessKey ID</span>
                <span class="token punctuation">.</span><span class="token function">setAccessKeyId</span><span class="token punctuation">(</span>accessKeyId<span class="token punctuation">)</span>
                <span class="token comment">// æ‚¨çš„AccessKey Secret</span>
                <span class="token punctuation">.</span><span class="token function">setAccessKeySecret</span><span class="token punctuation">(</span>accessKeySecret<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment">// è®¿é—®çš„åŸŸå</span>
        config<span class="token punctuation">.</span>endpoint <span class="token operator">=</span> <span class="token string">&quot;dysmsapi.aliyuncs.com&quot;</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Client</span><span class="token punctuation">(</span>config<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="custom-container warning"><p class="custom-container-title">Note</p><p>ä»¥ä¸Šä»£ç ä¸ºæµ‹è¯•çŸ­ä¿¡å‘é€åŠŸèƒ½ä»£ç å®ç°ï¼Œå‚è€ƒ<a href="https://next.api.aliyun.com/api/Dysmsapi/2017-05-25/SendSms?tab=DOC" target="_blank" rel="noopener noreferrer">æµ‹è¯•ä¸“ç”¨ç­¾åæ¨¡ç‰ˆ<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><p><img src="https://eduimage1.oss-cn-beijing.aliyuncs.com/img/image-20221021145011912.png" alt="image-20221021145011912" loading="lazy"></p><p>å…·ä½“çŸ­ä¿¡å‘é€åŠŸèƒ½è§<a href="https://next.api.aliyun.com/api/Dysmsapi/2017-05-25/SendSms?spm=api-workbench.SDK%20Document.0.0.487d1e0fc7gK1e&amp;lang=JAVA" target="_blank" rel="noopener noreferrer">å®˜æ–¹API<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>ï¼Œä¸Šè¿°<code>send()</code>æ–¹æ³•ä¸­çš„<code>.setSignName()</code>å’Œ<code>.setTemplateCode()</code>éœ€è¦ä¼ å…¥ä¸ªäººæå‰ç”³è¯·çš„ç­¾åå’Œæ¨¡ç‰ˆåç§°</p></div></li><li><p>Controllerå±‚è°ƒç”¨çŸ­ä¿¡å‘é€å·¥å…·ç±»çŸ­ä¿¡å‘é€<code>send()</code>æ–¹æ³•</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">&quot;send/{phone}&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token class-name">CommonResult</span> <span class="token function">sendMsm</span><span class="token punctuation">(</span><span class="token annotation punctuation">@PathVariable</span> <span class="token class-name">String</span> phone<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
    <span class="token comment">// ä»redisä¸­è·å–éªŒè¯ç ï¼Œå¦‚æœè·å–åˆ°ç›´æ¥è¿”å›</span>
    <span class="token class-name">String</span> code <span class="token operator">=</span> redisTemplate<span class="token punctuation">.</span><span class="token function">opsForValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>phone<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token class-name">ObjectUtils</span><span class="token punctuation">.</span><span class="token function">isEmpty</span><span class="token punctuation">(</span>code<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token class-name">CommonResult</span><span class="token punctuation">.</span><span class="token function">success</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// å¦‚æœredisè·å–ä¸åˆ°ï¼Œè¿›è¡Œé˜¿é‡Œäº‘å‘é€</span>
    <span class="token comment">// ç”Ÿæˆå››ä½éšæœºæ•°ï¼Œä½œä¸ºçŸ­ä¿¡æ¨¡ç‰ˆå¯¹åº”çš„å˜é‡å€¼ï¼Œä¼ é€’é˜¿é‡Œäº‘è¿›è¡Œå‘é€</span>
    code <span class="token operator">=</span> <span class="token class-name">RandomUtil</span><span class="token punctuation">.</span><span class="token function">getFourBitRandom</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> param <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">HashMap</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    param<span class="token punctuation">.</span><span class="token function">put</span><span class="token punctuation">(</span><span class="token string">&quot;code&quot;</span><span class="token punctuation">,</span>code<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// è°ƒç”¨ Service å‘é€çŸ­ä¿¡æœåŠ¡</span>
    <span class="token keyword">boolean</span> isSend <span class="token operator">=</span> msmService<span class="token punctuation">.</span><span class="token function">send</span><span class="token punctuation">(</span>param<span class="token punctuation">,</span>phone<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>isSend<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">//é˜¿é‡Œäº‘å‘é€æˆåŠŸï¼ŒæŠŠå‘é€æˆåŠŸçš„éªŒè¯ç æ”¾å…¥redisç¼“å­˜ä¸­</span>
        <span class="token comment">//è®¾ç½®æœ‰æ•ˆæ—¶é—´</span>
        redisTemplate<span class="token punctuation">.</span><span class="token function">opsForValue</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">set</span><span class="token punctuation">(</span>phone<span class="token punctuation">,</span>code<span class="token punctuation">,</span><span class="token number">5</span><span class="token punctuation">,</span> <span class="token class-name">TimeUnit</span><span class="token punctuation">.</span><span class="token constant">MINUTES</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token class-name">CommonResult</span><span class="token punctuation">.</span><span class="token function">success</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token keyword">else</span>
        <span class="token keyword">return</span> <span class="token class-name">CommonResult</span><span class="token punctuation">.</span><span class="token function">setCommonResult</span><span class="token punctuation">(</span><span class="token class-name">ResultCode</span><span class="token punctuation">.</span><span class="token constant">ERROR</span><span class="token punctuation">,</span> <span class="token string">&quot;çŸ­ä¿¡å‘é€å¤±è´¥&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="custom-container tip"><p class="custom-container-title">Tips</p><p>ä¸Šè¿°ä»£ç ä¸­ç±»<code>RandomUtil</code>å®šä¹‰åœ¨é¡¹ç›®eduå­æ¨¡å—<code>edu-common-utils</code>ä¸‹ï¼Œ<code>code = RandomUtil.getFourBitRandom()</code>ç”Ÿæˆå››ä½éšæœºæ•°ï¼Œä½œä¸ºçŸ­ä¿¡æ¨¡ç‰ˆå¯¹åº”çš„å˜é‡å€¼</p></div></li><li><p>è°ƒç”¨æ¥å£<code>http://localhost:8005/edumsm/msm/send/13588825895</code>ï¼Œæœ€ç»ˆæµ‹è¯•ç»“æœå¦‚ä¸‹</p><img src="https://eduimage1.oss-cn-beijing.aliyuncs.com/img/image-20221022191804319.png" alt="image-20221022191804319" style="zoom:20%;"></li></ol><p>å‚è€ƒæ–‡ç« ï¼š</p><ul><li><p><a href="https://dysms.console.aliyun.com/quickstart?spm=5176.25163407.domtextsigncreate-index-1ec3c_58c50_0.1.2c0bbb6evJyyEL" target="_blank" rel="noopener noreferrer">çŸ­ä¿¡æœåŠ¡å¿«é€Ÿå­¦ä¹ <span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p></li><li><p><a href="https://next.api.aliyun.com/api-tools/sdk/Dysmsapi?version=2017-05-25&amp;language=java-tea" target="_blank" rel="noopener noreferrer">çŸ­ä¿¡æœåŠ¡å‡çº§ç‰ˆSDK<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p></li></ul><h2 id="springboot-æ•´åˆè·³è½¬å¾®ä¿¡ç™»å½•" tabindex="-1"><a class="header-anchor" href="#springboot-æ•´åˆè·³è½¬å¾®ä¿¡ç™»å½•" aria-hidden="true">#</a> SpringBoot æ•´åˆè·³è½¬å¾®ä¿¡ç™»å½•</h2><p>å¦‚æœä½ çš„åº”ç”¨éœ€è¦é€šè¿‡è·³è½¬å¾®ä¿¡æ¥å®ç°ç™»é™†æ“ä½œï¼Œé¦–å…ˆéœ€è¦åœ¨<a href="https://open.weixin.qq.com/" target="_blank" rel="noopener noreferrer">å¾®ä¿¡å¼€æ”¾å¹³å°<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>æ³¨å†Œè´¦å·å¹¶è¿›è¡Œä»¥ä¸‹æ“ä½œï¼Œæ­¥éª¤å¦‚ä¸‹ï¼š</p><ol><li><p>æ³¨å†Œè´¦å·å¹¶æ¿€æ´»é‚®ç®±</p></li><li><p>å®Œå–„å¼€å‘è€…èµ„æ–™</p></li><li><p>å¼€å‘è€…èµ„æ–™è®¤è¯</p></li><li><p>åˆ›å»ºç½‘ç«™åº”ç”¨ï¼Œå¾®ä¿¡ç™»é™†æµç¨‹å‚è€ƒ<a href="https://open.weixin.qq.com/cgi-bin/showdocument?action=dir_list&amp;t=resource/res_list&amp;verify=1&amp;id=open1419316505&amp;token=e547653f995d8f402704d5cb2945177dc8aa4e7e&amp;lang=zh_CN" target="_blank" rel="noopener noreferrer">å®˜æ–¹æ–‡æ¡£<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p></li></ol><p>ä¹‹åä¾¿å¯ä»¥åœ¨åç«¯æ¥å…¥å¾®ä¿¡ç™»é™†ï¼Œå‚è€ƒ<a href="https://open.weixin.qq.com/cgi-bin/showdocument?action=dir_list&amp;t=resource/res_list&amp;verify=1&amp;id=open1419316505&amp;token=e547653f995d8f402704d5cb2945177dc8aa4e7e&amp;lang=zh_CN" target="_blank" rel="noopener noreferrer">æˆæƒå¾®ä¿¡ç™»é™†æµç¨‹<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>ï¼Œè·å–access_tokenæ—¶åºå›¾å¦‚ä¸‹ï¼š</p><p><img src="https://eduimage1.oss-cn-beijing.aliyuncs.com/img/image-20221022193948734.png" alt="image-20221022193948734" loading="lazy"></p><p>é¡¹ç›®eduåœ¨å­æ¨¡å—<code>edu-service-ucenter</code>æ¥å…¥å¾®ä¿¡ç™»é™†åŠŸèƒ½ï¼Œæ­¥éª¤å¦‚ä¸‹ï¼š</p><p>é¦–å…ˆè¦ç”Ÿæˆå¾®ä¿¡äºŒç»´ç ï¼Œ<strong>ç”Ÿæˆå¾®ä¿¡äºŒç»´ç </strong>æ­¥éª¤å¦‚ä¸‹ï¼š</p><ol><li><p><code>application.properties</code>æ·»åŠ ç›¸å…³é…ç½®ä¿¡æ¯</p><div class="language-properties line-numbers-mode" data-ext="properties"><pre class="language-properties"><code><span class="token comment"># å¾®ä¿¡å¼€æ”¾å¹³å° appid</span>
<span class="token key attr-name">wx.open.app_id</span><span class="token punctuation">=</span><span class="token value attr-value">ä½ çš„appid</span>
<span class="token comment"># å¾®ä¿¡å¼€æ”¾å¹³å°app_secret</span>
<span class="token key attr-name">wx.open.app_secret</span><span class="token punctuation">=</span><span class="token value attr-value">ä½ çš„app_secret</span>
<span class="token comment"># å¾®ä¿¡å¼€æ”¾å¹³å° é‡å®šå‘url</span>
<span class="token key attr-name">wx.open.redirect_url</span><span class="token punctuation">=</span><span class="token value attr-value">http://ä½ çš„æœåŠ¡å™¨åç§°/api/ucenter/wx/callback</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="custom-container tip"><p class="custom-container-title">Tips</p><p>å¦‚æœä½ ä»…ä»…æ˜¯ä¸ºäº†å­¦ä¹ ä½¿ç”¨ï¼Œä¸å¸Œæœ›æ³¨å†Œè®¤è¯å¾®ä¿¡å¼€æ”¾å¹³å°ï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹é…ç½®æ–‡ä»¶å†…å®¹è¿›è¡ŒåŠŸèƒ½æµ‹è¯•ï¼š</p><div class="language-properties line-numbers-mode" data-ext="properties"><pre class="language-properties"><code><span class="token key attr-name">server.port</span><span class="token punctuation">=</span><span class="token value attr-value">8160</span>
<span class="token comment"># å¾®ä¿¡å¼€æ”¾å¹³å° appid</span>
<span class="token key attr-name">wx.open.app_id</span><span class="token punctuation">=</span><span class="token value attr-value">wxed9954c01bb89b47</span>
<span class="token comment"># å¾®ä¿¡å¼€æ”¾å¹³å° appsecret</span>
<span class="token key attr-name">wx.open.app_secret</span><span class="token punctuation">=</span><span class="token value attr-value">a7482517235173ddb4083788de60b90e</span>
<span class="token comment"># å¾®ä¿¡å¼€æ”¾å¹³å° é‡å®šå‘url</span>
<span class="token key attr-name">wx.open.redirect_url</span><span class="token punctuation">=</span><span class="token value attr-value">http://localhost:8160/api/ucenter/wx/callback</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>å®æµ‹æœ‰æ•ˆï¼Œç«¯å£å·å¿…é¡»ä¸º8160</p></div></li><li><p>åˆ›å»ºå¾®ä¿¡å¼€æ”¾å¹³å°å¸¸é‡é…ç½®ç±»<code>ConstanWxtiesUtil</code></p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@Component</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ConstanWxtiesUtil</span> <span class="token keyword">implements</span> <span class="token class-name">InitializingBean</span> <span class="token punctuation">{</span>
    <span class="token annotation punctuation">@Value</span><span class="token punctuation">(</span><span class="token string">&quot;${wx.open.app_id}&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> appId<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Value</span><span class="token punctuation">(</span><span class="token string">&quot;${wx.open.app_secret}&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> appSecret<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Value</span><span class="token punctuation">(</span><span class="token string">&quot;${wx.open.redirect_url}&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">private</span> <span class="token class-name">String</span> redirectUrl<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">String</span> <span class="token constant">WX_OPEN_APP_ID</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">String</span> <span class="token constant">WX_OPEN_APP_SECRET</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token class-name">String</span> <span class="token constant">WX_OPEN_REDIRECT_URL</span><span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">afterPropertiesSet</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
        <span class="token constant">WX_OPEN_APP_ID</span> <span class="token operator">=</span> appId<span class="token punctuation">;</span>
        <span class="token constant">WX_OPEN_APP_SECRET</span> <span class="token operator">=</span> appSecret<span class="token punctuation">;</span>
        <span class="token constant">WX_OPEN_REDIRECT_URL</span> <span class="token operator">=</span> redirectUrl<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p>åˆ›å»ºå¾®ä¿¡ç™»é™†Controllerç±»<code>WxApiController</code>ï¼Œç”Ÿæˆå¾®ä¿¡æ‰«ç ç™»é™†äºŒç»´ç </p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@CrossOrigin</span>
<span class="token annotation punctuation">@Controller</span> <span class="token comment">// åªè¯·æ±‚åœ°å€ï¼Œä¸è¿”å›æ•°æ®</span>
<span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/api/ucenter/wx&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">WxApiController</span> <span class="token punctuation">{</span>

    <span class="token annotation punctuation">@Autowired</span>
    <span class="token keyword">private</span> <span class="token class-name">UcenterMemberService</span> ucenterMemberService<span class="token punctuation">;</span>

    <span class="token doc-comment comment">/**
     * ç”Ÿæˆå¾®ä¿¡äºŒç»´ç 
     * <span class="token keyword">@return</span>
     */</span>
    <span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">&quot;login&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getWxCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        <span class="token comment">// å¾®ä¿¡å¼€æ”¾å¹³å°æˆæƒbaseUrl</span>
        <span class="token comment">//? %sç›¸å½“äºå ä½ç¬¦ï¼Œå¯ä»¥å¡«å……å‚æ•°</span>
        <span class="token comment">// ç”Ÿæˆå¾®ä¿¡äºŒç»´ç â€”â€”ç¬¬ä¸€æ­¥è¯·æ±‚Codeçš„é“¾æ¥</span>
        <span class="token class-name">String</span> baseUrl <span class="token operator">=</span> <span class="token string">&quot;https://open.weixin.qq.com/connect/qrconnect&quot;</span> <span class="token operator">+</span>
                <span class="token string">&quot;?appid=%s&quot;</span> <span class="token operator">+</span>
                <span class="token string">&quot;&amp;redirect_uri=%s&quot;</span> <span class="token operator">+</span>
                <span class="token string">&quot;&amp;response_type=code&quot;</span> <span class="token operator">+</span>
                <span class="token string">&quot;&amp;scope=snsapi_login&quot;</span> <span class="token operator">+</span>
                <span class="token string">&quot;&amp;state=%s&quot;</span> <span class="token operator">+</span>
                <span class="token string">&quot;#wechat_redirect&quot;</span><span class="token punctuation">;</span>
        <span class="token comment">//æˆæƒç éœ€è¦ä¼ å…¥åŠ å¯†è¿‡çš„URL,å¿…é¡»ä½¿ç”¨</span>
        <span class="token class-name">String</span> redirectUrl <span class="token operator">=</span> <span class="token class-name">ConstanWxtiesUtil</span><span class="token punctuation">.</span><span class="token constant">WX_OPEN_REDIRECT_URL</span><span class="token punctuation">;</span><span class="token comment">//è·å–ä¸šåŠ¡æœåŠ¡å™¨é‡å®šå‘åœ°å€</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            redirectUrl <span class="token operator">=</span> <span class="token class-name">URLEncoder</span><span class="token punctuation">.</span><span class="token function">encode</span><span class="token punctuation">(</span>redirectUrl<span class="token punctuation">,</span><span class="token string">&quot;utf-8&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//urlç¼–ç </span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">UnsupportedEncodingException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>

        <span class="token comment">//ä¼ é€’å‚æ•°ï¼Œå‘baseUrlä¸­çš„å ä½ç¬¦%sä¼ é€’å‚æ•°å€¼</span>
        <span class="token class-name">String</span> url <span class="token operator">=</span> <span class="token class-name">String</span><span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span>
                baseUrl<span class="token punctuation">,</span>
                <span class="token class-name">ConstanWxtiesUtil</span><span class="token punctuation">.</span><span class="token constant">WX_OPEN_APP_ID</span><span class="token punctuation">,</span>
                redirectUrl<span class="token punctuation">,</span>
                <span class="token string">&quot;codinglife&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

        <span class="token comment">//è¯·æ±‚å¾®ä¿¡åœ°å€,é‡å®šå‘çš„æ–¹å¼</span>
        <span class="token comment">//ç±»ä¼¼äºï¼š&quot;redirect:http://localhost:3000&quot;</span>
        <span class="token keyword">return</span> <span class="token string">&quot;redirect:&quot;</span> <span class="token operator">+</span> url<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="custom-container tip"><p class="custom-container-title">ä»£ç ç†è§£</p><p><code>getWxCode()</code> æ–¹æ³•ç”¨äºç”Ÿæˆå¾®ä¿¡ç™»é™†äºŒç»´ç ï¼Œä»£ç ä¸­å®šä¹‰çš„<code>baseUrl</code>ä¸º<a href="https://open.weixin.qq.com/cgi-bin/showdocument?action=dir_list&amp;t=resource/res_list&amp;verify=1&amp;id=open1419316505&amp;token=e547653f995d8f402704d5cb2945177dc8aa4e7e&amp;lang=zh_CN" target="_blank" rel="noopener noreferrer">æˆæƒå¾®ä¿¡ç™»é™†æµç¨‹<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a><strong>ç¬¬ä¸€æ­¥ï¼šè¯·æ±‚CODE</strong>çš„é“¾æ¥ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚</p><p><img src="https://eduimage1.oss-cn-beijing.aliyuncs.com/img/image-20221022194937799.png" alt="image-20221022194937799" loading="lazy"></p></div><p>æµ‹è¯•ç»“æœï¼š</p><img src="https://eduimage1.oss-cn-beijing.aliyuncs.com/img/image-20221022195551610.png" alt="image-20221022195551610" style="zoom:40%;"></li></ol><p>ä¸Šè¿°ä»£ç ç”Ÿæˆæ‰«æäºŒç»´ç ä¹‹åï¼Œå¾®ä¿¡ç”¨æˆ·ä½¿ç”¨å¾®ä¿¡æ‰«æäºŒç»´ç å¹¶ä¸”ç¡®è®¤ç™»å½•åï¼ŒPCç«¯ä¼šè·³è½¬åˆ°é…ç½®å¥½çš„åŸŸååœ°å€ï¼š<code>http://å›è°ƒåœ°å€/api/ucenter/wx/callback</code>ï¼ˆåœ¨<code>application.properties</code>é…ç½®çš„<code>wx.open.redirect_url</code>ï¼‰ï¼Œä¸ºäº†æ–¹ä¾¿åœ¨æœ¬åœ°åšæµ‹è¯•ï¼Œå¯ä»¥åœ¨<code>WxApiController</code>ç±»ä¸­å®šä¹‰ä¸€ä¸ªå›è°ƒæ–¹æ³•<code>callback()</code>ï¼Œå®é™…é¡¹ç›®å¼€å‘ä¸­æ— éœ€åšæ­¤æ“ä½œï¼Œéƒ¨ç½²é¡¹ç›®æ—¶ä¼šé…ç½®å¥½å›è°ƒåœ°å€ï¼Œ<code>callback()</code>æ–¹æ³•å¦‚ä¸‹ï¼š</p><div class="language-java line-numbers-mode" data-ext="java"><pre class="language-java"><code><span class="token annotation punctuation">@CrossOrigin</span>
<span class="token annotation punctuation">@Controller</span> <span class="token comment">// åªè¯·æ±‚åœ°å€ï¼Œä¸è¿”å›æ•°æ®</span>
<span class="token annotation punctuation">@RequestMapping</span><span class="token punctuation">(</span><span class="token string">&quot;/api/ucenter/wx&quot;</span><span class="token punctuation">)</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">WxApiController</span> <span class="token punctuation">{</span>
    <span class="token doc-comment comment">/**
     * è·å–æ‰«æäººä¿¡æ¯ï¼Œæ·»åŠ æ•°æ®
     * <span class="token keyword">@param</span> <span class="token parameter">code</span>
     * <span class="token keyword">@param</span> <span class="token parameter">state</span>
     * <span class="token keyword">@param</span> <span class="token parameter">session</span>
     * <span class="token keyword">@return</span>
     */</span>
    <span class="token annotation punctuation">@GetMapping</span><span class="token punctuation">(</span><span class="token string">&quot;callback&quot;</span><span class="token punctuation">)</span>
    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">callback</span><span class="token punctuation">(</span><span class="token class-name">String</span> code<span class="token punctuation">,</span> <span class="token class-name">String</span> state<span class="token punctuation">,</span> <span class="token class-name">HttpSession</span> session<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">{</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token comment">//(1)å¾—åˆ°æˆæƒä¸´æ—¶ç¥¨æ®code</span>

            <span class="token comment">//(2)æ‹¿ç€codeè¯·æ±‚å¾®ä¿¡å¼€æ”¾å¹³å°çš„å›ºå®šåœ°å€accessTokenUrlï¼Œå¾—åˆ°ä¸¤ä¸ªå€¼access_tokenã€è®¿é—®å‡­è¯ã€‘å’Œopenidã€æ¯ä¸ªå¾®ä¿¡å”¯ä¸€å‡­è¯ã€‘</span>
            <span class="token class-name">String</span> baseAccessTokenUrl <span class="token operator">=</span> <span class="token string">&quot;https://api.weixin.qq.com/sns/oauth2/access_token&quot;</span> <span class="token operator">+</span>
                    <span class="token string">&quot;?appid=%s&quot;</span> <span class="token operator">+</span>
                    <span class="token string">&quot;&amp;secret=%s&quot;</span> <span class="token operator">+</span>
                    <span class="token string">&quot;&amp;code=%s&quot;</span> <span class="token operator">+</span>
                    <span class="token string">&quot;&amp;grant_type=authorization_code&quot;</span><span class="token punctuation">;</span>

            <span class="token class-name">String</span> accessTokenUrl <span class="token operator">=</span> <span class="token class-name">String</span><span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span>baseAccessTokenUrl<span class="token punctuation">,</span>
                    <span class="token class-name">ConstanWxtiesUtil</span><span class="token punctuation">.</span><span class="token constant">WX_OPEN_APP_ID</span><span class="token punctuation">,</span>
                    <span class="token class-name">ConstanWxtiesUtil</span><span class="token punctuation">.</span><span class="token constant">WX_OPEN_APP_SECRET</span><span class="token punctuation">,</span>
                    code<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">//è¯·æ±‚æ‹¼æ¥å¥½çš„åœ°å€accessTokenUrlã€codeåŠ ä¸Šappidå’Œaccess_tokenã€‘ï¼Œè¿”å›ä¸¤ä¸ªå€¼access_tokenå’Œopenid</span>
            <span class="token comment">//ä½¿ç”¨httpclientå‘é€è¯·æ±‚ï¼ŒHttpClientä¸éœ€è¦é€šè¿‡æµè§ˆå™¨è¿›è¡Œåœ°å€è¯·æ±‚ï¼Œå¾—åˆ°è¿”å›ç»“æœ</span>
            <span class="token class-name">String</span> accessTokenInfo <span class="token operator">=</span> <span class="token class-name">HttpClientUtils</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>accessTokenUrl<span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token comment">//ä½¿ç”¨gsonè½¬æ¢å·¥å…·Gson</span>
            <span class="token class-name">Gson</span> gson <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Gson</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">HashMap</span> mapAccessToken <span class="token operator">=</span> gson<span class="token punctuation">.</span><span class="token function">fromJson</span><span class="token punctuation">(</span>accessTokenInfo<span class="token punctuation">,</span> <span class="token class-name">HashMap</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

            <span class="token class-name">String</span> access_token <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">)</span>mapAccessToken<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;access_token&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token class-name">String</span> openid <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">)</span>mapAccessToken<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;openid&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>


            <span class="token comment">//åˆ¤æ–­è¯¥å¾®ä¿¡ä¿¡æ¯æ˜¯å¦æ³¨å†Œè¿‡</span>
            <span class="token class-name">UcenterMember</span> member <span class="token operator">=</span> ucenterMemberService<span class="token punctuation">.</span><span class="token function">getMemberByOperid</span><span class="token punctuation">(</span>openid<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>member <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
                <span class="token comment">//(3)æ‹¿ç€access_tokenå’Œopenidï¼Œå†å»è¯·æ±‚å¾®ä¿¡æä¾›çš„å›ºå®šåœ°å€ï¼Œè·å–æ‰«æäººä¿¡æ¯</span>
                <span class="token comment">//è®¿é—®å¾®ä¿¡çš„èµ„æºæœåŠ¡å™¨ï¼Œè·å–ç”¨æˆ·ä¿¡æ¯</span>
                <span class="token class-name">String</span> baseUserInfoUrl <span class="token operator">=</span> <span class="token string">&quot;https://api.weixin.qq.com/sns/userinfo&quot;</span> <span class="token operator">+</span>
                        <span class="token string">&quot;?access_token=%s&quot;</span> <span class="token operator">+</span>
                        <span class="token string">&quot;&amp;openid=%s&quot;</span><span class="token punctuation">;</span>

                <span class="token comment">//å†æ¬¡æ‹¼æ¥å¾®ä¿¡åœ°å€</span>
                <span class="token class-name">String</span> userInfoUrl <span class="token operator">=</span> <span class="token class-name">String</span><span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span>baseUserInfoUrl<span class="token punctuation">,</span> access_token<span class="token punctuation">,</span> openid<span class="token punctuation">)</span><span class="token punctuation">;</span>

                <span class="token class-name">String</span> userInfo <span class="token operator">=</span> <span class="token class-name">HttpClientUtils</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span>userInfoUrl<span class="token punctuation">)</span><span class="token punctuation">;</span>

                <span class="token comment">//è·å–çš„å¾®ä¿¡ä¸ªäººä¿¡æ¯jsonä¿¡æ¯è¿›è¡Œè½¬æ¢</span>
                <span class="token class-name">HashMap</span> userInfoMap <span class="token operator">=</span> gson<span class="token punctuation">.</span><span class="token function">fromJson</span><span class="token punctuation">(</span>userInfo<span class="token punctuation">,</span> <span class="token class-name">HashMap</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token class-name">String</span> nickname <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">)</span>userInfoMap<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;nickname&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//æ˜µç§°</span>
                <span class="token class-name">String</span> headimgurl <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">)</span>userInfoMap<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">&quot;headimgurl&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//å¤´åƒ</span>

                <span class="token comment">//æŠŠå¾®ä¿¡ä¿¡æ¯æ³¨å†Œåˆ°æ•°æ®åº“ä¸­</span>
                member <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">UcenterMember</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                member<span class="token punctuation">.</span><span class="token function">setNickname</span><span class="token punctuation">(</span>nickname<span class="token punctuation">)</span><span class="token punctuation">;</span>
                member<span class="token punctuation">.</span><span class="token function">setOpenid</span><span class="token punctuation">(</span>openid<span class="token punctuation">)</span><span class="token punctuation">;</span>
                member<span class="token punctuation">.</span><span class="token function">setAvatar</span><span class="token punctuation">(</span>headimgurl<span class="token punctuation">)</span><span class="token punctuation">;</span>
                ucenterMemberService<span class="token punctuation">.</span><span class="token function">save</span><span class="token punctuation">(</span>member<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>

            <span class="token comment">//ä½¿ç”¨jwtç”Ÿæˆtokenå­—ç¬¦ä¸²</span>
            <span class="token class-name">String</span> jwtToken <span class="token operator">=</span> <span class="token class-name">JwtUtils</span><span class="token punctuation">.</span><span class="token function">getJwtToken</span><span class="token punctuation">(</span>menber<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> menber<span class="token punctuation">.</span><span class="token function">getNickname</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment">//è¿”å›é¦–é¡µé¢ï¼Œè¯¥é¦–é¡µé¢ä¸ºå‰ç«¯é¦–é¡µé¢</span>
            <span class="token keyword">return</span> <span class="token string">&quot;redirect:http://localhost:3000?token=&quot;</span><span class="token operator">+</span>jwtToken<span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">CustomizeApiException</span><span class="token punctuation">(</span><span class="token number">20001</span><span class="token punctuation">,</span><span class="token string">&quot;ç™»å½•å¤±è´¥&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="custom-container info"><p class="custom-container-title">Info</p><p>edué¡¹ç›®ä¸­å­æ¨¡å—<code>edu-service-order</code>å®ç°äº†å¾®ä¿¡æ”¯ä»˜åŠŸèƒ½æ•´åˆï¼Œå‚è€ƒæ¥å…¥<a href="https://pay.weixin.qq.com/static/applyment_guide/applyment_detail_website.shtml" target="_blank" rel="noopener noreferrer">å¾®ä¿¡æ”¯ä»˜<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a><a href="https://pay.weixin.qq.com/wiki/doc/apiv3/open/pay/chapter2_7_1.shtml" target="_blank" rel="noopener noreferrer">å‚è€ƒæ¥å…¥å¾®ä¿¡æ”¯ä»˜æµç¨‹æ¥å…¥å‰å‡†å¤‡<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p></div><p>å‚è€ƒæ–‡ç« ï¼š</p><ul><li><a href="https://segmentfault.com/a/1190000022172575" target="_blank" rel="noopener noreferrer">å®ç° OAuth2 å•ç‚¹ç™»å½•SSOâ€”å•ç‚¹ç™»å½•å’ŒOAuth2æ¦‚è¿°<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li><li><a href="https://open.weixin.qq.com/cgi-bin/showdocument?action=dir_list&amp;t=resource/res_list&amp;verify=1&amp;id=open1419316505&amp;token=e547653f995d8f402704d5cb2945177dc8aa4e7e&amp;lang=zh_CN" target="_blank" rel="noopener noreferrer">ç½‘ç«™åº”ç”¨å¾®ä¿¡ç™»å½•å¼€å‘æŒ‡å—<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></li></ul></div><!----><footer class="page-meta"><div class="meta-item edit-link"><a href="https://github.com/CodingLifeVV/edu/edit/main/demo/theme-docs/src/edu/backend/key.md" rel="noopener noreferrer" target="_blank" aria-label="GitHubä¸Šç¼–è¾‘æ­¤é¡µé¢" class="nav-link label"><!--[--><svg xmlns="http://www.w3.org/2000/svg" class="icon edit-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="edit icon"><path d="M430.818 653.65a60.46 60.46 0 0 1-50.96-93.281l71.69-114.012 7.773-10.365L816.038 80.138A60.46 60.46 0 0 1 859.225 62a60.46 60.46 0 0 1 43.186 18.138l43.186 43.186a60.46 60.46 0 0 1 0 86.373L588.879 565.55l-8.637 8.637-117.466 68.234a60.46 60.46 0 0 1-31.958 11.229z"></path><path d="M728.802 962H252.891A190.883 190.883 0 0 1 62.008 771.98V296.934a190.883 190.883 0 0 1 190.883-192.61h267.754a60.46 60.46 0 0 1 0 120.92H252.891a69.962 69.962 0 0 0-69.098 69.099V771.98a69.962 69.962 0 0 0 69.098 69.098h475.911A69.962 69.962 0 0 0 797.9 771.98V503.363a60.46 60.46 0 1 1 120.922 0V771.98A190.883 190.883 0 0 1 728.802 962z"></path></svg><!--]-->GitHubä¸Šç¼–è¾‘æ­¤é¡µé¢<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span><!----></a></div><div class="meta-item update-time"><span class="label">Last update: </span><!----></div><div class="meta-item contributors"><span class="label">Contributors: </span><!--[--><!--[--><span class="contributor" title="email: wyj_program@163.com">CodingLifeVV</span><!--]--><!--]--></div></footer><nav class="page-nav"><!----><a href="/edu/backend/sql.html" class="nav-link next" aria-label="æ•°æ®åº“æ¦‚è¿°"><div class="hint">Next<span class="arrow right"></span></div><div class="link">æ•°æ®åº“æ¦‚è¿°<!----></div></a></nav><!----><!----><!--]--></main><!--]--><footer class="footer-wrapper"><div class="footer">MIT Licensed  <a href="https://beian.miit.gov.cn/#/Integrated/index" target="_blank">æµ™ICPå¤‡2022028662å·-1</a> | Copyright Â© 2022-present <a href="https://github.com/CodingLifeVV" target="_blank">CodingLifeVV</a> </p> å†…å®¹åˆ›ä½œä¸æ˜“ï¼Œå¼•ç”¨è¯·æ³¨æ˜å‡ºå¤„ï¼Œç½‘ç«™å·²å¤‡æ¡ˆï¼Œåˆ‡å‹¿ä¾µæƒ</div><!----></footer><!--]--></div><!--]--><!----><!----><!--]--></div>
    <script type="module" src="/assets/app.72bdf948.js" defer></script>
  </body>
</html>
